/*@license SPA.js (nxT: Template Extension) [MIT] - based on doT.js (https://github.com/olado/doT/blob/master/LICENSE-DOT.txt)*/
!function(T){"use strict";function nxT(e,t,r,n,o){return render(e,t,r,n,o)}nxT.version="1.0.0",nxT.settings={scopeName:"data",strip:!1},nxT.compile=function compile(e,t){var n,i,r=u,o="if (arguments.length) return arguments.callee.call(arguments[0]);var "+(nxT.settings.scopeName||"data")+"=___rootCtx=___this=this;try{with(Object(this)){",a=r.append?l.append:l.split,c=0,s=r.rx.use||r.rx.define?function resolveDefs(o,e,i){return("string"==typeof e?e:e.toString()).replace(o.rx.define||p,function(e,n,t,r){return(n=0===n.indexOf("def.")?n.substring(4):n)in i||(":"===t?(o.rx.defineParams&&r.replace(o.rx.defineParams,function(e,t,r){i[n]={arg:t,text:r}}),n in i||(i[n]=r)):new Function("def","def['"+n+"']="+r)(i)),""}).replace(o.rx.use||p,function(e,t){o.rx.useParams&&(t=t.replace(o.rx.useParams,function(e,t,r,n){if(i[r]&&i[r].arg&&n){var o=(r+":"+n).replace(/'|\\/g,"_");return i.__exp=i.__exp||{},i.__exp[o]=i[r].text.replace(new RegExp("(^|[^\\w$])"+i[r].arg+"([^\\w$])","g"),"$1"+n+"$2"),t+"def.__exp['"+o+"']"}}));var t=new Function("def","return "+t)(i);return t&&resolveDefs(o,t,i)})}(r,e,t||{}):e;s=("var out='"+(nxT.settings.strip?function strip(e){return stripJsComments(e).replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t/g,"")}(s):s).replace(/'|\\/g,"\\$&").replace(/{{\/(~|each)}}/g,"{{~}}").replace(r.rx.blockClose||p,function(e,t){return"';}out+='"}).replace(r.rx.evaluate||p,function(e,t){return"';"+fixVarPath(t=nxT.settings.strip?t:stripJsComments(t))+";out+='"}).replace(r.rx.encode||p,function(e,t,r){return n=!0,a.startencode+fixVarPath(r)+a.end}).replace(r.rx.conditionalElse||p,function(e,t,r,n){return n?"';}else if("+fixVarPath(n)+"){out+='":"';}else{out+='"}).replace(r.rx.conditional||p,function(e,t,r,n){return r?n?"';}else if("+fixVarPath(n)+"){out+='":"';}else{out+='":n?"';if("+fixVarPath(n)+"){out+='":"';}out+='"}).replace(r.rx.conditionalNot||p,function(e,t,r,n){return n?"';if(!("+fixVarPath(n)+")){out+='":"';}out+='"}).replace(r.rx.withScope||p,function(e,t,r){return r?"';with(Object("+fixVarPath(r)+")){out+='":"';}out+='"}).replace(r.rx.iterate||p,function(e,t,r,n,o){return(r=r&&fixVarPath(r))?"';var arr"+(c+=1)+"=(Array.isArray("+r+"))? [].slice.call("+r+") : "+r+";var arr"+c+"Len=Object.keys(arr"+c+").length; if(arr"+c+"Len){var arr"+c+"item,"+(n=n||"value")+","+(i=o||"i"+c)+"=-1,l"+c+"=arr"+c+"Len-1;while("+i+"<l"+c+"){arr"+c+"item=arr"+c+"["+i+"+=1];(function (___p){var ___this="+n+"=this, ___index=___key="+(o?o+"=":"")+i+";with(Object(this)){out+='":"';}}).call(arr"+c--+"item);} } out+='"}).replace(r.rx.interpolate||p,function(e,t){return a.start+fixVarPath(t)+a.end})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,""),n&&(r.selfContained||!T||T._encodeHTML||(T._encodeHTML=nxT.encodeHTMLSource(r.doNotSkipEncoded)),s="var encodeHTML = typeof _encodeHTML !== 'undefined' ? _encodeHTML : ("+nxT.encodeHTMLSource.toString()+"("+(r.doNotSkipEncoded||"")+"));"+s);try{return new Function("_ctxObj_",o+s+'}}catch(e){ console.error("Error in Template:", e); }')}catch(e){throw"undefined"!=typeof console&&console.warn("Could not create a template function:",s),e}},nxT.render=render;var u={rx:{interpolate:/\{\{([\s\S]+?(\}?)+)\}\}/g,encode:/\{\{(\&|\{|encode)([\s\S]+?)\}?\}\}/g,conditional:/\{\{(\?|#\?|if|#if)(\?|\^)?\s*([\s\S]*?)\s*\}\}/g,conditionalNot:/\{\{(\!|#\!|unless|#unless)(\?)?\s*([\s\S]*?)\s*\}\}/g,conditionalElse:/\{\{(\^|else)(\?|if|If)?\s*([\s\S]*?)\s*\}\}/g,withScope:/\{\{(with|#with)\s*([\s\S]*?)\s*\}\}/g,blockClose:/\{\{\/\s*([\s\S]*?)\s*\}\}/g,evaluate:/\{\{js:([\s\S]+?)(\/)?\}\}/g,iterate:/\{\{(~|each|#each)\s*(?:\}\}|([\s\S]+?)\s*(?:\:\s*([\w$]+))?\s*(?:\:\s*([\w$]+))?\s*\}\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)(#|\/)\}\}/g,defineParams:/^\s*([\w$]+): ([\s\S]+)/,use:/\{\{#>([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\: \s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g},append:!1,selfContained:!1,doNotSkipEncoded:!1};nxT.encodeHTMLSource=function(e){var t={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},r=e?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(e){return e?e.toString().replace(r,function(e){return t[e]||e}):""}},nxT.isObj=function(e){return"object"==Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},nxT.isValidVar=function(e){return!/[^0-9a-z]|^[0-9]+/gi.test(e)},"undefined"!=typeof module&&module.exports?module.exports=nxT:"function"==typeof define&&define.amd?define(function(){return nxT}):T.nxT=T.Tee=nxT;var l={append:{start:"'+(",end:")+'",startencode:"'+encodeHTML("},split:{start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("}},p=/$^/;function fixVarPath(e){return e=(e="."===(e=e.trim().replace(/\@/g,"___").replace(/this/g,"___this").replace(/\.\//g,"___this.").replace(/\//g,"___rootCtx."))[0]?"___this"+e:e).replace(/\.+$/g,"").replace(/\.\[/g,"[").replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}function stripJsComments(e){return e.replace(/\/\/(.*)(\r|\n)/g,"$2").replace(/\/\*[\s\S]*?\*\//g,"")}var h="nxT";function getTmplType(e){return e=e.replace(/\s+/g,""),/[^a-z_0-9]/gi.test(e)?/:[a-z_0-9]+$/i.test(e)&&e.substring(e.lastIndexOf(":")+1)||"":e}function render(e,t,r,n,o){var i;if("function"!=typeof o)switch(!0){case"function"==typeof t:o=t,t=i;break;case"function"==typeof r:o=r,r=i;break;case"function"==typeof n:o=n,n=i}var a,c,s,u,l,p=e instanceof Element;if("function"==typeof e)a=e;else{if("string"!=typeof e&&!p)return void console.error("Invalid Template",e);p&&(e="#"+(s=(c=e).getAttribute("id")||"tmpl-"+(new Date).getTime()),c.setAttribute("id",s)),"#"==e[0]?(p||((u=getTmplType(e=e.replace(/\s+/g,"")))&&(e=e.substring(0,e.lastIndexOf(":"))),c=document.querySelector(e)),c&&(!(c.hasAttribute("recompile")||/live/gi.test(c.getAttribute("type")||""))&&c._compiled&&(a=c._compiled),(r=r||(c.getAttribute("target")||c.getAttribute("render-target")||"").trim())&&void 0===n&&(n=c.hasAttribute("replace-target"))),a||(u=u||getTmplType(c&&c.getAttribute("type")||""),l=c?c.value||c.innerHTML:e)):(p=e.indexOf(":"),u=e.substring(0,p).trim(),l=e.substring(p+1));var d,f,g=0,x=0;if(!(u=u||h))return void console.error("Unknown Template Engine",e);try{!a&&u&&T[u]&&(d=T[u].compile||T[u].template,g=performance.now(),d?"dust"===u&&T.dust?(f="dust-"+(new Date).getTime(),T.dust.loadSource(d(l,f)),a=T.dust.render.bind(T.dust,f)):(a=d(l))&&a.render&&(a=a.render.bind(a)):T[u].render&&(a=T[u].render.bind(T[u],l)),x=performance.now()-g)}catch(e){console.error("Template "+u+".compile failed:",e)}}if("function"==typeof a){if(c&&!c._compiled&&(c._compiled=a),c&&c.setAttribute("compile-time",x.toFixed(4)),"object"!=typeof t)return a;var m,_=performance.now();return"dust"===u?a(t,function(e,t){return e?console.error("Error in dust Template:",e):m=_updateDOM(r,t,n,_),"function"==typeof o&&o(m),m}):(m=_updateDOM(r,a(t),n,_),"function"==typeof o&&o(m)),m}console.error("Could not compile ["+u+"] Template",e)}function _updateDOM(e,t,r,n){if(e){var o=e;if("string"==typeof e&&(e=e.trim(),void 0===r&&(r=/:replace$/i.test(e)),e.replace(/:replace$/i,"").trim(),o=document.querySelector(e)),o)try{r?o.outerHTML=t:o.innerHTML=t,o.setAttribute("render-time",(performance.now()-n).toFixed(4))}catch(e){console.error(e)}else console.error("Invalid Target:",e)}return t}Object.defineProperties(Element.prototype,{render:{value:function(e,t,r,n){return nxT(this,e,t,r,n)}},compile:{value:function(){return nxT(this)}}})}(this);