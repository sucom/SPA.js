/*@license SPA.js (nxT: Template Extension) [MIT] - based on doT.js (https://github.com/olado/doT/blob/master/LICENSE-DOT.txt)*/
!function(){"use strict";var f;function nxT(e,t,r,n){return render(e,t,r,n)}nxT.version="1.0.0",nxT.settings={scopeName:"data",strip:!1},nxT.compile=function compile(e,t){var n,o,r=u,i="if (arguments.length) return arguments.callee.call(arguments[0]);var "+(nxT.settings.scopeName||"data")+"=___rootCtx=___this=this;try{with(Object(this)){",a=r.append?l.append:l.split,s=0,c=r.rx.use||r.rx.define?function resolveDefs(i,e,o){return("string"==typeof e?e:e.toString()).replace(i.rx.define||d,function(e,n,t,r){return(n=0===n.indexOf("def.")?n.substring(4):n)in o||(":"===t?(i.rx.defineParams&&r.replace(i.rx.defineParams,function(e,t,r){o[n]={arg:t,text:r}}),n in o||(o[n]=r)):new Function("def","def['"+n+"']="+r)(o)),""}).replace(i.rx.use||d,function(e,t){i.rx.useParams&&(t=t.replace(i.rx.useParams,function(e,t,r,n){if(o[r]&&o[r].arg&&n){var i=(r+":"+n).replace(/'|\\/g,"_");return o.__exp=o.__exp||{},o.__exp[i]=o[r].text.replace(new RegExp("(^|[^\\w$])"+o[r].arg+"([^\\w$])","g"),"$1"+n+"$2"),t+"def.__exp['"+i+"']"}}));var t=new Function("def","return "+t)(o);return t&&resolveDefs(i,t,o)})}(r,e,t||{}):e;c=("var out='"+(nxT.settings.strip?function strip(e){return stripJsComments(e).replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t/g,"")}(c):c).replace(/'|\\/g,"\\$&").replace(/{{\/(~|each)}}/g,"{{~}}").replace(r.rx.blockClose||d,function(e,t){return"';}out+='"}).replace(r.rx.evaluate||d,function(e,t){return"';"+fixVarPath(t=nxT.settings.strip?t:stripJsComments(t))+";out+='"}).replace(r.rx.encode||d,function(e,t,r){return n=!0,a.startencode+fixVarPath(r)+a.end}).replace(r.rx.conditionalElse||d,function(e,t,r,n){return n?"';}else if("+fixVarPath(n)+"){out+='":"';}else{out+='"}).replace(r.rx.conditional||d,function(e,t,r,n){return r?n?"';}else if("+fixVarPath(n)+"){out+='":"';}else{out+='":n?"';if("+fixVarPath(n)+"){out+='":"';}out+='"}).replace(r.rx.conditionalNot||d,function(e,t,r,n){return n?"';if(!("+fixVarPath(n)+")){out+='":"';}out+='"}).replace(r.rx.withScope||d,function(e,t,r){return r?"';with(Object("+fixVarPath(r)+")){out+='":"';}out+='"}).replace(r.rx.iterate||d,function(e,t,r,n,i){return(r=r&&fixVarPath(r))?"';var arr"+(s+=1)+"=(Array.isArray("+r+"))? [].slice.call("+r+") : "+r+";var arr"+s+"Len=Object.keys(arr"+s+").length; if(arr"+s+"Len){var arr"+s+"item,"+(n=n||"value")+","+(o=i||"i"+s)+"=-1,l"+s+"=arr"+s+"Len-1;while("+o+"<l"+s+"){arr"+s+"item=arr"+s+"["+o+"+=1];(function (___p){var ___this="+n+"=this, ___index=___key="+(i?i+"=":"")+o+";with(Object(this)){out+='":"';}}).call(arr"+s--+"item);} } out+='"}).replace(r.rx.interpolate||d,function(e,t){return a.start+fixVarPath(t)+a.end})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,""),n&&(r.selfContained||!f||f._encodeHTML||(f._encodeHTML=nxT.encodeHTMLSource(r.doNotSkipEncoded)),c="var encodeHTML = typeof _encodeHTML !== 'undefined' ? _encodeHTML : ("+nxT.encodeHTMLSource.toString()+"("+(r.doNotSkipEncoded||"")+"));"+c);try{return new Function("_ctxObj_",i+c+'}}catch(e){ console.error("Error in Template:", e); }')}catch(e){throw"undefined"!=typeof console&&console.warn("Could not create a template function:",c),e}},nxT.render=render;var u={rx:{interpolate:/\{\{([\s\S]+?(\}?)+)\}\}/g,encode:/\{\{(\&|\{|encode)([\s\S]+?)\}?\}\}/g,conditional:/\{\{(\?|#\?|if|#if)(\?|\^)?\s*([\s\S]*?)\s*\}\}/g,conditionalNot:/\{\{(\!|#\!|unless|#unless)(\?)?\s*([\s\S]*?)\s*\}\}/g,conditionalElse:/\{\{(\^|else)(\?|if|If)?\s*([\s\S]*?)\s*\}\}/g,withScope:/\{\{(with|#with)\s*([\s\S]*?)\s*\}\}/g,blockClose:/\{\{\/\s*([\s\S]*?)\s*\}\}/g,evaluate:/\{\{js:([\s\S]+?)(\/)?\}\}/g,iterate:/\{\{(~|each|#each)\s*(?:\}\}|([\s\S]+?)\s*(?:\:\s*([\w$]+))?\s*(?:\:\s*([\w$]+))?\s*\}\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)(#|\/)\}\}/g,defineParams:/^\s*([\w$]+): ([\s\S]+)/,use:/\{\{#>([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\: \s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g},append:!1,selfContained:!1,doNotSkipEncoded:!1};nxT.encodeHTMLSource=function(e){var t={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},r=e?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(e){return e?e.toString().replace(r,function(e){return t[e]||e}):""}},nxT.isObj=function(e){return"object"==Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},nxT.isValidVar=function(e){return!/[^0-9a-z]|^[0-9]+/gi.test(e)},f=function(){return this||(0,eval)("this")}(),"undefined"!=typeof module&&module.exports?module.exports=nxT:"function"==typeof define&&define.amd?define(function(){return nxT}):(f.nxT=nxT,f.Tee=nxT);var l={append:{start:"'+(",end:")+'",startencode:"'+encodeHTML("},split:{start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("}},d=/$^/;function fixVarPath(e){return e=(e="."===(e=e.trim().replace(/\@/g,"___").replace(/this/g,"___this").replace(/\.\//g,"___this.").replace(/\//g,"___rootCtx."))[0]?"___this"+e:e).replace(/\.+$/g,"").replace(/\.\[/g,"[").replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}function stripJsComments(e){return e.replace(/\/\/(.*)(\r|\n)/g,"$2").replace(/\/\*[\s\S]*?\*\//g,"")}function getTmplType(e){return e=e.replace(/\s+/g,""),/[^a-z_0-9]/gi.test(e)?/:[a-z_0-9]+$/i.test(e)&&e.substring(e.lastIndexOf(":")+1)||"":e}function render(e,t,r,n){var i,o,a,s,c,u,l,d,p=e instanceof Element;if("function"==typeof e)i=e;else{if("string"!=typeof e&&!p)return void console.error("Invalid Template",e);if(p&&(e="#"+(a=(o=e).getAttribute("id")||"tmpl-"+(new Date).getTime()),o.setAttribute("id",a)),"#"==e[0]?(p||((s=getTmplType(e=e.replace(/\s+/g,"")))&&(e=e.substring(0,e.lastIndexOf(":"))),o=document.querySelector(e)),o&&(!(o.hasAttribute("recompile")||/live/gi.test(o.getAttribute("type")||""))&&o._render&&(i=o._render),r=r||(o.getAttribute("target")||"").trim()),i||(s=s||getTmplType(o&&o.getAttribute("type")||""),c=o?o.value||o.innerHTML:e)):(p=e.indexOf(":"),s=e.substring(0,p).trim(),c=e.substring(p+1)),!(s=s||"nxT"))return void console.error("Unknown Template Engine",e);try{!i&&s&&f[s]&&((u=f[s].compile||f[s].template)?"dust"===s&&f.dust?(l="dust-"+(new Date).getTime(),f.dust.loadSource(u(c,l)),i=f.dust.render.bind(f.dust,l)):(i=u(c))&&i.render&&(i=i.render.bind(i)):f[s].render&&(i=f[s].render.bind(f[s],c)))}catch(e){console.error("Template "+s+".compile failed:",e)}}{if("function"==typeof i)return o&&!o._render&&(o._render=i),"object"!=typeof t?i:("dust"===s?i(t,function(e,t){d=_render(r,t)}):d=_render(r,i(t)),d);console.error("Could not compile ["+s+"] Template",e)}function _render(e,t){if(e){var r=e;if("string"==typeof e&&(e=e.trim(),void 0===n&&(n=/:replace$/i.test(e)),e.replace(/:replace$/i,"").trim(),r=document.querySelector(e)),r)try{n?r.outerHTML=t:r.innerHTML=t}catch(e){console.error(e)}else console.error("Invalid Target:",e)}return t}}}();