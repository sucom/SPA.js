/** @license SPA-handlebars-helpers.js | (c) Kumararaja | License (MIT) */
(function(){function e(e){return Object.prototype.toString.call(e).replace(/\[object /,"").replace(/\]/,"").toLowerCase()}function t(t,n){return(""+n).toLowerCase().indexOf(e(t))>=0}function n(e,n){function r(e,t){for(var n=t.split(","),r="",a=0,o=!0,i=0;n.length>i;i++)r=n[i].trim(),r&&(a++,o=o&&e.hasOwnProperty(r));return a&&o}function a(e,t){for(var n=t.split(","),r="",a=0,o=!1,i=0;n.length>i&&(r=n[i].trim(),r&&(a++,o=o||e.hasOwnProperty(r)),!o);i++);return a&&o}var o=!1;if(t(e,"object")&&n)switch(n=""+n,!0){case n.indexOf("&")>0:o=r(e,n.replace(/\&/g,","));break;case n.indexOf("|")>0:o=a(e,n.replace(/\|/g,","));break;default:o=r(e,n)}return o}function r(e,r){return t(e,"object")&&n(e,"name,hash,data")&&n(e.data,"root")?r?e.name==r:!0:!1}function a(e){return r(e)&&n(e,"fn,inverse")}function o(e){return r(e)&&Object.keys(e.hash).length}function i(e,n){var r=o(e)?e.hash:{};return n?(Object.keys(r).forEach(function(e){n[e]=t(r[e],"string")?r[e].trim():r[e]}),n):r}function s(e,t){var n=o(e)?e.hash:{};return t?(Object.keys(n).forEach(function(e){t[e]=n[e]}),t):n}function c(){function n(){function t(t){if(void 0===n)n=t;else{var r=e(t);switch(e(n)){case"array":switch(r){case"array":n=n.concat(t);break;default:n.push(t)}break;case"object":switch(r){case"array":for(var a=0;t.length>a;a++)n[a]=t[a];break;case"object":Object.keys(t).forEach(function(e){n[e]=t[e]});break;default:n["_"+(Object.keys(n).length+1)]=t}break;default:switch(r){case"object":t=JSON.stringify(t);break;case"array":t=t.join()}n+=" "+t}}}var n,a,o=st.slice.call(arguments);if(o.forEach(function(n,s){if(!a)switch(e(n)){case"function":var f=o.slice(s+1);f.push(c);var l=n.apply(void 0,f);u?r?t(l):"boolean"===e(l)?t(l?i.fn(l):i.inverse(l)):t(i.fn(l)):t(l),a=!0;break;case"array":u?r?t(n):n.length?n.forEach(function(e){t(i.fn(e))}):t(i.inverse(c)):t(n);break;case"object":u?r?t(n):Object.keys(n).length?t(i.fn(n)):t(i.inverse(c)):t(n);break;default:u?r?t(n):t(n?i.fn(c):i.inverse(c)):t(n)}}),u)return n;switch(e(n)){case"object":return JSON.stringify(n);case"array":return n.join();default:return n}}if(2>arguments.length)throw console.error("missing argument(s)"),Error("missing argument(s)");for(var r,a,i=st.splice.call(arguments,arguments.length-1,1)[0],c=i.data.root||{},u=i.hasOwnProperty("fn")||i.hasOwnProperty("inverse"),f=":if"==i.name,l={"==":function(e,t){return e==t},"===":function(e,t){return e===t},"!=":function(e,t){return e!=t},"!==":function(e,t){return e!==t},"<":function(e,t){return t>e},">":function(e,t){return e>t},"<=":function(e,t){return t>=e},">=":function(e,t){return e>=t},":typeof":function(e,t){return typeof e===t},":instanceof":function(t,n){return e(t).toLowerCase()===(""+n).trim().toLowerCase()},":is":function(t,n){return e(t).toLowerCase()===(""+n).trim().toLowerCase()},"=ic":function(e,t){return(""+e).toLowerCase()==(""+t).toLowerCase()},"!=ic":function(e,t){return(""+e).toLowerCase()!=(""+t).toLowerCase()},"+":function(e,t){return e+t},"-":function(e,t){return e-t},"*":function(e,t){return e*t},"/":function(e,t){return e/t}},g=Object.keys(l),p=function(e){return g.indexOf(e)>=0},d=st.slice.call(arguments),h=0;d.length>h;h++)if("string"===e(d[h])&&(r=p(d[h])?h:0)){a=d[h];break}if(f&&(!u||!t(d[0],"function")&&!r))throw Error("[Template Syntax Error] :if must have 'CONDITION' and BLOCK. use {{#:if ... 'CONDITION' ... }} ... {{else}} ... {{/:if}}");if(r){var m=d.slice(0,r),y=d.slice(r+1),b=n.apply(void 0,m),v=n.apply(void 0,y),O=l[a](b,v);if(u){var w,x=b,k=v;return o(i)&&(w=s(i),w&&((w.hasOwnProperty("thenWith")||w.hasOwnProperty("with")||w.hasOwnProperty("thenContext")||w.hasOwnProperty("context")||w.hasOwnProperty("thenData")||w.hasOwnProperty("data"))&&(x=w.thenWith||w["with"]||w.thenContext||w.context||w.thenData||w.data),(w.hasOwnProperty("elseWith")||w.hasOwnProperty("with")||w.hasOwnProperty("elseContext")||w.hasOwnProperty("context")||w.hasOwnProperty("elseData")||w.hasOwnProperty("data"))&&(k=w.elseWith||w["with"]||w.elseContext||w.context||w.elseData||w.data))),O?i.fn(x):i.inverse(k)}return O}return n.apply(void 0,arguments)}function u(t){return e(t)}function f(e,n){var o=arguments[arguments.length-1],i=r(n)?"undefined":n;return a(o)?t(e,i)?o.fn(e):o.inverse(e):t(e,i)}function l(e){return(""+(e||"")).toLowerCase()}function g(e){return(""+(e||"")).toUpperCase()}function p(e){return(""+(e||"")).toLowerCase().replace(/^(.)|\s(.)/g,function(e){return e.toUpperCase()})}function d(e){return(""+e).charAt(0).toUpperCase()+(""+e).slice(1)}function h(e){return(""+e).charAt(0).toLowerCase()+(""+e).slice(1)}function m(e){return w(e).replace(/\s+/g," ")}function y(e){return e=(""+e).replace(/[^+-0123456789.]/g,""),e=e.trim().length?e.indexOf(".")>=0?e.substring(0,e.indexOf(".")):e:"0",parseInt(1*e,10)}function b(e){return e=(""+e).replace(/[^+-0123456789.]/g,""),e=e.trim().length?e:"0",parseFloat(1*e)}function v(t){switch(e(t)){case"object":return JSON.stringify(t);case"array":return t.join();default:return""+t}}function O(t){switch(e(t)){case"function":return!0;case"object":return Object.keys(t).length>0;case"array":return t.length>0;default:var n=!0;switch((""+t).trim().toLowerCase()){case"":case"0":case"-0":case"nan":case"null":case"false":case"undefined":n=!1}return n}}function w(e,n){return e=v(e),t(n,"string")?x(k(e,n),n):e.trim()}function x(e,n){return e=v(e),t(n,"string")||(n=""),e.replace(RegExp("^["+(n||"\\s")+"]+","g"),"")}function k(e,n){return e=v(e),t(n,"string")||(n=""),e.replace(RegExp("["+(n||"\\s")+"]+$","g"),"")}function j(e,n){return e=v(e),t(n,"string|number")||(n=0),"string"==typeof n&&(n=e.indexOf(n)),n=y(n),n?e.substr(0,n):""}function E(e,n){e=v(e),t(n,"string|number")||(n=0);var r=1;return"string"==typeof n&&(r=n.length,n=e.indexOf(n)),n=y(n),0>n?"":e.substr(n+r)}function C(e,n,a){return"undefined"==typeof moment?(console.warn("Missing moment.js"),e):t(a,"string")?moment(e,n).format(a):r(a)?moment(e).format(n):r(n)?moment().format(e):r(e)?moment():void 0}function M(e){function n(e){return(e>9?"":"0")+e}var r=new Date;if(!t(e,"string"))return""+r;var a=e,o=["January","February","March","April","May","June","July","August","September","October","November","December"],i=["Jan","Feb","Mar","Apr","May","June","July","Aug","Sept","Oct","Nov","Dec"],s=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],c=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],u=["Su","Mo","Tu","We","Th","Fr","Sa"],f={YYYY:r.getFullYear(),YY:r.getFullYear(),Y:r.getFullYear(),Mmmm:o[r.getMonth()],MMMM:o[r.getMonth()].toUpperCase(),Mmm:i[r.getMonth()],MMM:i[r.getMonth()].toUpperCase(),"0M":n(r.getMonth()+1),MM:r.getMonth()+1,Dddd:s[r.getDay()],DDDD:s[r.getDay()].toUpperCase(),Ddd:c[r.getDay()],DDD:c[r.getDay()].toUpperCase(),Dd:u[r.getDay()],DD:u[r.getDay()].toUpperCase(),"0d":n(r.getDate()),dd:r.getDate(),"0h":n(r.getHours()),hh:r.getHours(),"0m":n(r.getMinutes()),mm:r.getMinutes(),"0s":n(r.getSeconds()),ss:r.getSeconds(),ms:r.getMilliseconds()};return Object.keys(f).forEach(function(e){a=a.replace(e,f[e])}),a}function S(){return""+(new Date).getTime()}function D(e,n){return t(e,"number")||(e=1),t(n,"number")||(n=e+999),Math.floor(Math.random()*(n-e+1))+e}function B(e,n){t(e,"number")||(e=8),t(n,"string")||(n=""),e=e||8;for(var r=n||"9a8b77C8D9E8F7G6H5I4J3c6d5e4f32L3M4N5P6Qg2h3i4j5kV6W5X4Y3Z26m7n8p9q8r7s6t5u4v3w2x3y4z5A6BK7R8S9T8U7",a="",o=0;e>o;o++){var i=Math.floor(Math.random()*r.length);a+=r.charAt(i)}return a}function P(e){var t=arguments[arguments.length-1];return a(t)?e!==void 0?t.fn(e):t.inverse(e):e!==void 0}function I(e){var t=arguments[arguments.length-1];return a(t)?e===void 0?t.fn(e):t.inverse(e):e===void 0}function L(t){var n;if(I(t)||null===t)n=!0;else switch(e(t)){case"undefined":case"null":n=!0;break;case"function":n=!1;break;case"object":n=0==Object.keys(t).length;break;case"array":n=0==t.length;break;case"boolean":n=t;break;case"number":n=0==t;break;case"string":n=0==t.trim().length;break;default:n=!1}var r=arguments[arguments.length-1];return a(r)?n?r.fn(t):r.inverse(t):!!n}function T(e,t,n){return O(e)?t:n}function N(e,n,r){return L(e)?n:t(r,"object")&&":ifEmpty"==r.name?e:r}function F(e,n,r){return L(e)?t(r,"object")&&":ifNotEmpty"==r.name?e:r:n}function _(e,t){var n=arguments[arguments.length-1],r=f(e,"array|object")?Q(e,t):e;return a(n)?r!==void 0?n.fn(r):n.inverse(r):r}function J(e,t){var n=[];return L(e)||(n=t?e.split(t):e.indexOf(",")>0?e.split(","):e.indexOf("|")>0?e.split("|"):e.indexOf(" ")>0?e.split(" "):e.indexOf("-")>0?e.split("-"):[e]),n}function U(e,t){var n=arguments[arguments.length-1],r=f(t,"string")?t:void 0,o=J(e,r);return a(n)?L(o)?n.inverse(e):n.fn(o):o}function Y(e){var n;return t(e,"string")&&(e=e.trim(),e&&(n=Q(window,e),t(n,"function")||(n=void 0))),n}function A(){var e,n,r,o=st.pop.call(arguments),i=st.shift.call(arguments),s=Y(i);return s&&(i.match("]$")?e=i.substring(0,i.lastIndexOf("[")):i.indexOf(".")>0&&(e=i.substring(0,i.lastIndexOf("."))),n=e?Q(window,e):window,r=s.apply(n,arguments)),a(o)?t(r,"undefined")||t(r,"boolean|number|string")&&!r||t(r,"array|object")&&spa.isBlank(r)?o.inverse(r):o.fn(r):r}function W(e,n){var r,s,c,f,l=arguments[arguments.length-1],g="",p={sortOn:"",sortBy:"",splitBy:",",alias:"",fnFilter:"",fnEmpty:"",fnEnd:"",fnError:""},d=!1,h=0;if(o(l)&&(p=i(l,p),r=Y(p.fnFilter),s=Y(p.fnEmpty),c=Y(p.fnEnd),f=Y(p.fnError)),a(l)){switch(u(e)){case"string":e=J(e,p.splitBy);case"array":if(p.sortOn||p.sortBy){var m="sortOn:"+p.sortOn.trim()+";sortBy:"+(p.sortBy||"asc").trim();e=X(e,m)}case"object":if(L(e))g+=l.inverse(e);else{var y,b=t(n,"string")&&n.trim(),v=b?J(n):p.alias?J(p.alias):["",""],O=(v[0]||"").trim(),w=(v[1]||"").trim(),x=w||"index";d=!0,Object.keys(e).forEach(function(t,n){p.key=t,y=O?{}:e[t],O&&(O&&(y[O]=e[t]),w&&(y[w]=t)),r?(p[x+"Src"]=n,r.call(void 0,y)&&(p[x]=h++,g+=l.fn(y,{data:p}))):(p[x]=h++,g+=l.fn(y,{data:p}))})}break;default:f&&f.call(void 0,e),g+=l.inverse(e)}return d&&(h?c&&c.call(void 0,e):(s&&s.call(void 0,e),g+=l.inverse(e))),g}return e}function H(n,r){function s(e,t){B.push({value:e,text:t})}function c(e,t){return l&&j.indexOf(""+x)>=0||g&&E.indexOf(""+e)>=0||p&&C.indexOf(""+t)>=0}function f(e,t){return x++,'<option value="'+e+'" '+(c(e,t)?"selected":"")+">"+t+"</option>"}var l,g,p,d,h,m,y,b,v,O=arguments[arguments.length-1],w="",x=-1,k={value:"",text:"",value_text:"",splitBy:",",vtSplit:"",sortOn:"",sortBy:"",fnFilter:"",fnEmpty:"",fnEnd:"",selIndex:"",selValue:"",selText:""},j=[],E=[],C=[],M="",S="",D="",B=[];switch(t(r,"string")&&J(r,";").forEach(function(e){var n=e.split(":");k[n[0].trim()]=t(n[1],"undefined")?"":n[1].trim()}),o(O)&&(k=i(O,k)),j=k.selIndex?J(k.selIndex):[],E=k.selValue?J(k.selValue):[],C=k.selText?J(k.selText):[],l=j.length,g=E.length,p=C.length,M=k.value||k.value_text,S=k.text||k.value_text,D=(k.vtSplit||"").replace(/colon/gi,":"),v="index"==M.toLowerCase(),d=k.sortOn.trim(),h=k.sortBy.trim(),h&&!d&&(d="text"),d&&!h&&(k.sortBy="asc"),m=Y(k.fnFilter),y=Y(k.fnEmpty),b=Y(k.fnEnd),t(n,"string")&&(n=J(n,k.splitBy)),u(n)){case"object":Object.keys(n).forEach(function(e){s(e,n[e])});break;case"array":n.forEach(function(t,n){switch(e(t)){case"object":var r=Object.keys(t);M&&S?s(t[M],t[S]):1==r.length&&r.forEach(function(e){s(e,t[e])});break;case"string":if(v){s(n,t);break}t=D?t.split(D):[t];case"array":M&&S?s(t[M],t[S]):1==t.length?s(t[0],t[0]):t.length>1&&s(t[0],t[1]);break;default:s(v?n:t,t)}})}if(m&&B.length){var P=[];B.forEach(function(e,n){e.index=n;var r=m.call(void 0,e);r&&P.push(t(r,"object")?r:e)}),B=P}if(B.length){if(d||h){var I="sortOn:"+d+";sortBy:"+h;B=X(B,I)}B.forEach(function(e){w+=f(e.value,e.text)}),b&&b.call(void 0,B,n)}else y&&y.call(void 0,B,n);return a(O)?w?O.fn(new Handlebars.SafeString(w)):O.inverse(this):new Handlebars.SafeString(w)}function R(){var e=c.apply(void 0,arguments);return e?"checked":""}function z(){var e=c.apply(void 0,arguments);return e?"":"checked"}function G(){var e=c.apply(void 0,arguments);return e?"disabled":""}function V(){var e=c.apply(void 0,arguments);return e?"":"disabled"}function K(){var e=c.apply(void 0,arguments);return e?"selected":""}function $(){var e=c.apply(void 0,arguments);return e?"":selected}function q(e){if(t(e,"number"))return!0;if(t(e,"string")){var n=e.replace(/[0-9]/g,"").trim();return e.length>0&&(""==n||e.length>1&&"."==n)}return!1}function Q(e,t,n){return spa.findInObject(e,t,n)}function X(n,r){function s(e,t){return t>e?-1:e>t?1:0}var c=arguments[arguments.length-1],u=[],f={sortOn:"",sortBy:"asc",splitBy:","},l=!0,g="";if(o(c)?f=i(c,f):t(r,"string")&&J(r,";").forEach(function(e){var n=e.split(":");f[n[0].trim()]=t(n[1],"undefined")?"":n[1].trim()}),l="asc"==f.sortBy.toLowerCase(),g=f.sortOn||"",t(n,"string")&&n.length>0&&(n=J(n,f.splitBy)),t(n,"array")&&n.length>0){if(1==n.length)u=n;else switch(e(n[0])){case"number":u=n.sort(function(e,t){return e-t});break;case"string":u=q(n[0])?n.sort(function(e,t){return 1*e-1*t}):n.sort();break;case"boolean":u=n.sort(function(e,t){return s(e,t)});break;case"object":if(g)switch(e(Q(n[0],g))){case"number":u=n.sort(function(e,t){return Q(e,g)-Q(t,g)});break;case"string":u=q(Q(n[0],g))?n.sort(function(e,t){return 1*Q(e,g)-1*Q(t,g)}):n.sort(function(e,t){return s(Q(e,g),Q(t,g))});break;case"boolean":u=n.sort(function(e,t){return s(Q(e,g),Q(t,g))});break;default:u=n}else u=n;break;default:u=n}l||(u=u.reverse())}return a(c)?u.length?c.fn(u):c.inverse(n):u}function Z(){function e(e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]="[object Object]"===Object.prototype.toString.call(e[n])?Z(t[n],e[n]):e[n])}for(var t={},n=0,r=arguments.length;r>n;n++)e(arguments[n]);return t}function et(){function n(n){if(!t(n,"undefined|null"))switch(e(r)){case"undefined":case"null":r=n;break;case"array":switch(e(n)){case"array":r=r.concat(n);break;default:r.push(n)}break;case"object":switch(e(n)){case"object":r=Z(r,n);break;default:r.hasOwnProperty("__joined__")?r.__joined__.push(n):r.__joined__=[n]}break;default:switch(e(n)){case"array":n.length&&(r+=n.join());break;case"object":Object.keys(n).length&&(r+=JSON.stringify(n));break;default:r+=""+n}}}var r,o=st.pop.call(arguments);return st.forEach.call(arguments,function(e){n(e)}),a(o)?o.fn(r):r}function tt(){var e=st.pop.call(arguments),t=st.shift.call(arguments),n=st.join.call(arguments,t);return a(e)?e.fn(n):n}function nt(){function e(n){if(n=n.trim(),!n.length)return n;var r=n[0],a=n;switch(!0){case"true"==n:a=!0;break;case"false"==n:a=!1;break;case q(n):a=1*n;break;case"["==r:n=n.substring(1,n.lastIndexOf("]"))+",";case n.indexOf(",")>0&&0>n.indexOf("{"):var o=[];n.split(",").forEach(function(t){t=t.trim(),""!=t&&o.push(e(t))}),a=o;break;case"{"==r:n=n.substring(1,n.lastIndexOf("}"));var s,c,u={};n.split(",").forEach(function(t){t=t.trim(),s=j(t,":").trim(),c=E(t,":").trim(),s&&(u[s]=e(c))}),a=u;break;case"@"==r&&"["!=n[1]:var f=n.substring(1,n.indexOf("."));if(q(f)){a=i[f];var l=n.indexOf(".")>0?n.substr(n.indexOf(".")+1):"";l&&t(a,"array|object")&&(a=Q(a,l))}}if(t(a,"string")&&a.indexOf("@[")>=0){var g,p,d,h,m=a.match(/(@\[\s*(.*?)\s*])/g);m&&m.forEach(function(e){g=e.replace(/@\[/,"").replace(/]/,""),p=g.substring(0,g.indexOf(".")),d="",q(p)&&(d=i[p],h=g.indexOf(".")>0?g.substr(g.indexOf(".")+1):"",h&&t(d,"array|object")&&(d=Q(d,h))),a=a.replace(RegExp(e.replace(/\[/,"\\["),"g"),d)})}return a}var n=st.pop.call(arguments),r=st.shift.call(arguments),o={},i=st.splice.call(arguments,0);return t(r,"string")&&J(r,";").forEach(function(t){var n=j(t,":").trim(),r=E(t,":").trim();n&&(r=e(r),o[n]=r)}),a(n)?n.fn(o):o}function rt(){var e=st.pop.call(arguments),n=Array_.shift.call(arguments),r={};if(t(n,"string"))try{r=JSON.parse(n)}catch(o){if(a(e))return e.inverse(o)}return a(e)?e.fn(r):r}function at(){var e=st.pop.call(arguments),t=h(e.name.replace(/:console/g,""));"time"==t&&arguments.length&&console.log.apply(void 0,arguments),0==t.indexOf("mem")?console.log(console.memory):console[t].apply(void 0,arguments)}function ot(e){var t=arguments[arguments.length-1],n="",r={searchStr:"",replaceStr:"",rxPattern:"",rxOption:""};return o(t)&&(r=s(t,r)),n=r.rxPattern?(""+e).replace(RegExp(r.rxPattern,r.rxOption),r.replaceStr):(""+e).replace(r.searchStr,r.replaceStr)}function it(e){var t=["Bytes","KB","MB","GB","TB","PB"];if(0==e)return"0";var n=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return parseFloat(e/Math.pow(1024,n)).toFixed(2)+" "+t[n]}var st=Array.prototype;"undefined"!=typeof Handlebars&&Handlebars&&Handlebars.registerHelper({":":c,":if":c,":is":f,":isEmpty":L,":ofType":u,":?":T,":ifEmpty":N,":ifNotEmpty":F,":of":_,":each":W,":forEach":W,":split":U,":sort":X,":join":et,":merge":et,":joinWithStr":tt,":fn":A,":jsonify":nt,":jsonParse":rt,":consoleClear":at,":consoleLog":at,":consoleWarn":at,":consoleInfo":at,":consoleError":at,":consoleGroup":at,":consoleGroupEnd":at,":consoleGroupCollapsed":at,":consoleMem":at,":consoleMemory":at,":consoleProfile":at,":consoleProfileEnd":at,":consoleTable":at,":consoleTime":at,":consoleTimeEnd":at,":options":H,":checkedIf":R,":checkedIfNot":z,":enabledIf":V,":enabledIfNot":G,":disabledIf":G,":disabledIfNot":V,":selectedIf":K,":selectedIfNot":$,":lower":l,":lowerCase":l,":toLowerCase":l,":lowerCaseOf":l,":upper":g,":upperCase":g,":toUpperCase":g,":upperCaseOf":g,":title":p,":titleCase":p,":toTitleCase":p,":titleCaseOf":p,":capitalize":d,":unCapitalize":h,":normalize":m,":normalizeStr":m,":int":y,":toInt":y,":intOf":y,":float":b,":toFloat":b,":floatOf":b,":toStr":v,":toString":v,":toBool":O,":toBoolean":O,":trim":w,":trimStr":w,":trimLeft":x,":trimLeftStr":x,":trimRight":k,":trimRightStr":k,":replace":ot,":getLeftStr":j,":getRightStr":E,":dateNowMs":S,":dateNow":M,":moment":C,":rand":D,":randPwd":B,":ifDefined":P,":ifUndefined":I,":bytesToSize":it})})();

/** @license jquery-i18n-properties-custom | (c) Kumararaja | License (MIT) */
(function($){function callbackIfComplete(e){e.async&&(e.filesLoaded+=1,e.filesLoaded===e.totalFiles&&e.callback&&e.callback())}function loadAndParseFile(e,a){$.ajax({url:e,async:a.async,cache:a.cache,dataType:"text",success:function(e){parseData(e,a.mode),callbackIfComplete(a)},error:function(){console.log("Failed to download or parse "+e),callbackIfComplete(a)}})}function parseData(data,mode){for(var parsed="",parameters=data.split(/\n/),regPlaceHolder=/(\{\d+})/g,regRepPlaceHolder=/\{(\d+)}/g,unicodeRE=/(\\u.{4})/gi,i=0;parameters.length>i;i++)if(parameters[i]=parameters[i].replace(/^\s\s*/,"").replace(/\s\s*$/,""),parameters[i].length>0&&"#"!=parameters[i].match("^#")){var pair=parameters[i].split("=");if(pair.length>0){for(var name=decodeURI(pair[0]).replace(/^\s\s*/,"").replace(/\s\s*$/,""),value=1==pair.length?"":pair[1];"\\"==value.match(/\\$/);)value=value.substring(0,value.length-1),value+=parameters[++i].replace(/\s\s*$/,"");for(var s=2;pair.length>s;s++)value+="="+pair[s];if(value=value.replace(/^\s\s*/,"").replace(/\s\s*$/,""),"map"==mode||"both"==mode){var unicodeMatches=value.match(unicodeRE);if(unicodeMatches)for(var u=0;unicodeMatches.length>u;u++)value=value.replace(unicodeMatches[u],unescapeUnicode(unicodeMatches[u]));$.i18n.map[name]=value}if("vars"==mode||"both"==mode)if(value=value.replace(/"/g,'\\"'),checkKeyNamespace(name),regPlaceHolder.test(value)){for(var parts=value.split(regPlaceHolder),first=!0,fnArgs="",usedArgs=[],p=0;parts.length>p;p++)!regPlaceHolder.test(parts[p])||0!=usedArgs.length&&-1!=usedArgs.indexOf(parts[p])||(first||(fnArgs+=","),fnArgs+=parts[p].replace(regRepPlaceHolder,"v$1"),usedArgs.push(parts[p]),first=!1);parsed+=name+"=function("+fnArgs+"){";var fnExpr='"'+value.replace(regRepPlaceHolder,'"+v$1+"')+'"';parsed+="return "+fnExpr+";"+"};"}else parsed+=name+'="'+value+'";'}}eval(parsed)}function checkKeyNamespace(key){var regDot=/\./;if(regDot.test(key))for(var fullname="",names=key.split(/\./),i=0;names.length>i;i++)i>0&&(fullname+="."),fullname+=names[i],eval("typeof "+fullname+' == "undefined"')&&eval(fullname+"={};")}function getFiles(e){return e&&e.constructor==Array?e:[e]}function unescapeUnicode(e){var a=[],r=parseInt(e.substr(2),16);r>=0&&Math.pow(2,16)>r&&a.push(r);for(var t="",n=0;a.length>n;++n)t+=String.fromCharCode(a[n]);return t}$.i18n={},$.i18n.map={},$.i18n.properties=function(e){var a={name:"Messages",language:"",path:"",ext:".properties",mode:"vars",cache:!1,encoding:"UTF-8",async:!1,checkAvailableLanguages:!1,callback:null};e=$.extend(a,e),e.language=this.normaliseLanguageCode(e.language);var r=function(a){e.totalFiles=0,e.filesLoaded=0;var r=getFiles(e.name);if(e.async)for(var t=0,n=r.length;n>t;t++)if(e.language.length>=5){var s=e.language.substring(0,5);(0==a.length||-1!=$.inArray(s,a))&&(e.totalFiles+=1)}else{var l=e.language.substring(0,2);e.totalFiles+=0==a.length||-1!=$.inArray(l,a)?1:1}for(var i=0,g=r.length;g>i;i++)if(e.language.length>=5){var s=e.language.substring(0,5);(0==a.length||-1!=$.inArray(s,a))&&loadAndParseFile(e.path+r[i]+"_"+s+(e.ext||".properties"),e)}else{var l=e.language.substring(0,2);0==a.length||-1!=$.inArray(l,a)?loadAndParseFile(e.path+r[i]+"_"+l+(e.ext||".properties"),e):loadAndParseFile(e.path+r[i]+(e.ext||".properties"),e)}e.callback&&!e.async&&e.callback()};e.checkAvailableLanguages?$.ajax({url:e.path+"languages.json",async:e.async,cache:!1,success:function(e){r(e.languages||[])}}):r([])},$.i18n.prop=function(e){var a=$.i18n.map[e];if(null==a)return"["+e+"]";var r;2==arguments.length&&$.isArray(arguments[1])&&(r=arguments[1]);var t;if("string"==typeof a){for(t=0;-1!=(t=a.indexOf("\\",t));)a="t"==a.charAt(t+1)?a.substring(0,t)+"	"+a.substring(t++ +2):"r"==a.charAt(t+1)?a.substring(0,t)+"\r"+a.substring(t++ +2):"n"==a.charAt(t+1)?a.substring(0,t)+"\n"+a.substring(t++ +2):"f"==a.charAt(t+1)?a.substring(0,t)+"\f"+a.substring(t++ +2):"\\"==a.charAt(t+1)?a.substring(0,t)+"\\"+a.substring(t++ +2):a.substring(0,t)+a.substring(t+1);var n,s,l=[];for(t=0;a.length>t;)if("'"==a.charAt(t))if(t==a.length-1)a=a.substring(0,t);else if("'"==a.charAt(t+1))a=a.substring(0,t)+a.substring(++t);else{for(n=t+2;-1!=(n=a.indexOf("'",n));){if(n==a.length-1||"'"!=a.charAt(n+1)){a=a.substring(0,t)+a.substring(t+1,n)+a.substring(n+1),t=n-1;break}a=a.substring(0,n)+a.substring(++n)}-1==n&&(a=a.substring(0,t)+a.substring(t+1))}else if("{"==a.charAt(t))if(n=a.indexOf("}",t+1),-1==n)t++;else if(s=parseInt(a.substring(t+1,n)),!isNaN(s)&&s>=0){var i=a.substring(0,t);""!=i&&l.push(i),l.push(s),t=0,a=a.substring(n+1)}else t=n+1;else t++;""!=a&&l.push(a),a=l,$.i18n.map[e]=l}if(0==a.length)return"";if(1==a.length&&"string"==typeof a[0])return a[0];var g="";for(t=0;a.length>t;t++)g+="string"==typeof a[t]?a[t]:r&&r.length>a[t]?r[a[t]]:!r&&arguments.length>a[t]+1?arguments[a[t]+1]:"{"+a[t]+"}";return g},$.i18n.normaliseLanguageCode=function(e){return(!e||2>e.length)&&(e=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage||"en"),e=e.toLowerCase(),e=e.replace(/-/,"_"),e.length>3&&(e=e.substring(0,3)+e.substring(3).toUpperCase()),e};var cbSplit;cbSplit||(cbSplit=function(e,a,r){if("[object RegExp]"!==Object.prototype.toString.call(a))return cbSplit._nativeSplit===void 0?e.split(a,r):cbSplit._nativeSplit.call(e,a,r);var t,n,s,l,i=[],g=0,u=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.sticky?"y":""),a=RegExp(a.source,u+"g");if(e+="",cbSplit._compliantExecNpcg||(t=RegExp("^"+a.source+"$(?!\\s)",u)),void 0===r||0>+r)r=1/0;else if(r=Math.floor(+r),!r)return[];for(;(n=a.exec(e))&&(s=n.index+n[0].length,!(s>g&&(i.push(e.slice(g,n.index)),!cbSplit._compliantExecNpcg&&n.length>1&&n[0].replace(t,function(){for(var e=1;arguments.length-2>e;e++)void 0===arguments[e]&&(n[e]=void 0)}),n.length>1&&e.length>n.index&&Array.prototype.push.apply(i,n.slice(1)),l=n[0].length,g=s,i.length>=r)));)a.lastIndex===n.index&&a.lastIndex++;return g===e.length?(l||!a.test(""))&&i.push(""):i.push(e.slice(g)),i.length>r?i.slice(0,r):i},cbSplit._compliantExecNpcg=void 0===/()??/.exec("")[1],cbSplit._nativeSplit=String.prototype.split),String.prototype.split=function(e,a){return cbSplit(this,e,a)}})(jQuery);

/** @license (MIT) SPA.js | (c) Kumararaja */
window.app=window.app||{api:{}},window.app.api=window.app.api||{},function(){function b(){}for(var e,a=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],t=a.length,n=window.console=window.console||{};t--;)n[e=a[t]]||(n[e]=b);"none"in window||(window.none=""),"noop"in window||(window.noop=function(){})}(),
/** @license (MIT) lodash | https://github.com/lodash/lodash/blob/master/LICENSE */
function(){if(!window._){var v={MAX_INTEGER:17976931348623157e292,MAX_SAFE_INTEGER:9007199254740991,INFINITY:1/0,reIsDeepProp:/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp:/^\w*$/,reLeadingDot:/^\./,rePropName:/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar:/\\(\\)?/g,reIsUint:/^(?:0|[1-9]\d*)$/,reFlags:/\w*$/,spreadableSymbol:window.Symbol?Symbol.isConcatSpreadable:void 0,symToStringTag:window.Symbol?Symbol.toStringTag:void 0,nativeIsBuffer:window.Buffer?Buffer.isBuffer:void 0,Uint8Array:window.Uint8Array,Map:window.Map?window.Map:void 0,Set:window.Set?window.Set:void 0,nativeCreate:window.Object&&Object.create?Object.create:void 0,nativeGetSymbols:Object.getOwnPropertySymbols,arrayProto:Array.prototype,splice:Array.prototype.splice,funcProto:Function.prototype,objectProto:Object.prototype,objectCreate:Object.create,symbolProto:window.Symbol?Symbol.prototype:void 0,symbolValueOf:window.Symbol&&Symbol.prototype?Symbol.prototype.valueOf:void 0,symbolToString:window.Symbol&&Symbol.prototype?Symbol.prototype.toString:void 0,HASH_UNDEFINED:"__lodash_hash_undefined__",COMPARE_PARTIAL_FLAG:1,COMPARE_UNORDERED_FLAG:2,LARGE_ARRAY_SIZE:200,HOT_COUNT:800,HOT_SPAN:16,CLONE_DEEP_FLAG:1,CLONE_FLAT_FLAG:2,CLONE_SYMBOLS_FLAG:4,argsTag:"[object Arguments]",arrayTag:"[object Array]",asyncTag:"[object AsyncFunction]",boolTag:"[object Boolean]",dateTag:"[object Date]",domExcTag:"[object DOMException]",errorTag:"[object Error]",funcTag:"[object Function]",genTag:"[object GeneratorFunction]",mapTag:"[object Map]",numberTag:"[object Number]",nullTag:"[object Null]",objectTag:"[object Object]",promiseTag:"[object Promise]",proxyTag:"[object Proxy]",regexpTag:"[object RegExp]",setTag:"[object Set]",stringTag:"[object String]",symbolTag:"[object Symbol]",undefinedTag:"[object Undefined]",weakMapTag:"[object WeakMap]",weakSetTag:"[object WeakSet]",arrayBufferTag:"[object ArrayBuffer]",dataViewTag:"[object DataView]",float32Tag:"[object Float32Array]",float64Tag:"[object Float64Array]",int8Tag:"[object Int8Array]",int16Tag:"[object Int16Array]",int32Tag:"[object Int32Array]",uint8Tag:"[object Uint8Array]",uint8ClampedTag:"[object Uint8ClampedArray]",uint16Tag:"[object Uint16Array]",uint32Tag:"[object Uint32Array]",setToArray:function _setToArray(e){var a=-1,t=Array(e.size);return e.forEach(function(e){t[++a]=e}),t},apply:function _apply(e,a,t){switch(t.length){case 0:return e.call(a);case 1:return e.call(a,t[0]);case 2:return e.call(a,t[0],t[1]);case 3:return e.call(a,t[0],t[1],t[2])}return e.apply(a,t)},overArg:function _overArg(a,t){return function(e){return a(t(e))}},stubFalse:function _stubFalse(){return!1},stubArray:function _stubArray(){return[]},constant:function _constant(e){return function(){return e}},defineProperty:function(){try{var e=Object.defineProperty;return e({},"",{}),e}catch(e){}}(),baseCreate:function(e){var a=typeof e;if(null==e||"object"!=a&&"function"!=a)return{};if(Object.create)return Object.create(e);object.prototype=e;var t=new object;return object.prototype=void 0,t},isKeyable:function _isKeyable(e){var a=typeof e;return"string"==a||"number"==a||"symbol"==a||"boolean"==a?"__proto__"!==e:null===e},getMapData:function _getMapData(e,a){var t=e.__data__;return v.isKeyable(a)?t["string"==typeof a?"string":"hash"]:t.map},typedArrayTags:{},cloneableTags:{}},g=v.nativeIsBuffer||v.stubFalse,s=v.objectProto.toString,t=v.objectProto.propertyIsEnumerable,b=v.objectProto.hasOwnProperty,r=v.nativeIsBuffer?Buffer.allocUnsafe:void 0,n=v.funcProto.toString,o=v.funcProto.toString.call(Object);v.typedArrayTags[v.float32Tag]=v.typedArrayTags[v.float64Tag]=v.typedArrayTags[v.int8Tag]=v.typedArrayTags[v.int16Tag]=v.typedArrayTags[v.int32Tag]=v.typedArrayTags[v.uint8Tag]=v.typedArrayTags[v.uint8ClampedTag]=v.typedArrayTags[v.uint16Tag]=v.typedArrayTags[v.uint32Tag]=!0,v.typedArrayTags[v.argsTag]=v.typedArrayTags[v.arrayTag]=v.typedArrayTags[v.arrayBufferTag]=v.typedArrayTags[v.boolTag]=v.typedArrayTags[v.dataViewTag]=v.typedArrayTags[v.dateTag]=v.typedArrayTags[v.errorTag]=v.typedArrayTags[v.funcTag]=v.typedArrayTags[v.mapTag]=v.typedArrayTags[v.numberTag]=v.typedArrayTags[v.objectTag]=v.typedArrayTags[v.regexpTag]=v.typedArrayTags[v.setTag]=v.typedArrayTags[v.stringTag]=v.typedArrayTags[v.weakMapTag]=!1,v.cloneableTags[v.argsTag]=v.cloneableTags[v.arrayTag]=v.cloneableTags[v.arrayBufferTag]=v.cloneableTags[v.dataViewTag]=v.cloneableTags[v.boolTag]=v.cloneableTags[v.dateTag]=v.cloneableTags[v.float32Tag]=v.cloneableTags[v.float64Tag]=v.cloneableTags[v.int8Tag]=v.cloneableTags[v.int16Tag]=v.cloneableTags[v.int32Tag]=v.cloneableTags[v.mapTag]=v.cloneableTags[v.numberTag]=v.cloneableTags[v.objectTag]=v.cloneableTags[v.regexpTag]=v.cloneableTags[v.setTag]=v.cloneableTags[v.stringTag]=v.cloneableTags[v.symbolTag]=v.cloneableTags[v.uint8Tag]=v.cloneableTags[v.uint8ClampedTag]=v.cloneableTags[v.uint16Tag]=v.cloneableTags[v.uint32Tag]=!0,v.cloneableTags[v.errorTag]=v.cloneableTags[v.funcTag]=v.cloneableTags[v.weakMapTag]=!1,v.baseSetToString=v.defineProperty?function(e,a){return v.defineProperty(e,"toString",{configurable:!0,enumerable:!1,value:v.constant(a),writable:!0})}:function(e){return e},v.shortOut=function _shortOut(t){var n=0,r=0;return function(){var e=Date.now(),a=v.HOT_SPAN-(e-r);if(r=e,0<a){if(++n>=v.HOT_COUNT)return arguments[0]}else n=0;return t.apply(void 0,arguments)}},v.overRest=function _overRest(s,o,i){return o=Math.max(void 0===o?s.length-1:o,0),function(){for(var e=arguments,a=-1,t=Math.max(e.length-o,0),n=Array(t);++a<t;)n[a]=e[o+a];a=-1;for(var r=Array(o+1);++a<o;)r[a]=e[a];return r[o]=i(n),v.apply(s,this,r)}},v.Hash=function _Hash(e){var a=-1,t=null==e?0:e.length;for(this.clear();++a<t;){var n=e[a];this.set(n[0],n[1])}},v.Hash.prototype.clear=function hashClear(){this.__data__=v.nativeCreate?v.nativeCreate(null):{},this.size=0},v.Hash.prototype.delete=function hashDelete(e){var a=this.has(e)&&delete this.__data__[e];return this.size-=a?1:0,a},v.Hash.prototype.get=function hashGet(e){var a=this.__data__;if(v.nativeCreate){var t=a[e];return t===v.HASH_UNDEFINED?void 0:t}return b.call(a,e)?a[e]:void 0},v.Hash.prototype.has=function hashHas(e){var a=this.__data__;return v.nativeCreate?void 0!==a[e]:b.call(a,e)},v.Hash.prototype.set=function hashSet(e,a){var t=this.__data__;return this.size+=this.has(e)?0:1,t[e]=v.nativeCreate&&void 0===a?v.HASH_UNDEFINED:a,this},v.ListCache=function _ListCache(e){var a=-1,t=null==e?0:e.length;for(this.clear();++a<t;){var n=e[a];this.set(n[0],n[1])}},v.ListCache.prototype.clear=function _listCacheClear(){this.__data__=[],this.size=0},v.ListCache.prototype.delete=function _listCacheDelete(e){var a=this.__data__,t=_assocIndexOf(a,e);return!(t<0)&&(t==a.length-1?a.pop():v.splice.call(a,t,1),--this.size,!0)},v.ListCache.prototype.get=function _listCacheGet(e){var a=this.__data__,t=_assocIndexOf(a,e);return t<0?void 0:a[t][1]},v.ListCache.prototype.has=function _listCacheHas(e){return-1<_assocIndexOf(this.__data__,e)},v.ListCache.prototype.set=function _listCacheSet(e,a){var t=this.__data__,n=_assocIndexOf(t,e);return n<0?(++this.size,t.push([e,a])):t[n][1]=a,this},v.Stack=function _Stack(e){var a=this.__data__=new v.ListCache(e);this.size=a.size},v.Stack.prototype.clear=function stackClear(){this.__data__=new v.ListCache,this.size=0},v.Stack.prototype.delete=function _stackDelete(e){var a=this.__data__,t=a.delete(e);return this.size=a.size,t},v.Stack.prototype.get=function _stackGet(e){return this.__data__.get(e)},v.Stack.prototype.has=function _stackHas(e){return this.__data__.has(e)},v.Stack.prototype.set=function _stackSet(e,a){var t=this.__data__;if(t instanceof v.ListCache){var n=t.__data__;if(!v.Map||n.length<v.LARGE_ARRAY_SIZE-1)return n.push([e,a]),this.size=++t.size,this;t=this.__data__=new v.MapCache(n)}return t.set(e,a),this.size=t.size,this},v.MapCache=function _MapCache(e){var a=-1,t=null==e?0:e.length;for(this.clear();++a<t;){var n=e[a];this.set(n[0],n[1])}},v.MapCache.prototype.clear=function _mapCacheClear(){this.size=0,this.__data__={hash:new v.Hash,map:new(v.Map||v.ListCache),string:new v.Hash}},v.MapCache.prototype.delete=function _mapCacheDelete(e){var a=v.getMapData(this,e).delete(e);return this.size-=a?1:0,a},v.MapCache.prototype.get=function _mapCacheGet(e){return v.getMapData(this,e).get(e)},v.MapCache.prototype.has=function _mapCacheHas(e){return v.getMapData(this,e).has(e)},v.MapCache.prototype.set=function _mapCacheSet(e,a){var t=v.getMapData(this,e),n=t.size;return t.set(e,a),this.size+=t.size==n?0:1,this},v.SetCache=function _SetCache(e){var a=-1,t=null==e?0:e.length;for(this.__data__=new v.MapCache;++a<t;)this.add(e[a])},v.SetCache.prototype.add=v.SetCache.prototype.push=function _setCacheAdd(e){return this.__data__.set(e,v.HASH_UNDEFINED),this},v.SetCache.prototype.has=function _setCacheHas(e){return this.__data__.has(e)},v.createSet=v.Set&&1/v.setToArray(new v.Set([,-0]))[1]==v.INFINITY?function(e){return new v.Set(e)}:function(){},v.getSymbols=v.nativeGetSymbols?function(a){return null==a?[]:(a=Object(a),_arrayFilter(v.nativeGetSymbols(a),function(e){return t.call(a,e)}))}:v.stubArray,v.setToString=v.shortOut(v.baseSetToString);var i=v.overArg(Object.keys,Object),p=v.overArg(Object.getPrototypeOf,Object),e=function createAssigner(i){return _baseRest(function(e,a){var t=-1,n=a.length,r=1<n?a[n-1]:void 0,s=2<n?a[2]:void 0;for(r=3<i.length&&"function"==typeof r?(n--,r):void 0,s&&isIterateeCall(a[0],a[1],s)&&(r=n<3?void 0:r,n=1),e=Object(e);++t<n;){var o=a[t];o&&i(e,o,t,r)}return e})}(function(e,a){_copyObject(a,_keysIn(a),e)}),a=_baseRest(function(e){return _baseUniq(_baseFlatten(e,1,_isArrayLikeObject,!0))}),h=v.nativeGetSymbols?function(e){for(var a=[];e;)_arrayPush(a,v.getSymbols(e)),e=p(e);return a}:v.stubArray,l=_flatRest(function(a,e){var t={};if(null==a)return t;var n=!1;e=_arrayMap(e,function(e){return e=_castPath(e,a),n=n||1<e.length,e}),_copyObject(a,_getAllKeysIn(a),t),n&&(t=_baseClone(t,CLONE_DEEP_FLAG|CLONE_FLAT_FLAG|CLONE_SYMBOLS_FLAG,_customOmitClone));for(var r=e.length;r--;)_baseUnset(t,e[r]);return t}),_=_baseIsArguments(function(){return arguments}())?_baseIsArguments:function(e){return _isObjectLike(e)&&b.call(e,"callee")&&!t.call(e,"callee")},c=function _createBaseEach(s,o){return function(e,a){if(null==e)return e;if(!_isArrayLike(e))return s(e,a);for(var t=e.length,n=o?t:-1,r=Object(e);(o?n--:++n<t)&&!1!==a(r[n],n,r););return e}}(function _baseForOwn(e,a){return e&&_baseFor(e,a,_keys)}),d={at:void 0,each:function _each(e,a){return(_isArray(e)?_arrayEach:c)(e,_getIteratee(a,3))},every:function _every(e,a,t){var n=_isArray(e)?_arrayEvery:_baseEvery;return t&&_isIterateeCall(e,a,t)&&(a=void 0),n(e,_getIteratee(a,3))},extend:e,filter:function _filter(e,a){return(_isArray(e)?_arrayFilter:_baseFilter)(e,_getIteratee(a,3))},find:function _find(e,a,t){var n=Object(e);if(!_isArrayLike(e)){var r=_getIteratee(a,3);e=_keys(e),a=function(e){return r(n[e],e,n)}}var s=_findIndex(e,a,t);return-1<s?n[r?e[s]:s]:void 0},findIndex:_findIndex,get:_get,getAllKeys:_getAllKeys,has:function _has(e,a){return null!=e&&_hasPath(e,a,_baseHas)},hasIn:_hasIn,indexOf:function _indexOf(e,a,t){var n=null==e?0:e.length;if(!n)return-1;var r=null==t?0:_toInteger(t);return r<0&&(r=Math.max(n+r,0)),_baseIndexOf(e,a,r)},isArray:_isArray,isArrayLike:_isArrayLike,isArrayLikeObject:_isArrayLikeObject,isBoolean:function _isBoolean(e){return!0===e||!1===e||_isObjectLike(e)&&_baseGetTag(e)==v.boolTag},isEmpty:function _isEmpty(e){var a=typeof e;return"undefined"==a||null==e||("string"==a||"[object Array]"===Object.prototype.toString.call(e)?!e.length:"object"==a&&!Object.keys(e).length)},isFunction:_isFunction,isIndex:_isIndex,isKey:_isKey,isLength:_isLength,isNumber:function _isNumber(e){return"number"==typeof e||_isObjectLike(e)&&_baseGetTag(e)==v.numberTag},isObject:_isObject,isObjectLike:_isObjectLike,isPlainObject:_isPlainObject,isPrototype:_isPrototype,isString:_isString,isSymbol:_isSymbol,isTypedArray:_isTypedArray,keys:_keys,keysIn:_keysIn,last:_last,map:function _map(e,a){return(_isArray(e)?_arrayMap:_baseMap)(e,_getIteratee(a,3))},max:function _max(e){return e&&e.length?function baseExtremum(e,a,t){for(var n=-1,r=e.length;++n<r;){var s=e[n],o=a(s);if(null!=o&&(void 0===i?o==o&&!_isSymbol(o):t(o,i)))var i=o,p=s}return p}(e,identity,baseGt):void 0},merge:void 0,omit:l,pick:void 0,property:_property,pull:void 0,pullAt:void 0,pullAll:_pullAll,range:function _range(e,a,t){return t&&"number"!=typeof t&&(t=void 0),e=_toFinite(e),void 0===a?(a=e,e=0):a=_toFinite(a),function _baseRange(e,a,t,n){for(var r=-1,s=Math.max(Math.ceil((a-e)/(t||1)),0),o=Array(s);s--;)o[n?s:++r]=e,e+=t;return o}(e,a,t=void 0===t?e<a?1:-1:_toFinite(t),!1)},remove:function _remove(e,a){var t=[];if(!e||!e.length)return t;var n=-1,r=[],s=e.length;for(a=_getIteratee(a,3);++n<s;){var o=e[n];a(o,n,e)&&(t.push(o),r.push(n))}return _basePullAt(e,r),t},some:function _some(e,a,t){var n=_isArray(e)?_arraySome:_baseSome;return t&&_isIterateeCall(e,a,t)&&(a=void 0),n(e,_getIteratee(a,3))},sortBy:void 0,union:a,uniq:function _uniq(e){return e&&e.length?_baseUniq(e):[]},zipObject:function _zipObject(e,a){return function _baseZipObject(e,a,t){var n=-1,r=e.length,s=a.length,o={};for(;++n<r;){var i=n<s?a[n]:void 0;t(o,e[n],i)}return o}(e||[],a||[],_assignValue)}};d.at=_flatRest(_baseAt),d.pull=_baseRest(_pullAll),d.pullAt=_flatRest(function(e,a){var t=null==e?0:e.length,n=_baseAt(e,a);return _basePullAt(e,_arrayMap(a,function(e){return _isIndex(e,t)?+e:e}).sort(_compareAscending)),n}),d.sortBy=_baseRest(function(e,a){if(null==e)return[];var t=a.length;return 1<t&&_isIterateeCall(e,a[0],a[1])?a=[]:2<t&&_isIterateeCall(a[0],a[1],a[2])&&(a=[a[0]]),_baseOrderBy(e,_baseFlatten(a,1),[])}),d.merge=function _createAssigner(i){return _baseRest(function(e,a){var t=-1,n=a.length,r=1<n?a[n-1]:void 0,s=2<n?a[2]:void 0;for(r=3<i.length&&"function"==typeof r?(n--,r):void 0,s&&_isIterateeCall(a[0],a[1],s)&&(r=n<3?void 0:r,n=1),e=Object(e);++t<n;){var o=a[t];o&&i(e,o,t,r)}return e})}(function(e,a,t){_baseMerge(e,a,t)}),d.pick=_flatRest(function(e,a){return null==e?{}:_basePick(e,a)}),d.forEach=d.each,window._||(window._=d)}function object(){}function baseGt(e,a){return a<e}function identity(e){return e}function _identity(e){return e}function _isIterateeCall(e,a,t){if(!_isObject(t))return!1;var n=typeof a;return!!("number"==n?_isArrayLike(t)&&_isIndex(a,t.length):"string"==n&&a in t)&&_eq(t[a],e)}function _baseRest(e,a){return v.setToString(v.overRest(e,a,_identity),e+"")}function _baseUniq(e,a,t){var n=-1,r=_arrayIncludes,s=e.length,o=!0,i=[],p=i;if(t)o=!1,r=_arrayIncludesWith;else if(s>=v.LARGE_ARRAY_SIZE){var l=a?null:v.createSet(e);if(l)return v.setToArray(l);o=!1,r=_cacheHas,p=new v.SetCache}else p=a?[]:i;e:for(;++n<s;){var c=e[n],d=a?a(c):c;if(c=t||0!==c?c:0,o&&d==d){for(var u=p.length;u--;)if(p[u]===d)continue e;a&&p.push(d),i.push(c)}else r(p,d,t)||(p!==i&&p.push(d),i.push(c))}return i}function _isArrayLikeObject(e){return _isObjectLike(e)&&_isArrayLike(e)}function _baseFlatten(e,a,t,n,r){var s=-1,o=e.length;for(t=t||_isFlattenable,r=r||[];++s<o;){var i=e[s];0<a&&t(i)?1<a?_baseFlatten(i,a-1,t,n,r):_arrayPush(r,i):n||(r[r.length]=i)}return r}function _flatten(e){return(null==e?0:e.length)?_baseFlatten(e,1):[]}function _baseGetAllKeys(e,a,t){var n=a(e);return _isArray(e)?n:_arrayPush(n,t(e))}function _getAllKeysIn(e){return _baseGetAllKeys(e,_keysIn,h)}function _baseUnset(e,a){return null==(e=function _parent(e,a){return a.length<2?e:_baseGet(e,function _baseSlice(e,a,t){var n=-1,r=e.length;a<0&&(a=r<-a?0:r+a);(t=r<t?r:t)<0&&(t+=r);r=t<a?0:t-a>>>0,a>>>=0;var s=Array(r);for(;++n<r;)s[n]=e[n+a];return s}(a,0,-1))}(e,a=_castPath(a,e)))||delete e[_toKey(_last(a))]}function _castPath(e,a){return _isArray(e)?e:_isKey(e,a)?[e]:function _strToPath(e){var r=[];v.reLeadingDot.test(e)&&r.push("");return e.replace(v.rePropName,function(e,a,t,n){r.push(t?n.replace(v.reEscapeChar,"$1"):a||e)}),r}(function _toString(e){return null==e?"":_baseToString(e)}(e))}function _flatRest(e){return v.setToString(v.overRest(e,void 0,_flatten),e+"")}function _isPlainObject(e){if(!_isObjectLike(e)||_baseGetTag(e)!=v.objectTag)return!1;var a=p(e);if(null===a)return!0;var t=b.call(a,"constructor")&&a.constructor;return"function"==typeof t&&t instanceof t&&n.call(t)==o}function _customOmitClone(e){return _isPlainObject(e)?void 0:e}function _copyArray(e,a){var t=-1,n=e.length;for(a=a||Array(n);++t<n;)a[t]=e[t];return a}function _copyObject(e,a,t,n){var r=!t;t=t||{};for(var s=-1,o=a.length;++s<o;){var i=a[s],p=n?n(t[i],e[i],i,t,e):void 0;void 0===p&&(p=e[i]),r?_baseAssignValue(t,i,p):_assignValue(t,i,p)}return t}function _cloneBuffer(e,a){if(a)return e.slice();var t=e.length,n=r?r(t):new e.constructor(t);return e.copy(n),n}function _initCloneObject(e){return"function"!=typeof e.constructor||_isPrototype(e)?{}:v.baseCreate(p(e))}function _cloneArrayBuffer(e){var a=new e.constructor(e.byteLength);return new v.Uint8Array(a).set(new v.Uint8Array(e)),a}function _cloneTypedArray(e,a){var t=a?_cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}function _mapToArray(e){var t=-1,n=Array(e.size);return e.forEach(function(e,a){n[++t]=[a,e]}),n}function _arrayReduce(e,a,t,n){var r=-1,s=null==e?0:e.length;for(n&&s&&(t=e[++r]);++r<s;)t=a(t,e[r],r,e);return t}function _addMapEntry(e,a){return e.set(a[0],a[1]),e}function _addSetEntry(e,a){return e.add(a),e}function _initCloneByTag(e,a,t,n){var r=e.constructor;switch(a){case v.numberTag:case v.stringTag:return new r(e);case v.boolTag:case v.dateTag:return new r(+e);case v.arrayBufferTag:return _cloneArrayBuffer(e);case v.float32Tag:case v.float64Tag:case v.int8Tag:case v.int16Tag:case v.int32Tag:case v.uint8Tag:case v.uint8ClampedTag:case v.uint16Tag:case v.uint32Tag:return _cloneTypedArray(e,n);case v.mapTag:return function _cloneMap(e,a,t){return _arrayReduce(a?t(_mapToArray(e),v.CLONE_DEEP_FLAG):_mapToArray(e),_addMapEntry,new e.constructor)}(e,n,t);case v.dataViewTag:return function _cloneDataView(e,a){var t=a?_cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)}(e,n);case v.regexpTag:return function _cloneRegExp(e){var a=new e.constructor(e.source,v.reFlags.exec(e));return a.lastIndex=e.lastIndex,a}(e);case v.setTag:return function _cloneSet(e,a,t){return _arrayReduce(a?t(v.setToArray(e),v.CLONE_DEEP_FLAG):v.setToArray(e),_addSetEntry,new e.constructor)}(e,n,t);case v.symbolTag:return function _cloneSymbol(e){return v.symbolValueOf?Object(v.symbolValueOf.call(e)):{}}(e)}}function _assignValue(e,a,t){var n=e[a];b.call(e,a)&&_eq(n,t)&&(void 0!==t||a in e)||_baseAssignValue(e,a,t)}function _keys(e){return _isObject(e)?_baseKeys(e):_isString(e)?_baseKeys(e.split("")):[]}function _keysIn(e){return _isArrayLike(e)?function _arrayLikeKeys(e,a){var t=_isArray(e),n=!t&&_(e),r=!t&&!n&&g(e),s=!t&&!n&&!r&&_isTypedArray(e),o=t||n||r||s,i=o?function _baseTimes(e,a){var t=-1,n=Array(e);for(;++t<e;)n[t]=a(t);return n}(e.length,String):[],p=i.length;for(var l in e)!a&&!b.call(e,l)||o&&("length"==l||r&&("offset"==l||"parent"==l)||s&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||_isIndex(l,p))||i.push(l);return i}(e,!0):function _baseKeysIn(e){if(!_isObject(e))return function _nativeKeysIn(e){var a=[];if(null!=e)for(var t in Object(e))a.push(t);return a}(e);var a=_isPrototype(e),t=[];for(var n in e)("constructor"!=n||!a&&b.call(e,n))&&t.push(n);return t}(e)}function _getAllKeys(e){return _baseGetAllKeys(e,keys,v.getSymbols)}function _arrayEach(e,a){for(var t=-1,n=null==e?0:e.length;++t<n&&!1!==a(e[t],t,e););return e}function _baseClone(t,n,r,e,a,s){var o,i=n&CLONE_DEEP_FLAG,p=n&CLONE_FLAT_FLAG,l=n&CLONE_SYMBOLS_FLAG;if(r&&(o=a?r(t,e,a,s):r(t)),void 0!==o)return o;if(!_isObject(t))return t;var c=_isArray(t);if(c){if(o=function _initCloneArray(e){var a=e.length,t=e.constructor(a);return a&&"string"==typeof e[0]&&b.call(e,"index")&&(t.index=e.index,t.input=e.input),t}(t),!i)return _copyArray(t,o)}else{var d=_getTag(t),u=d==v.funcTag||d==v.genTag;if(g(t))return _cloneBuffer(t,i);if(d==v.objectTag||d==v.argsTag||u&&!a){if(o=p||u?{}:_initCloneObject(t),!i)return p?function _copySymbolsIn(e,a){return _copyObject(e,h(e),a)}(t,function _baseAssignIn(e,a){return e&&_copyObject(a,_keysIn(a),e)}(o,t)):function _copySymbols(e,a){return _copyObject(e,v.getSymbols(e),a)}(t,function _baseAssign(e,a){return e&&_copyObject(a,_keys(a),e)}(o,t))}else{if(!v.cloneableTags[d])return a?t:{};o=_initCloneByTag(t,d,_baseClone,i)}}var f=(s=s||new v.Stack).get(t);if(f)return f;s.set(t,o);var m=c?void 0:(l?p?_getAllKeysIn:_getAllKeys:p?_keysIn:_keys)(t);return _arrayEach(m||t,function(e,a){m&&(e=t[a=e]),_assignValue(o,a,_baseClone(e,n,r,a,t,s))}),o}function _isString(e){return"string"==typeof e||!_isArray(e)&&_isObjectLike(e)&&_baseGetTag(e)==v.stringTag}function _isObject(e){var a=typeof e;return null!=e&&("object"==a||"function"==a)}function _isObjectLike(e){return null!=e&&"object"==typeof e}function _isFunction(e){return null!=e&&"function"==typeof e}function _isArray(e){return"[object Array]"===Object.prototype.toString.call(e)}function _isLength(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=v.MAX_SAFE_INTEGER}function _isIndex(e,a){return!!(a=null==a?v.MAX_SAFE_INTEGER:a)&&("number"==typeof e||v.reIsUint.test(e))&&-1<e&&e%1==0&&e<a}function _isArrayLike(e){return null!=e&&_isLength(e.length)&&!_isFunction(e)}function _isKey(e,a){if(_isArray(e))return!1;var t=typeof e;return"number"==t||"symbol"==t||"boolean"==t||null==e||(v.reIsPlainProp.test(e)||!v.reIsDeepProp.test(e)||null!=a&&e in Object(a))}function _isPrototype(e){var a=e&&e.constructor;return e===("function"==typeof a&&a.prototype||v.objectProto)}function _isSymbol(e){return"symbol"==typeof e||_isObjectLike(e)&&_getTag(e)==v.symbolTag}function _isTypedArray(e){return _isObjectLike(e)&&_isLength(e.length)&&!!v.typedArrayTags[_getTag(e)]}function _isFlattenable(e){return _isArray(e)||!!(v.spreadableSymbol&&e&&e[v.spreadableSymbol])}function _objectToString(e){return s.call(e)}function _isStrictComparable(e){return e==e&&!_isObject(e)}function _eq(e,a){return e===a||e!=e&&a!=a}function _assocIndexOf(e,a){for(var t=e.length;t--;)if(_eq(e[t][0],a))return t;return-1}function _baseIsNaN(e){return e!=e}function _toFinite(e){var a=v.INFINITY,t=v.MAX_INTEGER;return e?(e*=1)!==a&&e!==-a?e==e?e:0:(e<0?-1:1)*t:0===e?e:0}function _toKey(e){if("string"==typeof e)return e;var a=e+"";return"0"==a&&1/e==-v.INFINITY?"-0":a}function _baseToString(e){if("string"==typeof e)return e;if(_isArray(e))return _arrayMap(e,_baseToString)+"";var a=e+"";return"0"==a&&1/e==-v.INFINITY?"-0":a}function _toInteger(e){var a=_toFinite(e),t=a%1;return a==a?t?a-t:a:0}function _arrayMap(e,a){for(var t=-1,n=null==e?0:e.length,r=Array(n);++t<n;)r[t]=a(e[t],t,e);return r}function _last(e){var a=null==e?0:e.length;return a?e[a-1]:void 0}function _hasPath(e,a,t){for(var n=-1,r=(a=_castPath(a,e)).length,s=!1;++n<r;){var o=_toKey(a[n]);if(!(s=null!=e&&t(e,o)))break;e=e[o]}return s||++n!=r?s:!!(r=null==e?0:e.length)&&_isLength(r)&&_isArray(e)}function _baseHas(e,a){return null!=e&&b.call(e,a)}function _baseHasIn(e,a){return null!=e&&a in Object(e)}function _hasIn(e,a){return null!=e&&_hasPath(e,a,_baseHasIn)}function _get(e,a,t){var n=null==e?void 0:_baseGet(e,a);return void 0===n?t:n}function _findIndex(e,a,t){var n=null==e?0:e.length;if(!n)return-1;var r=null==t?0:_toInteger(t);return r<0&&(r=Math.max(n+r,0)),_baseFindIndex(e,_getIteratee(a,3),r)}function _property(e){return _isKey(e)?function _baseProperty(a){return function(e){return null==e?void 0:e[a]}}(_toKey(e)):function _basePropertyDeep(a){return function(e){return _baseGet(e,a)}}(e)}function _pullAll(e,a){return e&&e.length&&a&&a.length?function _basePullAll(e,a,t,n){var r=n?_baseIndexOfWith:_baseIndexOf,s=-1,o=a.length,i=e;e===a&&(a=_copyArray(a));t&&(i=_arrayMap(e,_baseUnary(t)));for(;++s<o;)for(var p=0,l=a[s],c=t?t(l):l;-1<(p=r(i,c,p,n));)i!==e&&v.splice.call(i,p,1),v.splice.call(e,p,1);return e}(e,a):e}function _matchesStrictComparable(a,t){return function(e){return null!=e&&(e[a]===t&&(void 0!==t||a in Object(e)))}}function _basePick(t,e){return function _basePickBy(e,a,t){var n=-1,r=a.length,s={};for(;++n<r;){var o=a[n],i=_baseGet(e,o);t(i,o)&&_baseSet(s,_castPath(o,e),i)}return s}(t,e,function(e,a){return _hasIn(t,a)})}function _baseSet(e,a,t,n){if(!_isObject(e))return e;for(var r=-1,s=(a=_castPath(a,e)).length,o=s-1,i=e;null!=i&&++r<s;){var p=_toKey(a[r]),l=t;if(r!=o){var c=i[p];void 0===(l=n?n(c,p,i):void 0)&&(l=_isObject(c)?c:_isIndex(a[r+1])?[]:{})}_assignValue(i,p,l),i=i[p]}return e}function _baseIndexOf(e,a,t){return a==a?function _strictIndexOf(e,a,t){var n=t-1,r=e.length;for(;++n<r;)if(e[n]===a)return n;return-1}(e,a,t):_baseFindIndex(e,_baseIsNaN,t)}function _baseIndexOfWith(e,a,t,n){for(var r=t-1,s=e.length;++r<s;)if(n(e[r],a))return r;return-1}function _baseKeys(e){if(!_isPrototype(e))return i(e);var a=[];for(var t in Object(e))b.call(e,t)&&"constructor"!=t&&a.push(t);return a}function _baseGet(e,a){for(var t=0,n=(a=_castPath(a,e)).length;null!=e&&t<n;)e=e[_toKey(a[t++])];return t&&t==n?e:void 0}function _baseGetTag(e){return null==e?void 0===e?v.undefinedTag:v.nullTag:v.symToStringTag&&v.symToStringTag in Object(e)?_getRawTag(e):_objectToString(e)}function _getRawTag(e){var a=b.call(e,v.symToStringTag),t=e[v.symToStringTag];try{var n=!(e[v.symToStringTag]=void 0)}catch(e){}var r=s.call(e);return n&&(a?e[v.symToStringTag]=t:delete e[v.symToStringTag]),r}function _getTag(e){return null==e?void 0===e?v.undefinedTag:v.nullTag:v.symToStringTag&&v.symToStringTag in Object(e)?_getRawTag(e):_objectToString(e)}function _baseAssignValue(e,a,t){"__proto__"==a&&v.defineProperty?v.defineProperty(e,a,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[a]=t}function _baseAt(e,a){for(var t=-1,n=a.length,r=Array(n),s=null==e;++t<n;)r[t]=s?void 0:_get(e,a[t]);return r}function _arrayPush(e,a){for(var t=-1,n=a.length,r=e.length;++t<n;)e[r+t]=a[t];return e}function _arrayEvery(e,a){for(var t=-1,n=null==e?0:e.length;++t<n;)if(!a(e[t],t,e))return!1;return!0}function _arrayMap(e,a){for(var t=-1,n=null==e?0:e.length,r=Array(n);++t<n;)r[t]=a(e[t],t,e);return r}function _arraySome(e,a){for(var t=-1,n=null==e?0:e.length;++t<n;)if(a(e[t],t,e))return!0;return!1}function _arrayIncludes(e,a){return!!(null==e?0:e.length)&&-1<_baseIndexOf(e,a,0)}function _arrayIncludesWith(e,a,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(a,e[n]))return!0;return!1}function _arrayFilter(e,a){for(var t=-1,n=null==e?0:e.length,r=0,s=[];++t<n;){var o=e[t];a(o,t,e)&&(s[r++]=o)}return s}function _equalArrays(e,a,t,n,r,s){var o=t&v.COMPARE_PARTIAL_FLAG,i=e.length,p=a.length;if(i!=p&&!(o&&i<p))return!1;var l=s.get(e);if(l&&s.get(a))return l==a;var c=-1,d=!0,u=t&v.COMPARE_UNORDERED_FLAG?new v.SetCache:void 0;for(s.set(e,a),s.set(a,e);++c<i;){var f=e[c],m=a[c];if(n)var g=o?n(m,f,c,a,e,s):n(f,m,c,e,a,s);if(void 0!==g){if(g)continue;d=!1;break}if(u){if(!_arraySome(a,function(e,a){if(!_cacheHas(u,a)&&(f===e||r(f,e,t,n,s)))return u.push(a)})){d=!1;break}}else if(f!==m&&!r(f,m,t,n,s)){d=!1;break}}return s.delete(e),s.delete(a),d}function _cacheHas(e,a){return e.has(a)}function _compareAscending(e,a){if(e!==a){var t=void 0!==e,n=null===e,r=e==e,s=_isSymbol(e),o=void 0!==a,i=null===a,p=a==a,l=_isSymbol(a);if(!i&&!l&&!s&&a<e||s&&o&&p&&!i&&!l||n&&o&&p||!t&&p||!r)return 1;if(!n&&!s&&!l&&e<a||l&&t&&r&&!n&&!s||i&&t&&r||!o&&r||!p)return-1}return 0}function _baseFindIndex(e,a,t,n){for(var r=e.length,s=t+(n?1:-1);n?s--:++s<r;)if(a(e[s],s,e))return s;return-1}function _baseIsEqualDeep(e,a,t,n,r,s){var o=_isArray(e),i=_isArray(a),p=o?v.arrayTag:_getTag(e),l=i?v.arrayTag:_getTag(a);p=p==v.argsTag?v.objectTag:p,l=l==v.argsTag?v.objectTag:l;var c=p==v.objectTag,d=l==v.objectTag,u=p==l;if(u&&g(e)){if(!g(a))return!1;c=!(o=!0)}if(u&&!c)return s=s||new v.Stack,o||_isTypedArray(e)?_equalArrays(e,a,t,n,r,s):function _equalByTag(e,a,t,n,r,s,o){switch(t){case v.dataViewTag:if(e.byteLength!=a.byteLength||e.byteOffset!=a.byteOffset)return!1;e=e.buffer,a=a.buffer;case v.arrayBufferTag:return!(e.byteLength!=a.byteLength||!s(new v.Uint8Array(e),new v.Uint8Array(a)));case v.boolTag:case v.dateTag:case v.numberTag:return _eq(+e,+a);case v.errorTag:return e.name==a.name&&e.message==a.message;case v.regexpTag:case v.stringTag:return e==a+"";case v.mapTag:var i=_mapToArray;case v.setTag:var p=n&v.COMPARE_PARTIAL_FLAG;if(i=i||v.setToArray,e.size!=a.size&&!p)return!1;var l=o.get(e);if(l)return l==a;n|=v.COMPARE_UNORDERED_FLAG,o.set(e,a);var c=_equalArrays(i(e),i(a),n,r,s,o);return o.delete(e),c;case v.symbolTag:if(v.symbolValueOf)return v.symbolValueOf.call(e)==v.symbolValueOf.call(a)}return!1}(e,a,p,t,n,r,s);if(!(t&v.COMPARE_PARTIAL_FLAG)){var f=c&&b.call(e,"__wrapped__"),m=d&&b.call(a,"__wrapped__");if(f||m)return r(f?e.value():e,m?a.value():a,t,n,s=s||new v.Stack)}return u&&function _equalObjects(e,a,t,n,r,s){var o=t&v.COMPARE_PARTIAL_FLAG,i=_getAllKeys(e),p=i.length;if(p!=_getAllKeys(a).length&&!o)return!1;for(var l=p;l--;){var c=i[l];if(!(o?c in a:b.call(a,c)))return!1}var d=s.get(e);if(d&&s.get(a))return d==a;var u=!0;s.set(e,a),s.set(a,e);for(var f=o;++l<p;){var m=e[c=i[l]],g=a[c];if(n)var h=o?n(g,m,c,a,e,s):n(m,g,c,e,a,s);if(!(void 0===h?m===g||r(m,g,t,n,s):h)){u=!1;break}f=f||"constructor"==c}if(u&&!f){var _=e.constructor,y=a.constructor;_!=y&&"constructor"in e&&"constructor"in a&&!("function"==typeof _&&_ instanceof _&&"function"==typeof y&&y instanceof y)&&(u=!1)}return s.delete(e),s.delete(a),u}(e,a,t,n,r,s=s||new v.Stack)}function _baseIsEqual(e,a,t,n,r){return e===a||(null==e||null==a||!_isObjectLike(e)&&!_isObjectLike(a)?e!=e&&a!=a:_baseIsEqualDeep(e,a,t,n,_baseIsEqual,r))}function _baseIsArguments(e){return _isObjectLike(e)&&_baseGetTag(e)==v.argsTag}function _baseMatches(a){var t=function _getMatchData(e){for(var a=_keys(e),t=a.length;t--;){var n=a[t],r=e[n];a[t]=[n,r,_isStrictComparable(r)]}return a}(a);return 1==t.length&&t[0][2]?_matchesStrictComparable(t[0][0],t[0][1]):function(e){return e===a||function _baseIsMatch(e,a,t,n){var r=t.length,s=r,o=!n;if(null==e)return!s;for(e=Object(e);r--;){var i=t[r];if(o&&i[2]?i[1]!==e[i[0]]:!(i[0]in e))return!1}for(;++r<s;){var p=(i=t[r])[0],l=e[p],c=i[1];if(o&&i[2]){if(void 0===l&&!(p in e))return!1}else{var d=new v.Stack;if(n)var u=n(l,c,p,e,a,d);if(!(void 0===u?_baseIsEqual(c,l,v.COMPARE_PARTIAL_FLAG|v.COMPARE_UNORDERED_FLAG,n,d):u))return!1}}return!0}(e,a,t)}}function _baseIteratee(e){return"function"==typeof e?e:null==e?_identity:"object"==typeof e?_isArray(e)?function _baseMatchesProperty(t,n){return _isKey(t)&&_isStrictComparable(n)?_matchesStrictComparable(_toKey(t),n):function(e){var a=_get(e,t);return void 0===a&&a===n?_hasIn(e,t):_baseIsEqual(n,a,v.COMPARE_PARTIAL_FLAG|v.COMPARE_UNORDERED_FLAG)}}(e[0],e[1]):_baseMatches(e):_property(e)}function _getIteratee(e,a){var t=_baseIteratee;return arguments.length?t(e,a):t}function _basePullAt(e,a){for(var t=e?a.length:0,n=t-1;t--;){var r=a[t];if(t==n||r!==s){var s=r;_isIndex(r)?v.splice.call(e,r,1):_baseUnset(e,r)}}return e}function _baseUnary(a){return function(e){return a(e)}}function _baseFor(e,a,t,n){for(var r=-1,s=Object(e),o=t(e),i=o.length;i--;){var p=o[n?i:++r];if(!1===a(s[p],p,s))break}return e}function _baseEvery(e,n){var r=!0;return c(e,function(e,a,t){return r=!!n(e,a,t)}),r}function _baseMap(e,n){var r=-1,s=_isArrayLike(e)?Array(e.length):[];return c(e,function(e,a,t){s[++r]=n(e,a,t)}),s}function _baseSome(e,n){var r;return c(e,function(e,a,t){return!(r=n(e,a,t))}),!!r}function _baseOrderBy(e,t,n){var r=-1;return t=_arrayMap(t.length?t:[_identity],_baseUnary(_getIteratee())),function _baseSortBy(e,a){var t=e.length;for(e.sort(a);t--;)e[t]=e[t].value;return e}(_baseMap(e,function(a){return{criteria:_arrayMap(t,function(e){return e(a)}),index:++r,value:a}}),function(e,a){return function _compareMultiple(e,a,t){for(var n=-1,r=e.criteria,s=a.criteria,o=r.length,i=t.length;++n<o;){var p=_compareAscending(r[n],s[n]);if(p)return i<=n?p:p*("desc"==t[n]?-1:1)}return e.index-a.index}(e,a,n)})}function _baseFilter(e,n){var r=[];return c(e,function(e,a,t){n(e,a,t)&&r.push(e)}),r}function _assignMergeValue(e,a,t){(void 0===t||_eq(e[a],t))&&(void 0!==t||a in e)||_baseAssignValue(e,a,t)}function _baseMergeDeep(e,a,t,n,r,s,o){var i=e[t],p=a[t],l=o.get(p);if(l)_assignMergeValue(e,t,l);else{var c=s?s(i,p,t+"",e,a,o):void 0,d=void 0===c;if(d){var u=_isArray(p),f=!u&&g(p),m=!u&&!f&&_isTypedArray(p);c=p,u||f||m?c=_isArray(i)?i:_isArrayLikeObject(i)?_copyArray(i):f?_cloneBuffer(p,!(d=!1)):m?_cloneTypedArray(p,!(d=!1)):[]:_isPlainObject(p)||_(p)?_(c=i)?c=function _toPlainObject(e){return _copyObject(e,_keysIn(e))}(i):(!_isObject(i)||n&&_isFunction(i))&&(c=_initCloneObject(p)):d=!1}d&&(o.set(p,c),r(c,p,n,s,o),o.delete(p)),_assignMergeValue(e,t,c)}}function _baseMerge(n,r,s,o,i){n!==r&&_baseFor(r,function(e,a){if(_isObject(e))i=i||new v.Stack,_baseMergeDeep(n,r,a,s,_baseMerge,o,i);else{var t=o?o(n[a],e,a+"",n,r,i):void 0;void 0===t&&(t=e),_assignMergeValue(n,a,t)}},_keysIn)}}(),
/** @license (MIT) SPA.js (core) | https://github.com/sucom/SPA.js/blob/master/LICENSE */
function(){var win=this,spa=function(e){return e instanceof spa?e:this instanceof spa?void 0:new spa(e)};win.spa=win.__=win._$=win.w3=spa,spa.VERSION="2.71.0-RC2";var isById=document.getElementById,isByName=document.all,_appApiInitialized,keyPauseTimer;function _sanitizeHTML(e){var a=document.createElement("div");return a.textContent=e,a.innerHTML}function _sanitizeScript(e){return(""+e).replace(/<\s*\/+\s*(\bscript\b)/gi,"&lt;/script&gt;</pre").replace(/<\s*(\bscript\b)/gi,"<pre>&lt;script")}function _sanitizeXSS(e){return _sanitizeScript(e).replace(/\s+on([a-z])\s*=/gi," on=").replace(/javascript:/gi,"js:")}function getMatchStr(e){switch(e){case"{":return"}";case"[":return"]";case"<":return">";default:return e}}function _isValidEvalStr(e){if(!spa.jsonDataSanityCheck)return!0;var a=e.indexOf("(");return!(0<=a&&e.indexOf(")",a)>a)||(console.warn("Insecured String with braces():",e),!1)}function __finalValue(e){var a=e,t=arguments[1],n=Array.prototype.slice.call(arguments,2);return _is(a,"string")&&(0<a.indexOf("(")&&(a=a.getLeftStr("(")),a=spa.findSafe(window,a.trim(),void 0)),_is(a,"function")&&1<arguments.length&&(a=a.apply(t,n)),a}function _initKeyTracking(){var e=arguments.length&&arguments[0]?arguments[0]:"[data-disable-keys],[data-focus-next],[data-focus-back]",a=$(2==arguments.length&&arguments[1]?arguments[1]:"body").find(e);spa.console.info("Finding Key-Tracking for element(s): "+e),a.each(function(e,a){$(a).keydown(spa._trackAndControlKey),spa.console.info("SPA is tracking keys on element:"),spa.console.info(a)})}function _initKeyPauseEvent(e){$(e||"body").find("[onKeyPause]:not([onKeyPauseReg])").each(function(e,a){$(a).attr("onKeyPauseReg","").on("input propertychange paste",function(){var t=this,e=1*((""+t.getAttribute("data-pause-time")).replace(/[^0-9]/g,"")||"1250");keyPauseTimer&&clearTimeout(keyPauseTimer),keyPauseTimer=setTimeout(function(){var e=t.getAttribute("onKeyPause").split("(")[0],a=spa.findSafe(window,e);a&&a.call(t,t)},e)})})}spa.isIE=!!isByName,spa.isNonIE=!(!isById||isByName),spa.noop=function(){},spa.debug=!1,spa.debugger={on:function(){spa.debug=!0},off:function(){spa.debug=!1},toggle:function(){spa.debug=!spa.debug}},spa.cOut=function(e,a){spa.debug&&console[e]&&console[e](1===a.length?a[0]:a)},spa.console={clear:function(){console.clear()},assert:function(){spa.cOut("assert",arguments)},count:function(){spa.cOut("count",arguments)},debug:function(){spa.cOut("debug",arguments)},dir:function(){spa.cOut("dir",arguments)},dirxml:function(){spa.cOut("dirxml",arguments)},error:function(){spa.cOut("error",arguments)},exception:function(){spa.cOut("exception",arguments)},group:function(){spa.cOut("group",arguments)},groupCollapsed:function(){spa.cOut("groupCollapsed",arguments)},groupEnd:function(){spa.cOut("groupEnd",arguments)},info:function(){spa.cOut("info",arguments)},log:function(){spa.cOut("log",arguments)},markTimeline:function(){spa.cOut("markTimeline",arguments)},profile:function(){spa.cOut("profile",arguments)},profileEnd:function(){spa.cOut("profileEnd",arguments)},table:function(){spa.cOut("table",arguments)},time:function(){spa.cOut("time",arguments)},timeEnd:function(){spa.cOut("timeEnd",arguments)},timeStamp:function(){spa.cOut("timeStamp",arguments)},trace:function(){spa.cOut("trace",arguments)},warn:function(){spa.cOut("warn",arguments)}},spa.ajaxPreProcess,spa.onInit,spa.onInitComplete,spa.onReady,spa.onUrlChange,spa.onUrlHashChange,spa.onReload,Date.prototype.yyyymmdd=function(e){var a=this.getMonth()+1,t=this.getDate();return[this.getFullYear(),(9<a?"":"0")+a,(9<t?"":"0")+t].join(e||"")},Date.prototype.hhmmss=function(e){var a=this.getHours(),t=this.getMinutes(),n=this.getSeconds();return[(9<a?"":"0")+a,(9<t?"":"0")+t,(9<n?"":"0")+n].join(e||"")},String.prototype.trimLeftStr=function(e){return(""+this).replace(new RegExp("^["+(e||"\\s")+"]+","g"),"")},String.prototype.trimRightStr=function(e){return(""+this).replace(new RegExp("["+(e||"\\s")+"]+$","g"),"")},String.prototype.trimStr=function(e){return(""+this).trimLeftStr(e).trimRightStr(e)},String.prototype.getLeftStr=function(e){return"string"==typeof e&&(e=(""+this).indexOf(e)),e?(""+this).substr(0,e):""},String.prototype.getRightStr=function(e){var a=1;return"string"==typeof e&&(a=e.length,e=(""+this).indexOf(e)),e<0?"":(""+this).substr(e+a)},String.prototype.isBlankStr=function(){return""==(""+this).trimStr()},String.prototype.ifBlankStr=function(e,a){return e=void 0===e?"":e,a=void 0===a?(""+this).trimStr():a,(""+this).isBlankStr()?e:a},String.prototype.isNumberStr=function(){var e=(""+this).trim(),a=e.replace(/[0-9]/g,"").replace(".","").trimStr(),t=e[0];return e&&(0==a.length||1==a.length&&("+"==t||"-"==t))},String.prototype.normalizeStr=function(){return(""+this).trimStr().replace(/\s+/g," ")},String.prototype.beginsWithStr=function(e,a){a=a?"i":"";var t=new RegExp("^"+e,a);return!!(""+this).normalizeStr().match(t)},String.prototype.beginsWithStrIgnoreCase=function(e){var a=new RegExp("^"+e,"i");return!!(""+this).normalizeStr().match(a)},String.prototype.endsWithStr=function(e,a){a=a?"i":"";var t=new RegExp(e+"$",a);return!!(""+this).normalizeStr().match(t)},String.prototype.endsWithStrIgnoreCase=function(e){var a=new RegExp(e+"$","i");return!!(""+this).normalizeStr().match(a)},String.prototype.containsStr=function(e,a){return a=a?"gi":"g",new RegExp(""+e,a).test(""+this)},String.prototype.containsStrIgnoreCase=function(e){return new RegExp(""+e,"gi").test(""+this)},String.prototype.equals=function(e){return""+this==e},String.prototype.equalsIgnoreCase=function(e){return String((""+this).toLowerCase())==String(e).toLowerCase()},String.prototype.toProperCase=function(e){return(void 0===e||e?(""+this).normalizeStr():""+this).toLowerCase().replace(/^(.)|\s(.)/g,function(e){return e.toUpperCase()})},String.prototype.toTitleCase=function(e){return(void 0===e||e?(""+this).normalizeStr():""+this).toLowerCase().replace(/^(.)|\s(.)/g,function(e){return e.toUpperCase()})},String.prototype.capitalize=function(){return(""+this).charAt(0).toUpperCase()+(""+this).slice(1)},String.prototype.unCapitalize=function(){return(""+this).charAt(0).toLowerCase()+(""+this).slice(1)},String.prototype.sanitizeHTML=function(){return _sanitizeHTML(""+this)},spa.sanitizeHTML=_sanitizeHTML,String.prototype.sanitizeScript=function(){return _sanitizeScript(""+this)},spa.sanitizeScript=_sanitizeScript,String.prototype.sanitizeXSS=function(){return _sanitizeXSS(""+this)},spa.sanitizeXSS=_sanitizeXSS,String.prototype.splitToArray=String.prototype.toArray=function(e){return spa.isBlank(""+this)?[]:(""+this).split(e)},String.prototype.extractStrBetweenIn=function(e,a,t){e=e||((e=(""+this).match(/[^a-z0-9\:\.\/\\]/i))?e[0]:""),a=a||getMatchStr(e);var n=(""+this).match(RegExp("\\"+e+"([^\\"+e+"\\"+a+"].*?)\\"+a,"g"))||[];return t&&!spa.isBlank(n)&&(n=n.__unique()),n},String.prototype.extractStrBetweenEx=function(e,a,t){var n="\\"+(e=e||((e=(""+this).match(/[^a-z0-9\:\.\/\\]/i))?e[0]:""))+"\\"+(a=a||getMatchStr(e)),r=new RegExp("["+n+"]","g"),s=((""+this).match(new RegExp("\\"+e+"([^"+n+"].*?)\\"+a,"g"))||[]).map(function(e){return e.replace(r,"")});return t&&!spa.isBlank(s)&&(s=s.__unique()),s},spa.strToNative=function(e){var a=e.trim();switch(!0){case function isNumeric(){var e=a.replace(/[0-9]/g,"");return!!a.length&&(!e.length||("-"==e||"+"==e||"."==e))}():return 1*a;case function isBoolean(){return"true"==a||"false"==a}():return"true"==a;case function isObject(){return"{"==a[0]&&"}"==a[a.length-1]}():return a.toJSON();case function isArray(){return"["==a[0]&&"]"==a[a.length-1]}():return("{xArr:"+a+"}").toJSON().xArr;default:return e}},String.prototype.toNative=function(){return spa.strToNative(""+this)},spa.extractStrBetweenIn=function(e,a,t,n){return(e||"").extractStrBetweenIn(a,t,n)},spa.extractStrBetweenEx=function(e,a,t,n){return(e||"").extractStrBetweenEx(a,t,n)},spa.strToArray=function(e){return"string"==typeof e&&(e=[e]),e},spa.jsonDataSanityCheck,spa.toJSON=function(str,key4PrimaryDataTypes){var thisStr;if(_.isString(str)){if(thisStr=str.trimStr().trimStr(",").trimStr(";"),!_isValidEvalStr(thisStr))return str;if(thisStr.match(/^\</))return str;if(!(thisStr.containsStr("{")||thisStr.containsStr(":")||thisStr.containsStr("\\[")||thisStr.containsStr("'")||thisStr.containsStr('"'))){if(thisStr.containsStr(",")||thisStr.containsStr(";"))return thisStr.replace(/ /g,"").replace(/;/g,",").split(",");if(!key4PrimaryDataTypes)return spa.strToNative(thisStr);thisStr="{"+key4PrimaryDataTypes+":"+thisStr+"}"}thisStr.containsStr(":")&&!thisStr.containsStr(",")&&thisStr.containsStr(";")&&(thisStr=thisStr.replace(/\;/g,",")),thisStr.beginsWithStr("{")||thisStr.beginsWithStr("\\[")?thisStr.beginsWithStr("{")&&!thisStr.containsStr(":")&&thisStr.containsStr("=")&&(thisStr=""+thisStr.replace(/=/g,":")):thisStr=thisStr.containsStr(":")?"{"+thisStr+"}":thisStr.containsStr("=")?"{"+thisStr.replace(/=/g,":")+"}":"["+thisStr+"]",!thisStr.beginsWithStr("{")&&key4PrimaryDataTypes&&(thisStr="{"+key4PrimaryDataTypes+":"+thisStr+"}")}var jsonObj={};try{jsonObj=!_.isString(str)&&_.isObject(str)?str:spa.isBlank(str)?null:eval("("+thisStr+")")}catch(e){console.error('Error JSON Parse: Invalid String >> "'+str+'"'+e.stack)}return jsonObj},String.prototype.toJSON=function(){return spa.toJSON(""+this)},String.prototype.toBoolean=function(){var e=!0;switch((""+this).trimStr().toLowerCase()){case"":case"0":case"-0":case"nan":case"null":case"false":case"undefined":e=!1}return e=e&&!(""+this).trimStr().beginsWithStr("-")},Boolean.prototype.toValue=function(e,a){return void 0===e&&(e=!0),void 0===a&&(a=!1),(""+this).valueOf()?e:a},Boolean.prototype.toHtml=function(e,a){return $((""+this).valueOf()?e:a).html()},String.prototype.padStr=function(e,a,t){e=e||"",a=a||1,t=t||2;for(var n="",r=0;r<a;r++)n+=e;return(-1===t||2===t?n:"")+""+this+(1===t||2===t?n:"")},spa.lastSplitResult=[],spa.getOnSplit=spa.pickOnSplit=function(e,a,t){return spa.lastSplitResult=e.split(a),spa.getOnLastSplit(t)},spa.getOnLastSplit=spa.pickOnLastSplit=function(e){return e<0?_.last(spa.lastSplitResult):spa.lastSplitResult[e]},spa.isBlank=spa.isEmpty=function(e){var a=!0;if(null!=e)switch(!0){case _.isString(e):a=0==e.trimStr().length;break;case _.isFunction(e):a=!1;break;case _.isArray(e):case _.isObject(e):a=_.isEmpty(e);break;default:a=0==(""+e).trimStr().length}return a},spa.isNumber=function(e){return(""+e).isNumberStr()},spa.toBoolean=function(e){var a=!0;switch((""+e).trimStr().toLowerCase()){case"":case"0":case"-0":case"nan":case"null":case"false":case"undefined":a=!1}return a},spa.toInt=function(e){return e=(""+e).replace(/[^+-0123456789.]/g,""),e=spa.isBlank(e)?"0":0<=e.indexOf(".")?e.substring(0,e.indexOf(".")):e,parseInt(1*e,10)},spa.toFloat=function(e){return e=(""+e).replace(/[^+-0123456789.]/g,""),e=spa.isBlank(e)?"0":e,parseFloat(1*e)},spa.toString=function(e){spa.console.warn("spa.toString is deprecated. use spa.toStr instead.");var a=""+e;return _.isObject(e)&&(a=JSON.stringify(e)),a},spa.toStr=function(e){var a=""+e;return _.isObject(e)&&(a=JSON.stringify(e)),a},spa.dotToX=function(e,a){return e.replace(/\./g,a)},spa.dotToCamelCase=function(e){var a=e.replace(/\./g," ").toProperCase().replace(/ /g,"");return a[0].toLowerCase()+a.substring(1)},spa.dotToTitleCase=function(e){return e.replace(/\./g," ").toProperCase().replace(/ /g,"")},spa.toDottedPath=function(e){return(e||"").trim().replace(/]/g,"").replace(/(\[)|(\\)|(\/)/g,".").replace(/(\.+)/g,".").trimStr("\\.")},spa.ifBlank=spa.ifEmpty=spa.ifNull=function(e,a,t){return a=(""+(a||"")).trimStr(),t=void 0===t?(""+e).trimStr():t,spa.isBlank(e)?a:t},spa.now=function(){return""+(new Date).getTime()},spa.year=function(e){return e=e||0,(new Date).getFullYear()+spa.toInt(e)},spa.sizeOf=function _sizeOf(e,a){var n=0;function sizeOf(e){if(null!=e)switch(typeof e){case"number":n+=8;break;case"string":n+=2*e.length;break;case"boolean":n+=4;break;case"object":var a=Object.prototype.toString.call(e).slice(8,-1);if("Object"===a||"Array"===a)for(var t in e)e.hasOwnProperty(t)&&(n+=2*t.length,sizeOf(e[t]));else n+=2*e.toString().length}return n}return spa.is(a,"undefined")||a?function formatByteSize(e){return e<1024?e+" B":e<1048576?(e/1024).toFixed(3)+" KB":e<1073741824?(e/1048576).toFixed(3)+" MB":(e/1073741824).toFixed(3)+" GB"}(sizeOf(e)):sizeOf(e)},spa.range=function(e){var a=e.toUpperCase().split(".."),t=""+a[0],n=""+a[1],r="1";0<n.indexOf(":")&&(n=""+a[1].split(":")[0],r=""+a[1].split(":")[1]),0<=t.indexOf("Y")&&(t=spa.year(t.split(/[^0-9+-]/)[1])),0<=n.indexOf("Y")&&(n=spa.year(n.split(/[^0-9+-]/)[1]));var s=spa.toInt(t),o=spa.toInt(n),i=spa.toInt(r);return n<t?_.range(o,s+1,i).reverse():_.range(s,o+1,i)},spa.checkAndPreventKey=function(e,a){var t=0<=(a=a||"").indexOf("+shift"),n=""+e.keyCode,r=0<=a.padStr(",").indexOf(n.padStr(","))&&(t?!!e.shiftKey:!e.shiftKey);return r&&(e.preventDefault(),spa.console.info("Key ["+n+(t?"+Shift":"")+"] has been disabled in this element.")),r},spa._trackAndControlKey=function(e){var a=e.currentTarget,t=$(a),n=(""+t.data("disableKeys")).toLowerCase();spa.checkAndPreventKey(e,n);var r=!spa.isBlank((""+t.data("focusNext")).replace(/undefined/,"").toLowerCase()),s=!spa.isBlank((""+t.data("focusBack")).replace(/undefined/,"").toLowerCase());r&&spa.checkAndPreventKey(e,"9")&&$(t.data("focusNext")).get(0).focus(),s&&spa.checkAndPreventKey(e,"9,+shift")&&$(t.data("focusBack")).get(0).focus()},spa.initKeyTracking=_initKeyTracking,spa.getDocObj=function(e){var a="object"==typeof e?e:(e.beginsWithStr("#")?"":"#")+e;return $(a).get(0)},spa.getDocObjs=function(e){var a=(e.beginsWithStr("#")?"":"#")+e;return $(a).get()},spa.hasCssRule=function(e){var a=!1;if(e){e=e.split(",");for(var t=0;t<document.styleSheets.length;t++){var n=document.styleSheets[t].rules||document.styleSheets[t].cssRules;if(a)break;for(var r in n)if(a=a||"string"==typeof n[r].selectorText&&0<=e.indexOf(n[r].selectorText))break}}return a},spa.getCssRule=function(e){var a,t;if(e)for(var n=0;n<document.styleSheets.length;n++){var r=document.styleSheets[n].rules||document.styleSheets[n].cssRules;if(a)break;for(var s in r)if(a=a||"string"==typeof r[s].selectorText&&e==r[s].selectorText){t=r[s];break}}return t},spa.setFocus=function(e,a){var t=spa.getDocObj(e);t&&(t.focus(),a&&t.select())},spa.isElementExist=function(e){return!$.isEmptyObject($(e).get())},spa.swapClass=spa.swapObjClass=function(e,a,t){$(e).removeClass(a),$(e).addClass(t)},spa.docObjValue=function(e,a){var t=spa.getDocObj(e),n="";return t&&(n=t.value,2===arguments.length&&(t.value=a)),n},spa.optionSelectedIndex=function(e,a){var t=-1,n=spa.getDocObj(e);return n&&(t=n.selectedIndex,2===arguments.length&&(n.selectedIndex=a)),t},spa.optionIndexOfValue=function(e,a){var t=-1,n=spa.getDocObj(e);if(n)for(var r=0;r<n.length;r++)if((""+a).equalsIgnoreCase(n.options[r].value)){t=r;break}return t},spa.optionIndexOfText=function(e,a){var t=-1,n=spa.getDocObj(e);if(n)for(var r=0;r<n.length;r++)if(a.equalsIgnoreCase(n.options[r].text)){t=r;break}return t},spa.optionIndexOfValueBeginsWith=function(e,a){var t=-1,n=spa.getDocObj(e);if(n)for(var r=0;r<n.length;r++)if(n.options[r].value.beginsWithStrIgnoreCase(a)){t=r;break}return t},spa.optionsSelectedValues=function(e,a){return e=(e.beginsWithStr("#")?"":"#")+e,a=a||",",$.map($(e+" option:selected"),function(e){return e.value}).join(a)},spa.optionsSelectedTexts=function(e,a){return e=(e.beginsWithStr("#")?"":"#")+e,a=a||",",$.map($(e+" option:selected"),function(e){return e.text}).join(a)},spa.optionValueOfIndex=function(e,a){var t="",n=spa.getDocObj(e);return n&&0<=a&&a<n.length&&(t=n.options[a].value),t},spa.optionTextOfIndex=function(e,a){var t="",n=spa.getDocObj(e);return n&&0<=a&&a<n.length&&(t=n.options[a].text),t},spa.selectOptionForValue=function(e,a){var t=-1,n=spa.getDocObj(e);return n&&(t=spa.optionIndexOfValue(e,a),n.selectedIndex=t),t},spa.selectOptionForValueBeginsWith=function(e,a){var t=-1,n=spa.getDocObj(e);return n&&(t=spa.optionIndexOfValueBeginsWith(e,a),n.selectedIndex=t),t},spa.selectOptionsForValues=function(e,a,t){a=((t=t||",")+a+t).toLowerCase();var n,r=spa.getDocObj(e);if(r)for(var s=0;s<r.length;s++)n=(t+r.options[s].value+t).toLowerCase(),r.options[s].selected=0<=a.indexOf(n)},spa.selectOptionForText=function(e,a){var t=-1,n=spa.getDocObj(e);return n&&(t=spa.optionIndexOfText(e,a),n.selectedIndex=t),t},spa.selectOptionsAll=function(e){var a=spa.getDocObj(e);if(a)for(var t=0;t<a.length;t++)a.options[t].selected=!0},spa.selectOptionsNone=function(e){var a=spa.getDocObj(e);if(a)for(var t=0;t<a.length;t++)a.options[t].selected=!1},spa.optionsReduceToLength=function(e,a){a=a||0;var t=spa.getDocObj(e);t&&(spa.selectOptionsNone(e),t.length=a)},spa.optionsRemoveAll=function(e){spa.optionsReduceToLength(e,0)},spa.optionRemoveForIndex=function(e,a){e=(e.beginsWithStr("#")?"":"#")+e;var t=spa.getDocObj(e);t&&((""+a).equalsIgnoreCase("first")&&(a=0),(""+a).equalsIgnoreCase("last")&&(a=t.length-1),t.remove(a))},spa.optionRemoveForValue=function(e,a){spa.optionRemoveForIndex(e,spa.optionIndexOfValue(e,a))},spa.optionRemoveForText=function(e,a){spa.optionRemoveForIndex(e,spa.optionIndexOfText(e,a))},spa.optionRemoveForValueBeginsWith=function(e,a){spa.optionRemoveForIndex(e,spa.optionIndexOfValueBeginsWith(e,a))},spa.optionAppend=function(e,a,t,n){var r=-1,s=spa.getDocObj(e);if(s)if(void 0===n){var o=s.length;s.length=o+1,s.options[o].value=a,s.options[o].text=t,r=o}else $(s).find("option").eq(n).before('<option value="'+a+'">'+t+"</option>"),r=n;return r},spa.optionsLoad=function(t,e,a,n){if(a=a||0,n=n||0,_.isString(e)&&0<e.indexOf("..")&&(e=spa.range(e)),0<=a&&spa.optionsReduceToLength(t,a),_.isArray(e))_.each(e,function(e){spa.optionAppend(t,e,e)});else if(0<n){var r=[];for(var s in e)r.push({key:s,value:e[s]});var o=_.sortBy(r,["","key","value"][n]);_.each(o,function(e){spa.optionAppend(t,e.key,e.value)})}else _.each(e,function(e,a){spa.optionAppend(t,a,e)})},spa.checkedState=function(e,a){var t=!1,n=spa.getDocObj(e);return n&&(t=n.checked,2===arguments.length&&(n.checked=a)),t},spa.isChecked=function(e,a){return 0<$(e).find("input[name="+a+"]:checked").length},spa.radioSelectedValue=function(e,a){var t=$(e).find("input[name="+a+"]:checked").val();return t||""},spa.radioClearSelection=function(e,a){$(e).find("input[name="+a+"]:checked").attr("checked",!1)},spa.radioSelectForValue=function(e,a,t){$(e).find("input[name="+a+"]:radio").each(function(e){e.checked=e.value.equalsIgnoreCase(t)})},spa.checkboxCheckedValues=function(e,a,t){return t=t||",",$(e).find("input[name="+a+"]:checked").map(function(){return this.value}).get().join(t)},spa.sleep=function(e){var a=new Date;for(a.setTime(a.getTime()+1e3*e);(new Date).getTime()<a.getTime(););},spa.filterJSON=function(e,n){return $(e).filter(function(e,a){for(var t in n)if(!a[t].toString().match(n[t]))return null;return a})},spa.randomPassword=function(e,a){for(var t=a||"9a8b77C8D9E8dkfhseidF7G6H5QJ3c6d5e4f32L3M4N5P6Qg2h3i4j5kV6W5X4Y3Z26m7n8p9q8r7s6t5u4v3w2x3y4z5A6BK7R8S9T8U7",n="",r=0;r<(e||8);r++){var s=Math.floor(Math.random()*t.length);n+=t.charAt(s)}return n},spa.rand=function(e,a){return Math.floor(Math.random()*(a-e+1))+e},spa.htmlEncode=function(e){return $("<div/>").text(e).html()},spa.htmlDecode=function(e){return $("<div/>").html(e).text()},spa.appendToObj=function(e,a,t){_.has(e,a)?(_.isArray(e[a])||(e[a]=[e[a]]),e[a].push(t)):e[a]=t},spa.parseKeyStr=function(e,a){return(a?e.toLowerCase():e).replace(/[^_0-9A-Za-z\$\[\]\?\*\-]/g,"")};var arrayIndexPointsToMap={};function _extract(){var e=Array.prototype.slice.call(arguments);try{spa.is(e[0],"object")||e.unshift({}),spa.is(e[1],"string")&&(e[1]=e[1].split(","))}catch(e){console.error("Invalid arguments",e)}if(spa.is(e[0],"object")&&spa.is(e[1],"array")){var t,n,r,s,o,i,p=e[0],a=e[1],l=e.slice(2);return l.unshift(window),_.each(a,function(e){if(e=(e||"").trim(),!(o=!(e&&"@0"!=e))&&(/^\@([0-9])+/.test(e)&&((s=n=(e.getRightStr(".")||"").trim())?e=s+":"+e:(_.merge(p,l[spa.toInt(e)]),o=!0)),!o)){if(t=e.split(":"),n=(t[0]||"").trim(),r=spa.toInt((t[1]||"").split(".")[0]),s=((t[1]||"").getRightStr(".")||"").trim(),n=n||s,i=s?spa.findSafe(l[r],s):r?l[r]:{},n.endsWithStr("\\+")){n=n.trimRightStr("+");var a=spa.findSafe(p,n);switch(spa.of(a)){case"object":spa.is(i,"object")&&(i=_.merge({},a,i));break;case"array":i=spa.is(i,"array")?a.concat(i):a.push(i)}}spa.setSimpleObjProperty(p,n,i)}}),p}console.error("Invalid arguments.")}function _$qrySelector(e){if(spa.is(e,"string")){var a,t,n=e.trim().split(" "),r=n[0];/app\.(.+)\./.test(r)?(a=r.split(".")[1],n[0]=n[0].replace("app."+a+".",'[data-rendered-component="'+r.split(".")[1]+'"] '),e=n.join(" ")):r.beginsWithStr("\\$")&&(0<(a=r.substr(1)).indexOf(":")?(t=spa.toInt(a.getRightStr(":").trim()),a=a.getLeftStr(":"),n[0]='[data-rendered-component="'+a+'"]:eq('+t+")"):n[0]='[data-rendered-component="'+a+'"]',e=n.join(" "))}return e}function _toQueryString(n){return _.isObject(n)?Object.keys(n).reduce(function(e,a,t){return[e,0===t?"":"&",a=encodeURIComponent(a),"=",_.isArray(n[a])?n[a].map(function(e){return encodeURIComponent(e)}).join(","):encodeURIComponent(n[a])].join("")},""):""}function _of(e){return Object.prototype.toString.call(e).replace(/\[object /,"").replace(/\]/,"").toLowerCase()}function _is(e,a){return 0<=(""+a).toLowerCase().indexOf(of(e))}function _isObjHasKeys(e,a,p){function checkForAll(e,a){for(var t,n=a.split(","),r="",s=0,o=!0,i=0;i<n.length;i++)(r=n[i].trim())&&(s++,t=p&&(0<r.indexOf(".")||0<r.indexOf("["))?spa.hasKey(e,r):e.hasOwnProperty(r),o=o&&t);return s&&o}var t=!1;if(is(e,"object")&&a)switch(a=""+a,!0){case 0<a.indexOf("&"):t=checkForAll(e,a.replace(/\&/g,","));break;case 0<a.indexOf("|"):t=function checkForAny(e,a){for(var t,n=a.split(","),r="",s=0,o=!1,i=0;i<n.length&&((r=n[i].trim())&&(s++,t=p&&(0<r.indexOf(".")||0<r.indexOf("["))?spa.hasKey(e,r):e.hasOwnProperty(r),o=o||t),!o);i++);return s&&o}(e,a.replace(/\|/g,","));break;default:t=checkForAll(e,a)}return t}function _getFullPath4Component(e,a){var t=e;if(a=(a||"").replace(/[^a-z0-9]/gi,"/"),0<=".{$".indexOf(e[0])){var n=e.split("/"),r=n[0].replace(/[\{\}]/g,""),s="$"==r||"."==r?a:r.replace(/[\{\$\}]/,""),o=spa.defaults.components.inFolder?s+"/":"";n[0]=(spa.defaults.components.rootPath+o).trimRightStr("/"),t=n.join("/")}return t}function _getComponentFileName(e){if(/[^a-z0-9]/gi.test(e)){var a=e.split(/[^a-z0-9]/gi);return a[a.length-1]}return e}spa.setObjProperty=function(e,a,t,n){n=n||!1;var r,s,o,i,p=e,l=0<=(a=""+a).indexOf(".")||a==a.toUpperCase()?a.split("."):a.split(/(?=[A-Z])/),c=$.trim(a.replace(/[0-9A-Za-z\[\]\?\*\_]/g,""));c&&""!=c&&(l=a.split(c[0]));for(var d="";1<l.length;)r=spa.parseKeyStr(l.shift(),n),""!=$.trim(r)&&(d+=r.replace(/[\?\[\]\*\_]/g,""),p=0<r.indexOf("[")&&r.indexOf("]")==r.length-1?(o=(s=r.substring(0,r.length-1).replace(/\[/g,".").split("."))[0],i=s[1],void 0===p[o]&&(p[o]=[]),i.replace(/[0-9]/g,"")&&(i=i.replace(/[^0-9]/g,""),arrayIndexPointsToMap.hasOwnProperty(d)?i=arrayIndexPointsToMap[d]:void 0===p[o][i]&&(arrayIndexPointsToMap[d]=p[o].length,i=p[o].length)),void 0===p[o][i]&&(p[o][i]={}),p[o][i]):(void 0===p[r]&&(p[r]={}),p[r]));return r=spa.parseKeyStr(l.shift(),n),spa.appendToObj(p,r,t),e},spa.setSimpleObjProperty=function(e,a,t){for(var n,r=e,s=(a=""+a).split(".");1<s.length;)n=spa.parseKeyStr(s.shift(),!1),""!=$.trim(n)&&(void 0===r[n]&&(r[n]={}),r=r[n]);return r[n=spa.parseKeyStr(s.shift(),!1)]=t,e},spa.objProp=spa.objProperty=spa.objectProp=spa.objectProperty=function(){var e=arguments[0],a=arguments[1],t=arguments[2];return 3==arguments.length?spa.setSimpleObjProperty(e,a,t):2==arguments.length?spa.findSafe(e,a):e},spa.extract=_extract,spa.setElValue=function(e,a){var t=$(_$qrySelector(e));switch((e=t.get(0)).tagName.toUpperCase()){case"INPUT":switch(e.type.toLowerCase()){case"text":case"password":case"hidden":case"color":case"date":case"datetime":case"datetime-local":case"email":case"month":case"number":case"search":case"tel":case"time":case"url":case"range":case"button":case"submit":case"reset":t.val(a),t.isEnabled()&&t.trigger("keyup");break;case"checkbox":case"radio":e.checked=e.value.equalsIgnoreCase(a),e.checked&&t.isEnabled()&&t.trigger("click")}break;case"SELECT":spa.selectOptionForValue(e,a),t.isEnabled()&&t.trigger("change");break;case"TEXTAREA":t.val(a),t.isEnabled()&&t.trigger("keyup");break;default:t.html(spa.sanitizeXSS(a)),t.val(a),t.isEnabled()&&t.trigger("keyup")}},spa.getElValue=function(e,a){if(e=$(_$qrySelector(e)).get(0)){var t,n,r;switch(e.tagName.toUpperCase()){case"INPUT":switch(e.type.toLowerCase()){case"checkbox":n=$(e).data("unchecked"),r="true"==e.value||"false"!=e.value&&e.value,t=e.checked?r:void 0===n?"":n;break;case"radio":t=e.checked?e.value:"";break;default:t=$(e).val()}break;case"SELECT":t=$.map($(e).find("option:selected"),function(e){return e.value}).join(",");break;case"TEXTAREA":t=$(e).val();break;default:t=a?$(e).text():$(e).html()}return t}},spa.serialize=function(e,a,t){_.isBoolean(e)&&(t=e,e=""),_.isBoolean(a)&&(t=a,a=""),e=e||"body";var n,r,s,o,i={},p=a?'[data-serialize-context*="'+a+'"]':"";return $(e).find("[data-serialize]"+p+",input[name]"+p+",select[name]"+p+",textarea[name]"+p).each(function(e,a){s=$(a).data(),n=a.name||s.serialize,o=s.serializeType?s.serializeType.equalsIgnoreCase("text"):t,r=spa.getElValue(a,o),i.hasOwnProperty(n)?spa.isBlank(r)||(spa.isBlank(i[n])?i[n]=r:_.isArray(i[n])?i[n].push(r):i[n]=[i[n],r]):i[n]=r}),i},spa.serializeToQueryString=function(e,a){return spa.toQueryString(spa.serialize(e,a))},spa.serializeDisabled=function(e){var a="";return $(e).find("[disabled][name]").each(function(){a+=(a?"&":"")+$(this).attr("name")+"="+spa.getElValue(this)}),a},spa.serializeForms=function(e,a){var t,n,r=$(e).serialize();return $(e).find("input[data-unchecked]:checkbox:enabled:not(:checked)[name]").each(function(){n=$(this).data("unchecked"),r+=(r?"&":"")+$(this).attr("name")+"="+(void 0===n?"":n)}),a&&(t=spa.serializeDisabled(e),r+=(r&&t?"&":"")+t),r},spa.queryStringToJson=spa.queryStringToObject=function(e){var a={},t=e||location.search,n=(""+t).indexOf("?"),r=(""+t).indexOf("&");return t&&0<t.length&&0<=n&&(0==n||n<r)&&(t=t.substring(n+1)),_.each(t.split("&"),function(e){(e=e.split("="))[0]&&spa.appendToObj(a,e[0],decodeURIComponent(e[1]||""))}),a},spa.toQueryString=spa.ObjectToQueryString=spa.objectToQueryString=spa.JsonToQueryString=spa.jsonToQueryString=_toQueryString,$.fn.serializeUncheckedCheckboxes=function(e){var t,n,r,s,o="object"==typeof e,i=o?e:{},p=o&&!e?"":e;return $(this).find("input[data-unchecked]:checkbox:enabled:not(:checked)[name]").each(function(e,a){t=$(a),r=t.attr("name"),n=t.data("unchecked"),s=void 0===n?"":n,o?spa.appendToObj(i,r,s):p+=(p?"&":"")+r+"="+s}),o?i:p},spa.serializeUncheckedCheckboxes=function(e,a){return $(e).serializeUncheckedCheckboxes(a)},$.fn.serializeFormToJSON=$.fn.serializeFormToObject=function(e,a,t){var n,r,s=this.serializeArray(),o=$(this).data(),i="object"==typeof e?e:{},p="boolean"==typeof e?e:a||!1,l=o.serializeIgnorePrefix,c=o.hasOwnProperty("typeNative");return arrayIndexPointsToMap={},t&&(l=t),$.each(s,function(){n=l?this.name.replace(l,""):this.name,i=spa.setObjProperty(i,n,c?this.value.toNative():this.value,p)}),$(this).find("input[data-unchecked]:checkbox:enabled:not(:checked)[name]").each(function(){(n=$(this).attr("name"))&&(r=$(this).data("unchecked"),l&&(n=n.replace(l,"")),r=""+(void 0===r?"":r),i=spa.setObjProperty(i,n,c?r.toNative():r,p))}),i},spa.serializeFormToJSON=spa.serializeFormToObject=function(e,a,t,n){return $(e).serializeFormToJSON(a,t,n)},$.fn.serializeFormToSimpleJSON=$.fn.serializeFormToSimpleObject=function(e,a){var t,n,r,s,o=this.serializeArray(),i="object"==typeof e?e:{},p="boolean"==typeof e?e:a||!1;return $.each(o,function(){spa.appendToObj(i,this.name,this.value)}),p&&$(this).find("[disabled][name]").each(function(){spa.appendToObj(i,this.name,spa.getElValue(this))}),$(this).find("input[data-unchecked]:checkbox:enabled:not(:checked)[name]").each(function(){r=$(this).attr("name"),s=""+(void 0===(s=$(this).data("unchecked"))?"":s),spa.appendToObj(i,r,s)}),$(this).find("[data-to-json-group][name]").each(function(){t=this.name,(n=$(this).data("toJsonGroup"))&&(i[n]||(i[n]={}),spa.appendToObj(i[n],t,spa.getElValue(this)))}),i},spa.serializeFormToSimpleJSON=spa.serializeFormToSimpleObject=function(e,a,t){return $(e).serializeFormToSimpleJSON(a,t)},spa.findSafe=spa.findInObj=spa.findInObject=spa.locateSafe=spa.valueOfPath=spa.find=spa.locate=function(e,a,t){if(is(e,"window|array|object|function|global")&&a){var n=_.map(a.split("|"),function(e){return e.trim()});a=n.shift();var r,s=n.join("|");if(0<=a.indexOf("*"))r=function(e,a){var t;if("object"==typeof e||"function"==typeof e)if(e.hasOwnProperty(a))t=e[a];else for(var n=Object.keys(e),r=0;is(t,"undefined")&&r<n.length;)t=arguments.callee(e[n[r++]],a);return t}(e,a.replace(/\*/g,""));else{var o=0,i=spa.toDottedPath(a).split("."),p=i.length;for(r=e;o<p;o++)if(is(r,"object|window|function|global"))r=r[i[o].trim()];else{if(!is(r,"array")){r=void 0;break}r=r[spa.toInt(i[o])]}}return is(r,"undefined")?s?spa.findSafe(e,s,t):is(t,"function")?t.call(e,e,a):t:r}return 3==arguments.length?is(t,"function")?t.call(e,e,a):t:e},spa.has=spa.hasKey=function(e,a){var t=e,n=!1;try{n=!!_isValidEvalStr(a)&&void 0!==spa.find(t,a)}catch(e){console.warn("Key["+a+"] error in object.\n"+e.stack)}return n},spa.of=of=_of,spa.is=is=_is,spa.hasPrimaryKeys=function _spa_hasPrimaryKeys(e,a){return _isObjHasKeys(e,a)},spa.hasKeys=function _spa_hasKeys(e,a){return _isObjHasKeys(e,a,!0)},spa.keysDottedAll=function(e){var a=spa.keysDotted(e);return a&&!_.isEmpty(a)&&(a=spa.toDottedPath(a.join(",")).split(",")),a},spa.keysDotted=function(e){var n,r,s,o=[];return function(e,a){if(a=a||"","object"!=typeof e)return;for(var t in e)s=a.substring(1),n=spa.isNumber(t)?"[":".",r=s&&"["==n?"]":"",arguments.callee(e[t],a+n+t+r)&&o.push(s+(s?n:"")+t+r)}(e=e||{}),o},spa.keysCamelCase=function(e){return _.map(spa.keysDotted(e),function(e){var a=e.replace(/\./g," ").toProperCase().replace(/ /g,"");return a[0].toLowerCase()+a.substring(1)})},spa.keysTitleCase=function(e){return _.map(spa.keysDotted(e),function(e){return e.replace(/\./g," ").toProperCase().replace(/ /g,"")})},spa.keys_=function(e){return _.map(spa.keysDotted(e),function(e){return e.replace(/\./g,"_")})},Object.defineProperties(Array.prototype,{__now:{value:function(){return JSON.parse(JSON.stringify(this))},enumerable:!1,configurable:!1},__clone:{value:function(){return JSON.parse(JSON.stringify(this))},enumerable:!1,configurable:!1},__toObject:{value:function(t){var n={};return this.forEach(function(e,a){t?n[e]=a:n[a]=e}),n},enumerable:!1,configurable:!1},__unique:{value:function(){return this.filter(function(e,a,t){return t.indexOf(e)===a})},enumerable:!1,configurable:!1},__rotate:{value:function(e){if(0<(e=e||1))for(;e--;)this.push(this.shift());else if(e<0)for(;e++;)this.unshift(this.pop());return this},enumerable:!1,configurable:!1},__isFirst:{value:function(e,a){var t=this[0];return a&&(t=t.toLowerCase(),e=e.toLowerCase()),t==e},enumerable:!1,configurable:!1},__isLast:{value:function(e,a){var t=this[this.length-1];return a&&(t=t.toLowerCase(),e=e.toLowerCase()),t==e},enumerable:!1,configurable:!1},__has:{value:function(e,a){var t;function optionsHas(e){return 0<=a.indexOf(e)}if(a=(a||"").trim()){a.indexOf("i")&&spa.is(e,"string")&&(e=e.toLowerCase());for(var n=0;n<this.length;n++){var r=this[n];switch(a.indexOf("i")&&spa.is(r,"string")&&(r=r.toLowerCase()),!0){case optionsHas("b"):case optionsHas("^"):t=optionsHas("~")?e.beginsWithStr(r):r.beginsWithStr(e);break;case optionsHas("e"):case optionsHas("$"):t=optionsHas("~")?e.endsWithStr(r):r.endsWithStr(e);break;case optionsHas("c"):case optionsHas("*"):t=optionsHas("~")?0<=e.indexOf(r):0<=r.indexOf(e);break;case optionsHas("<"):t=r<e;break;case optionsHas("<="):t=r<=e;break;case optionsHas(">"):t=e<r;break;case optionsHas(">="):t=e<=r;break;default:t=r==e}if(t)break}}else t=0<=this.indexOf(e);return t},enumerable:!1,configurable:!1}}),Object.defineProperties(Object.prototype,{__now:{value:function(){return JSON.parse(JSON.stringify(this))},enumerable:!1,configurable:!1},__clone:{value:function _obj_clone(){return JSON.parse(JSON.stringify(this))},enumerable:!1,configurable:!1},__keys:{value:function _obj_keys(e){return e?spa.keysDotted(this):Object.keys(this)},enumerable:!1,configurable:!1},__keysAll:{value:function _obj_keysAll(){return spa.keysDotted(this)},enumerable:!1,configurable:!1},__hasKey:{value:function _obj_hasKey(e){return spa.hasKey(this,e)},enumerable:!1,configurable:!1},__hasKeys:{value:function _obj_hasKeys(e){return _isObjHasKeys(this,e,!0)},enumerable:!1,configurable:!1},__hasPrimaryKeys:{value:function _obj_hasPrimaryKeys(e){return _isObjHasKeys(this,e)},enumerable:!1,configurable:!1},__valueOf:{value:function _obj_getValueOf(e,a){return spa.findSafe(this,e,a)},enumerable:!1,configurable:!1},__merge:{value:function _obj_merge(){return Array.prototype.unshift.call(arguments,this),_.merge.apply(void 0,arguments)},enumerable:!1,configurable:!1},__stringify:{value:function(){return JSON.stringify(this)},enumerable:!1,configurable:!1},__toQueryString:{value:function(){return spa.toQueryString(this)},enumerable:!1,configurable:!1},__extract:{value:function(){return Array.prototype.unshift.call(arguments,this),spa.extract.apply(this,arguments)},enumerable:!1,configurable:!1}}),$.ajaxSetup({converters:{"text javascript":function(e){"<"!=e[0]&&$.globalEval(e)}}}),$.cachedScript=function(e,a){return spa.console.log("Ajax for script:",e,"options:",a),!(e=_getFullPath4Component(e,a?a.spaComponent:"")).endsWithStrIgnoreCase(".js")&&e.indexOf("?")<0&&(e+=spa.defaults.components.scriptExt),(a=a||{}).hasOwnProperty("cache")||(a.cache=!0),a=$.extend(a,{dataType:"javascript",url:e}),spa.console.info("Loading Script('"+e+"') ..."),$.ajax(a)},$.cachedStyle=function(a,e,t){var n=$("#"+a,"head");return(t=t||{}).hasOwnProperty("cache")||(t.cache=!0),n.length||(t.cache=spa.defaults.components.offline),t=$.extend(t,{dataType:"text",url:e,success:function(e){n.remove(),$("head").append("<style id='"+a+"' type='text/css'>"+e+"</style>")}}),spa.console.info("Loading style('"+e+"') ... "),$.ajax(t)},spa.addScriptTag=function(e,a){if(e=e.replace(/#/,""),spa.console.group("spaAddScriptTag"),spa.isElementExist("#spaScriptsContainer")||(spa.console.info("#spaScriptsContainer NOT Found! Creating one..."),$("body").append("<div id='spaScriptsContainer' style='display:none' rel='Dynamic Scripts Container'></div>")),spa.isElementExist("#"+e))spa.console.info("script ["+e+"] already found in local.");else{spa.console.info("script ["+e+"] NOT found. Added script tag with src ["+a+"]");var t=a?"src='"+a+"'":"";$("#spaScriptsContainer").append("<script id='"+e+"' type='text/javascript' "+t+"><\/script>")}spa.console.groupEnd("spaAddScriptTag")},spa.addStyle=function(e,a){e=e.replace(/#/,""),spa.console.group("spaAddStyle"),spa.isElementExist("#spaStylesContainer")||(spa.console.info("#spaStylesContainer NOT Found! Creating one..."),$("body").append("<div id='spaStylesContainer' style='display:none' rel='Dynamic Styles Container'></div>")),spa.isElementExist("#"+e)?spa.console.info("style ["+e+"] already found in local."):(spa.console.info("style ["+e+"] NOT found. Added link tag with href ["+a+"]"),$("#spaStylesContainer").append("<link id='"+e+"' rel='stylesheet' type='text/css' href='"+a+"'/>")),spa.console.groupEnd("spaAddStyle")},spa.loadScript=function(t,n,e,a,r){return t=t.replace(/#/,""),e=e||!1,a=a||[],spa.console.group("spaScriptsLoad"),spa.isBlank(n)?spa.console.error("script path ["+n+"] for ["+t+"] NOT defined."):e?spa.addScriptTag(t,n):a.push($.cachedScript(n,r).done(function(e,a){spa.console.info("Loaded script ["+t+"] from ["+n+"]. STATUS: "+a)})),spa.console.groupEnd("spaScriptsLoad"),a},spa.getComponentsFullPath=function(e){return e=spa.strToArray(spa.toJSON(e)),_.map(e,function(e){return spa.defaults.components.rootPath+(spa.defaults.components.inFolder||/[^a-z0-9]/gi.test(e)?e:"")+"/"+_getComponentFileName(e)+spa.defaults.components.scriptExt})},spa.loadComponents=function(e,a,t){var n=_.filter(spa.strToArray(spa.toJSON(e)),function(e){return!spa.components.hasOwnProperty(e.replace(/[^a-z0-9]/gi,"_"))}),r=spa.getComponentsFullPath(n);spa.loadScripts(r,a,t)},spa.loadScripts=function(e,a,t){if(e=spa.strToArray(spa.toJSON(e)),!spa.isBlank(e)){var n=[];_.each(e,function(t){n.push($.cachedScript(t).done(function(e,a){spa.console.info("Loaded script from ["+t+"]. STATUS: "+a)}).fail(function(){spa.console.info("Failed Loading script from ["+t+"].")}))}),$.when.apply($,n).then(function(){spa.renderUtils.runCallbackFn(a)}).fail(function(){spa.renderUtils.runCallbackFn(t)})}},spa.loadScriptsSync=function(e,a,t){if(e=spa.strToArray(spa.toJSON(e)),spa.isBlank(e))spa.renderUtils.runCallbackFn(a);else{var n=!0,r=e.shift();r?(/^~/.test(r)&&(n=!1,r=r.substr(1)),spa.console.info("Load script from   ["+r+"], cache:",n),$.cachedScript(r,{cache:n}).done(function(){spa.console.info("Loaded script from ["+r+"]"),spa.loadScriptsSync(e,a,t)}).fail(function(){console.error("Failed Loading script from ["+r+"].",arguments),spa.renderUtils.runCallbackFn(t)})):spa.loadScriptsSync(e,a,t)}},spa.loadStyle=function(t,n,e,a){if(t=t.replace(/#/,""),e=!!e,a=a||[],spa.console.group("spaStylesLoad"),spa.isBlank(n))spa.console.error("style path ["+n+"] for ["+t+"] NOT defined.");else{var r=!e;e&&($("#"+t,"head").length?spa.console.info("Style('"+n+"') already loaded."):r=!0),r&&a.push($.cachedStyle(t,n,{cache:spa.defaults.components.offline}).done(function(e,a){spa.console.info("Loaded style ["+t+"] from ["+n+"]. STATUS: "+a)}))}return spa.console.groupEnd("spaStylesLoad"),a},spa.addTemplateScript=function(e,a,t){e=e.replace(/#/,""),t=t||"x-template",spa.isElementExist("#spaViewTemplateContainer")||(spa.console.info("#spaViewTemplateContainer NOT Found! Creating one..."),$("body").append("<div id='spaViewTemplateContainer' style='display:none' rel='Template Container'></div>")),spa.console.info("Adding <script id='"+e+"' type='text/"+t+"'>");var n="_BlockedScript_";a=a.replace(/<(\s)*script/gi,"<"+n+' src-ref="'+e+'"').replace(/<(\s)*(\/)(\s)*script/gi,"</"+n).replace(/<(\s)*link/gi,"<_LINKTAGINTEMPLATE_").replace(/<(\s)*(\/)(\s)*link/gi,"</_LINKTAGINTEMPLATE_"),$("#spaViewTemplateContainer").append("<script id='"+e+"' type='text/"+t+"'>"+a+"<\/script>")},spa.updateTemplateScript=function(e,a,t){e=e.replace(/#/,"");var n=$("#spaViewTemplateContainer").find("#"+e);n.length&&n.remove(),spa.addTemplateScript(e,a,t)},spa.loadTemplate=function(n,r,s,e,a,t,o){if(n=n.replace(/#/g,""),r=r.ifBlankStr("inline").trimStr(),s=s||"x-template",e=e||"#DummyInlineTemplateContainer",a=a||[],o=o||{},spa.console.group("spaTemplateAjaxQue"),spa.isElementExist("#"+n)){var i=$("#"+n);if(t)spa.console.warn("Reload Template["+n+"] of ["+s+"]"),i.remove(),a=spa.loadTemplate(n,r,s,e,a,t,o);else if(spa.isBlank(i.html())){spa.console.warn("Template["+n+"] of ["+s+"] script found EMPTY!");var p=""+i.attr("path");spa.isBlank(p)||(s=(i.attr("type")||"").ifBlankStr(s).toLowerCase().replace(/text\//gi,""),spa.console.info("prepare/remove to re-load Template["+n+"]  of ["+s+"] from external path: ["+p+"]"),i.remove(),a=spa.loadTemplate(n,p,s,e,a,t,o))}else spa.console.info("Template["+n+"]  of ["+s+"] already found in local.")}else if(spa.console.info("Template["+n+"] of ["+s+"] NOT found. Source ["+r+"]"),r&&"undefined"==r)spa.addTemplateScript(n,"",s),spa.console.info("Loaded Empty Template["+n+"] of ["+s+"]");else if(r.equalsIgnoreCase("inline")||r.beginsWithStr("#")){var l=r.equalsIgnoreCase("inline")?e:r,c=$(l),d=c.html();spa.isBlank(d)?spa.console.error("Template["+n+"] of ["+s+"] NOT defined inline in ["+l+"]."):(spa.addTemplateScript(n,d,s),r.equalsIgnoreCase("inline")&&c.html(""))}else if(r.equalsIgnoreCase("none"))spa.console.warn("Template["+n+"] of ["+s+"] defined as NONE. Ignoring template.");else if(r.equalsIgnoreCase("script"))spa.console.error("Template["+n+"] of ["+s+"] NOT defined in <script>.");else{var u=String(o.method||"get").toLowerCase();o.params&&(r=spa.api.url(r,o.params)),spa.console.warn(">>>>>>>>>> Making New Template Request");var f=$.ajax({url:r,method:u,headers:o.headers,data:o.payload,cache:spa.defaults.components.offline,dataType:"html",onTmplError:o.onError,success:function(e){spa.addTemplateScript(n,e,s),spa.console.info("Loaded Template["+n+"] of ["+s+"] from ["+r+"]")},error:function(e,a,t){this.onTmplError&&_is(this.onTmplError,"function")&&this.onTmplError.call(this,e,a,t),spa.console.error("Failed Loading Template["+n+"] of ["+s+"] from ["+r+"]. ["+a+":"+t+"]")}});a.push(f)}return spa.console.groupEnd("spaTemplateAjaxQue"),a},spa.urlParams=function(e){e=(e=e||window.location.search||"").beginsWithStr("\\?")||e.indexOf("//")<7?e.substr(e.indexOf("?")+1):e;var n={};return e.replace(/([^&=]+)=?([^&]*)(?:&+|$)/g,function(e,a,t){(n[a]=n[a]||[]).push(decodeURIComponent(t))}),_.each(n,function(e,a){n[a]=_.isArray(e)&&1==e.length?e[0]:e}),n},spa.urlParam=function(e,a){return spa.urlParams(a)[e]};var _winLocHash_="";function _getAboluteUrl(e,a){return(e||"").trimRightStr("/")+"/"+(a||"").trimLeftStr("/")}function _setLang(e,a,t){if(e){if(spa.i18n.onLangChange){var n=spa.i18n.onLangChange,r=spa.is(n,"function")?n.call(void 0,e,t):e;e=spa.is(r,"string")?r:e}$("html").attr("lang",e.replace("_","-")),spa.i18n.setLanguage(e,_.merge({},spa.defaults.lang,spa.findSafe(window,"app.conf.lang",{}),spa.findSafe(window,"app.lang",{}),a||{}))}}function _pipeSort(e,a){var t=e;if(spa.is(e,"array"))t=e.sort(),a&&(t=t.reverse());else if(spa.is(e,"string")){var n;switch(!0){case 0<=e.indexOf(","):n=",";break;case 0<=e.indexOf(" "):n=" "}n&&(t=e.split(n).sort().join(n),a&&(t=t.reverse()))}return t}function _defaultAttr(e){var a="html";switch(e.tagName.toUpperCase()){case"INPUT":switch(e.type.toLowerCase()){case"checkbox":case"radio":a="$";break;default:a="value"}break;case"TEXTAREA":a="value";break;case"SELECT":a="$"}return a}function _maskHandlebars(e){return e.replace(/<img /gi,"<IMG-X-TMP ").replace(/<iframe /gi,"<IFRAME-X-TMP ").replace(/<\/iframe/gi,"</IFRAME-X-TMP").replace(/{{/g,">\x3c!--_XHBTINSPA_{{").replace(/}}/g,"}} _XHBTINSPA_--\x3e")}function _unmaskHandlebars(e){return e.replace(/(\/)*&gt;/g,">").replace(/ _XHBTINSPA_--(>|&gt;)/gi,"").replace(/(>|&gt;)(<|&lt;)!--_XHBTINSPA_/gi,"").replace(/<IMG-X-TMP /gi,"<img ").replace(/<IFRAME-X-TMP /gi,"<iframe ").replace(/<\/IFRAME-X-TMP/gi,"</iframe")}spa.getLocHash=function(e){var a=(_winLocHash_||window.location.hash).replace("#","");return a||spa.is(e,"undefined")||"#"==e||(a=window.location.pathname.replace(/(\/)*(index|default)\.([a-z])*/i,"").replace(e.replace(/\s*/g,"").trimRightStr("/"),"")),a},spa.urlHash=function(e,a){var t=spa.getLocHash(a);if(e||_.isNumber(e)){var n=(t=t.beginsWithStr("/")?t.substring(t.indexOf("/")+"/".length):t).length?t.split("/"):[];_.isNumber(e)?t=e<0?n[n.length-1]:n&&n.length>e?n[e]:"":_.isArray(e)?t=0===e.length?n:_.zipObject(e,n):_.isString(e)&&"?"==e&&(t=t.containsStr("\\?")?spa.getOnSplit(t,"?",1):"")}return t},spa.urlHashFull=function(e){return _getAboluteUrl(e=e||"#",spa.urlHash("",e))},spa.hashParam=function(e){var a=""+spa.urlHash("?");return void 0===e||spa.isBlank(a)||(a=spa.urlParam(""+e,a)),a},spa.i18n={},spa.i18n.loaded=!1,spa.i18n.settings={name:"Language",path:"language/",ext:".txt",encoding:"UTF-8",cache:!0,async:!0,mode:"map",callback:null},spa.i18n.browserLang=function(){return navigator&&(navigator.language||navigator.userLanguage)||"en_US"},spa.i18n.setLanguage=function(e,a){$.i18n&&($.i18n.map={},e=(e||spa.i18n.browserLang()).replace(/-/g,"_"),a=$.extend(spa.i18n.settings,a),$.i18n.properties({name:a.name,language:e,path:a.path,ext:a.ext,encoding:a.encoding,cache:a.cache,async:a.async,mode:a.mode,callback:function(){spa.isElementExist("#i18nSpaRunTime")||$("body").append('<div id="i18nSpaRunTime" style="display:none"></div>'),$.i18n.loaded=void 0===$.i18n.loaded?!$.isEmptyObject($.i18n.map):$.i18n.loaded,spa.i18n.loaded=spa.i18n.loaded||$.i18n.loaded,1<e.length&&!$.i18n.loaded&&(spa.console.warn("Error Loading Language File ["+e+"]. Loading default."),spa.i18n.setLanguage("_",a)),spa.i18n.apply(),a.callback&&a.callback($.i18n.loaded)}}))},spa.i18n.setLang=function(e,a){_setLang(e,a)},spa.i18n.value=function(e){return(e=(""+e).replace(/i18n:/i,"").trim()).beginsWithStrIgnoreCase("@")&&(e=e.substr(1).trim(),e=spa.findSafe(window,e,e)),function _i18nValue(e){var a=e;try{(a=(""+(!spa.i18n.loaded&&window.Liferay?Liferay.Language.get(e):$.i18n.prop(e))).trim()).beginsWithStr("\\[")&&a.endsWithStr("]")&&(a=function _stripEnds(e){return e.substring(1,e.length-1)}(a))}catch(e){console.warn("i18n lookup error:"+e.stack)}return a}(e)},spa.strBindData=function(a,t,n,r){a=""+a,n=n||"{",r=r||"}";var e=spa.extractStrBetweenEx(a,n,r,!0);return a&&!spa.isBlank(e)&&spa.is(t,"object")&&_.each(e,function(e){a=a.replace(new RegExp(n+"\\s*("+e.trim()+")\\s*"+r,"g"),spa.findSafe(t,e,""))}),a},String.prototype.bindData=function(e){return spa.strBindData(""+this,e)},spa.i18n.text=function(e,a){var t=spa.i18n.value(e);if(a&&spa.is(a,"object")){var n="",r="";_.each(_.keys(a),function(e){n=""+a[e],r=n.trim(),n&&(r.beginsWithStrIgnoreCase("i18n:")||r.beginsWithStrIgnoreCase("@"))&&(n=spa.i18n.value(r)),t=t.replace(new RegExp("{\\s*("+e.trim()+")\\s*}","g"),n)})}var s,o=[e];return function parseMessage(a){var e=spa.extractStrBetweenEx(a,"{","}",!0);return spa.isBlank(e)?a:(_.each(e,function(e){(s=s||0<=o.indexOf(e))||(o.push(e),a=a.replace(new RegExp("{\\s*("+e.trim()+")\\s*}","g"),spa.i18n.value(e)))}),s?(console.error("i18nKey circular issue found:",o.join(" > ")),a):parseMessage(a))}(t)},spa.i18n.update=function(e,a,t){a=a||"";var n,r,s=$(e),o=s.attr("data-i18n")||"",i="";if(spa.isBlank(o)||0==a.indexOf(":")||0==a.indexOf("=")||o.indexOf(":")<=0&&a.indexOf(":")<=0)i=a.trimLeftStr(":").trimLeftStr("=");else{n=0<o.indexOf(":")?spa.toJSON(o||{}):{html:o.trimLeftStr(":").replace(/'/g,"")},r=0<a.indexOf(":")?spa.toJSON(a||{}):{html:a.trimLeftStr(":").replace(/'/g,"")},_.each(Object.keys(n),function(a){_.each(a.split("_"),function(e){e&&(n[e]=n[a])})}),_.each(Object.keys(r),function(a){_.each(a.split("_"),function(e){e&&(r[e]=r[a])})});var p=_.merge({},n,r);_.each(Object.keys(p),function(e){e.indexOf("_")<=0&&(i+=e+":'"+p[e]+"',")}),i=i.trimRightStr(",")}return s.attr("data-i18n",i).data("i18n",i),(t||spa.is(t,"undefined"))&&spa.i18n.apply(e),s},spa.i18n.apply=spa.i18n.render=function(e,a){if(spa.i18n.loaded||window.Liferay){a=a||"";var t=(e=e||"html").beginsWithStr("<");t&&($("#i18nSpaRunTime").html(e),e="#i18nSpaRunTime");var n=$(e).find(a+"[data-i18n]");n.length||(n=$(e).filter(a+"[data-i18n]")),n.each(function(e,a){var n=$(a),t=n.data("i18n")||"";t&&!t.containsStr(":")&&(t="html:'"+t+"'");var r=spa.toJSON(t||"{}"),s=r.data||r.i18ndata;s?(delete r.data,delete r.i18ndata):s=spa.toJSON(n.data("i18nData")||"{}"),r&&!$.isEmptyObject(r)&&_.each(_.keys(r),function(e){var a=r[e],t=spa.i18n.text(a,s);_.each(e.split("_"),function(e){switch(e.toLowerCase()){case"html":n.html(spa.sanitizeXSS(t));break;case"text":n.text(t);break;default:n.attr(e,t)}})})})}if(t)return $("#i18nSpaRunTime").html()},$.fn.extend({i18n:function(e){return this.each(function(){e&&$(this).attr("data-i18n",e).data("i18n",e),spa.i18n.apply(this)}),this}}),spa.pipes={trim:function(e){return(""+e).trim()},trimLeft:function(e){return(""+e).trimLeftStr()},trimRight:function(e){return(""+e).trimRightStr()},normalize:function(e){return(""+e).normalizeStr()},toLowerCase:function(e){return(""+e).toLowerCase()},toUpperCase:function(e){return(""+e).toUpperCase()},toTitleCase:function(e){return(""+e).toTitleCase()},capitalize:function(e){return(""+e).capitalize()},unCapitalize:function(e){return(""+e).unCapitalize()},not:function(e){return!e},sort:function(e){return _pipeSort(e)},sortAsc:function(e){return _pipeSort(e)},sortDesc:function(e){return _pipeSort(e,!0)},reverse:function(e){var a=e;if(spa.is(e,"array"))a=e.reverse();else if(spa.is(e,"string")){var t;switch(!0){case 0<=e.indexOf(","):t=",";break;case 0<=e.indexOf(" "):t=" "}t&&(a=e.split(t).reverse().join(t))}return a}},spa.dataBind=spa.bindData=function(e,a,t,n){e=e||"body",t=t||"";var r,s,o=spa.is(e,"string")&&/\s*</.test(e);if(o){s="_BlockedScriptInTemplate_";var i=e.replace(/<\s*script/gi,"<"+s).replace(/<\s*(\/)\s*script/gi,"</"+s);r=$('<div style="display:none">'+i+"</div>")}else r=$(e);if(spa.isBlank(a))return r;var p="";"$"==t[0]&&(p=t.substr(1).trim(),t="");var d,l,u,f,m,g,h,y,v,b,S=(p=p||r.attr("data-rendered-component"))||"_unknown_",O=_.merge({__computed__:{}},a),c=r.find(t+"[data-bind]");function _getValue(e){return"#"==(e=(e||"").trim())[0]?e:spa.findSafe(O,e)}function _templateDynId(e,a){return["_runTimeTemplate",e,p,a.replace(/[^a-z0-9]/gi,"_"),spa.now()].join("_")}function _inlineTemplate(e,a){return spa.compiledTemplates4DataBind.hasOwnProperty(S)||(spa.compiledTemplates4DataBind[S]={}),spa.compiledTemplates4DataBind[S][e]=Handlebars.compile(_unmaskHandlebars(a))}if(c.length||(c=r.filter(t+"[data-bind]")),c.length&&!o&&p&&(c=c.filter(function(){return $(this).closest("[data-rendered-component]").attr("data-rendered-component")==p})),_.each(c,function(c){d=$(c),(l=d.data("bind")||"")&&!l.containsStr(":")&&(l=_defaultAttr(c)+":'"+l+"'"),u=spa.toJSON(l||"{}"),v=spa.renderUtils.getFn(d.attr("data-bind-callback")||""),u&&!$.isEmptyObject(u)&&_.each(_.keys(u),function(e){f=(u[e]+"|").split("|"),m=f.shift().trim(),b="!"==m[0],h=b?!_getValue(m=m.substr(1).trim()):_getValue(m),spa.is(h,"undefined|null")&&(h="");for(var a=0;a<f.length;a++)(g=f[a].trim())&&("."==g[0]&&(g="spa.pipes"+g),h="!"==g[0]?"!"==g?!h:("."==(g=g.substr(1).trim())[0]&&(g="spa.pipes"+g),!spa.renderUtils.runCallbackFn(g,["(...)",h,m,O,c],c)):spa.renderUtils.runCallbackFn(g,["(...)",h,m,O,c],c));_.each(e.split("_"),function(e){var a="";if(e=e.trim(),!spa.is(h,"undefined"))switch(e.toLowerCase()){case"html":d.html(spa.sanitizeXSS(h));break;case"text":d.text(h);break;case"$":if(/checkbox|radio/i.test(c.type)){switch(spa.of(h)){case"boolean":c.checked=h;break;default:c.checked=c.value.equalsIgnoreCase(""+h)}c.checked?c.setAttribute("checked",""):c.removeAttribute("checked")}else/select/i.test(c.tagName)&&console.warn("TODO: data-bind:select");break;case"if":a=m.replace(/[^a-z0-9]/gi,"_"),O.__computed__[a]=h;var t,n=d.attr("data-bind-template");if(n)t=spa.compiledTemplates4DataBind[S][n];else{var r="{{#if __computed__."+a+" }}"+d.html().trim()+"{{/if}}";t=_inlineTemplate(n=_templateDynId("if",m),r),d.attr("data-bind-template",n)}d.html(t(O));break;case"repeat":a=m.replace(/[^a-z0-9]/gi,"_"),O.__computed__[a]=h;var s,o=d.attr("data-bind-template");if(o)s=spa.compiledTemplates4DataBind[S][o];else{var i=(u.repeatAs||"").replace(/[,|:]/g," ").normalizeStr(),p="{{#each __computed__."+a+(i?" as |"+i+"|":"")+" }}"+d.html().trim()+"{{/each}}";s=_inlineTemplate(o=_templateDynId("repeat",m),p),d.attr("data-bind-template",o)}d.html(s(O));break;case"repeatAs":break;default:switch(!0){case/^\./.test(e):var l=e.replace(/[\.\,]/g," ").normalizeStr();d[h?"addClass":"removeClass"](l);break;default:d.attr(e,h),e.beginsWithStr("data-")&&(y=spa.dotToCamelCase(e.getRightStr("-").replace(/-/g,".")))&&d.data(y,h)}}}),v&&v.call(c,c)})}),!n&&!o&&r.is("[data-rendered-component]")){var C=r.attr("data-rendered-component");if(!spa.isBlank(C)){var T="app."+C+".bindCallback";spa.renderUtils.runCallbackFn(T,O,app[C])}}if(!o){var w,k=r.find("[data-rendered-component]").filter(function(){return this.hasAttribute("data-spa-component-$data")||this.hasAttribute("data-spa-$data")||this.hasAttribute("spa-$data")});if(k.length)k.each(function(){w=_get$dataInAttr(this,p,a),spa.bindData(this,w)})}return O=null,o?r.html().replace(new RegExp(s,"g"),"script"):r},spa.togglePassword=function(e){if(!$(e).next(".icon.eye").length){var a=$('<i class="icon eye"></i>');a.on("click",function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation();var a=$(this).prevAll(".toggle-password"),t="text"==a.attr("type")?"password":"text";a.attr("type",t).toggleClass("text")}),$(a).insertAfter(e)}},spa.initTogglePassword=function(e){$(e||"body").find(".toggle-password").each(function(e,a){spa.console.info("Initializing toggle password",a),spa.togglePassword(a)})},spa.isElValueChanged=function(e){var t,a,n=$(e);if(n.length)if("checkbox"==(a=n[0]).type)t=a.checked!=a.defaultChecked;else if("radio"==a.type)$(a).closest("form").find(':radio[name="'+a.name+'"]').each(function(e,a){t=t||a.checked!=a.defaultChecked});else if(0<="INPUT,TEXTAREA".indexOf(a.tagName))t=a.value!=a.defaultValue;else if("SELECT"==a.tagName){var r,s,o,i=0;for(r=0,s=a.options.length;r<s;r++)o=a.options[r],t=t||o.selected!=o.defaultSelected,o.defaultSelected&&(i=r);t&&!a.multiple&&(t=i!=a.selectedIndex)}return t},spa.resetElDefaultValue=function(e){var a,t=$(e);if(t.length)if(a=t[0],0<",checkbox,radio".indexOf(a.type))a.defaultChecked=a.checked;else if(0<",INPUT,TEXTAREA".indexOf(a.tagName))a.defaultValue=a.value;else if("SELECT"==a.tagName){var n,r,s;for(n=0,r=a.options.length;n<r;n++)(s=a.options[n]).defaultSelected=s.selected}},spa.updateTrackFormCtrls=function(e){if(e){var t,n,r,s,a=$(e),o=a.find(".tracking-change.changed").length,i=spa.validateForm("#"+a.attr("id")),p=!(spa.isBlank(i)||1==i[0].errcode)||a.find(".validation-error,.validation-pending").length,l=0<o&&!p,c=!p,d=a.find(".ctrl-on-change,.ctrl-on-validate");a.attr("data-changed",o).data("changed",o),d.each(function(e,a){t=$(a),n=t.hasClass("ctrl-on-change")?l:c,r=t.attr("onBeforeChange"),spa.isBlank(r)||(0<r.indexOf("(")&&(r=r.getLeftStr("(")),s=spa.findSafe(window,r.trim(),void 0),n=spa.is(s,"function")?!!s.call(a,n):n),t.is(":disabled")==n&&(t.prop("disabled",!n).addClass(n?"":"disabled").removeClass(n?"disabled":""),t.trigger("change"))})}},spa.trackFormElChange=function _trackFormElChange(e,a){function eTrackChange(e){if("change"==e.type||e.key&&(1==e.key.length||0<="BackspaceDelete".indexOf(e.key))){var a,t=!1,n=$(this).closest("form"),r=n.find(".tracking-change.changed").length;if("checkbox"==this.type)t=this.checked!=this.defaultChecked;else if("radio"==this.type)n.find(':radio[name="'+this.name+'"]').each(function(e,a){a.checked==a.defaultChecked&&$(a).removeClass("changed"),t=t||a.checked!=a.defaultChecked});else if(0<="INPUT,TEXTAREA".indexOf(this.tagName))t=this.value!=this.defaultValue,a="change"!=e.type;else if("SELECT"==this.tagName){var s,o,i,p=0;for(s=0,o=this.options.length;s<o;s++)i=this.options[s],t=t||i.selected!=i.defaultSelected,i.defaultSelected&&(p=s);t&&!this.multiple&&(t=p!=this.selectedIndex)}$(this)[t?"addClass":"removeClass"]("changed"),spa.updateTrackFormCtrls(n),null!=r&&a&&n.trigger("change")}}$(a||"body").find(e).each(function(e,a){"FORM"==a.tagName.toUpperCase()?spa.trackFormElChange($(a).find(".track-change").length?".track-change":"input,textarea,select",a):function elTrackChange(e){var a="change",t=$(e);if(0<",checkbox,radio".indexOf(e.type))e.defaultChecked=e.checked;else if(0<",INPUT,TEXTAREA".indexOf(e.tagName))e.defaultValue=e.value,a="keyup change";else{if("SELECT"!=e.tagName)return!1;var n,r,s;for(n=0,r=e.options.length;n<r;n++)(s=e.options[n]).defaultSelected=s.selected}t.removeClass("track-change changed"),spa.updateTrackFormCtrls(t.closest("form")),e.className.indexOf("tracking-change")<0&&t.addClass("tracking-change").on(a,eTrackChange);return!0}(a)})},spa.initTrackFormElChanges=function(e){$(e||"body").find("form.track-changes,form:has(.ctrl-on-change,.track-change)").each(function(e,a){spa.console.info("Initializing Form Elements Track: Form ["+(a.id||a.name)+"]"),spa.trackFormElChange(a)})},spa.getModifiedElement=function(e){var a,t=void 0,n=$(e||"form:not([data-ignore-change]) :input:not(:disabled,:button,[data-ignore-change])");return _.every(n,function(e){return a||(e.tagName.match(/^(select|textarea)$/i)&&e.value!=e.defaultValue?a=!0:e.tagName.match(/^input$/i)&&(e.type.match(/^(checkbox|radio)$/i)&&e.checked!=e.defaultChecked?a=!0:e.type.match(/^(text|password|hidden|color|email|month|number|tel|time|url|range|date|datetime|datetime-local)$/i)&&e.value!=e.defaultValue&&(a=!0)),a&&(t=e)),!a}),t},spa.getModifiedElements=function(e){var t,n=[];return $(e||"form:not([data-ignore-change]) :input:not(:disabled,:button,[data-ignore-change])").each(function(e,a){t=!1,a.tagName.match(/^(select|textarea)$/i)&&a.value!=a.defaultValue?t=!0:a.tagName.match(/^input$/i)&&(a.type.match(/^(checkbox|radio)$/i)&&a.checked!=a.defaultChecked?t=!0:a.type.match(/^(text|password|hidden|color|email|month|number|tel|time|url|range|date|datetime|datetime-local)$/i)&&a.value!=a.defaultValue&&(t=!0)),t&&n.push(a)}),n},spa.initTrackElValueChanges=spa.resetElementsDefaultValue=function(e){$(e||"form :input:not(:disabled)").each(function(e,a){a.defaultValue=a.value,a.tagName.match(/^input$/i)&&a.type.match(/^(checkbox|radio)$/i)&&a.checked!=a.defaultChecked&&(a.defaultChecked=a.checked)})},spa.trash={container:[],push:function(e){this.container.push(e)},empty:function(){this.container=[]},pick:function(e){return e?this.container[e]:this.container}},spa.fillData=function(l,c,e){var a="object"==typeof l;c&&"object"==typeof c&&(e=c,c=null),c=c||"body";var d={dataParams:{},method:"GET",async:!0,dataCache:!1,keyFormat:"aBc",selectPattern:"[name='?']",formatterCommon:null,formatterOnKeys:null,resetElDefault:!0,resetElDefaultInContext:!0,keysMap:{}};$.extend(d,e),a||$.ajax({url:l,method:(""+(d.method||"GET")).toUpperCase(),data:d.dataParams,cache:d.dataCache,async:d.async,dataType:"text",success:function(e){l=spa.toJSON(""+e),a="object"==typeof l,function _fillData(){var p=d.keyFormat;p=null!=(p=null!=p.match(/^[a-z]/)?"aBc":p).match(/^[A-Z]/)?"AbC":p;var e=spa.keysDotted(l);spa.console.group("fillData"),spa.console.info(e),_.each(e,function(e){spa.console.group(">>"+e);var a=""+(e.replace(/[\[\]]/g,"_")||""),t=e.replace(/\[[0-9]+\]/g,""),n=/\[[0-9]+\]/.test(e);switch(p){case"_":a=spa.dotToX(a,"_"),t=spa.dotToX(t,"_");break;case"AbC":a=spa.dotToTitleCase(a),t=spa.dotToTitleCase(t);break;default:a=spa.dotToCamelCase(a),t=spa.dotToCamelCase(t)}var r={patternKey:a+(n?" || "+t:""),formatterKey:t,isArrayChild:n};spa.trash.push(r),spa.console.info(r),spa.trash.empty();var s=d.selectPattern.replace(/\?/g,a);(d.keysMap[a]||d.keysMap[t])&&(d.keysMap[a]=d.keysMap[a]||{},d.keysMap[t]=d.keysMap[t]||{},d.keysMap[a].pattern=d.keysMap[a].pattern||d.keysMap[t].pattern,d.keysMap[a].pattern&&(s=d.keysMap[a].pattern.replace(/\?/g,a)),d.keysMap[t].formatter&&(d.formatterOnKeys=d.formatterOnKeys||{},d.formatterOnKeys[t]=d.keysMap[t].formatter));var o=$(c).find(s).length;spa.console.info(">> "+s+" found: "+o);var i=null;0<o&&(i=spa.find(l,e),!d.formatterOnKeys&&d.formatterCommon&&(i=d.formatterCommon(i,e,l)),d.formatterOnKeys&&(d.formatterOnKeys[t]?i=d.formatterOnKeys[t](i,e,l):d.formatterCommon&&(i=d.formatterCommon(i,e,l))),spa.console.info({value:i})),$(c).find(s).each(function(e,a){switch(spa.console.info(a),a.tagName.toUpperCase()){case"INPUT":switch(a.type.toLowerCase()){case"text":case"password":case"hidden":case"color":case"date":case"datetime":case"datetime-local":case"email":case"month":case"number":case"search":case"tel":case"time":case"url":case"range":case"button":case"submit":case"reset":$(a).val(i),!d.resetElDefaultInContext&&d.resetElDefault&&(a.defaultValue=a.value);break;case"checkbox":case"radio":a.checked=a.value.equalsIgnoreCase(i),!d.resetElDefaultInContext&&d.resetElDefault&&(a.defaultChecked=a.checked)}break;case"SELECT":spa.selectOptionForValue(a,i),!d.resetElDefaultInContext&&d.resetElDefault&&(a.defaultValue=a.value);break;case"TEXTAREA":$(a).val(i),!d.resetElDefaultInContext&&d.resetElDefault&&(a.defaultValue=a.value);break;default:$(a).html(spa.sanitizeXSS(i))}}),spa.console.groupEnd(">>"+e)}),spa.console.groupEnd("fillData"),d.resetElDefaultInContext&&spa.resetElementsDefaultValue(c+" :input")}()},error:function(e,a,t){spa.console.error("Failed loading data from ["+l+"]. ["+a+":"+t+"]"),spa.is(app.api.onError,"function")?app.api.onError.call(this,e,a,t):spa.api.onReqError.call(this,e,a,t)}})},spa.toRenderDataStructure=function(a,e,t){function jE(a,t){return t&&Object.keys(t).length&&_.each(Object.keys(t),function(e){a=a.replace(new RegExp("{"+e+"}","gi"),t[e])}),a}var n={},r={},s={},o={};switch(e&&(o=_.isString(e)?spa.queryStringToJson(e):_.isObject(e)?e:{}),!0){case _.isString(a):a.containsStr("\\|")&&(n.dataModel=spa.getOnSplit(a,"|",0),a=spa.getOnLastSplit(1)),n.dataUrl=jE(a,t),_.isEmpty(o)||(n.dataParams=o);break;case _.isArray(a):r={urls:[]},s={},_.each(a,function(e){s={url:jE(e,t),params:o},e.containsStr("\\|")&&(s.target=spa.getOnSplit(e,"|",0),s.url=jE(spa.getOnLastSplit(1),t)),r.urls.push(s)});break;case _.isObject(a):r={urls:[]},s={},_.each(_.keys(a),function(e){s={name:e,url:jE(a[e],t),params:o},a[e].containsStr("\\|")&&(s.target=spa.getOnSplit(a[e],"|",0),s.url=jE(spa.getOnLastSplit(1),t)),r.urls.push(s)})}return _.isEmpty(r.urls)||(n.dataCollection=r),n};var _$dataWatchList={};function _adjustComponentOptions(e,a){var t="_rtt_"+e,n="";if(a&&_.isObject(a)&&spa.hasPrimaryKeys(a,"template|templateStr|templateString|templateUrl")){if(a.hasOwnProperty("template")){var r=a.template.trim();r.beginsWithStr("#")&&!r.containsStr(" ")||(a.templateStr=a.template)}if(spa.hasPrimaryKeys(a,"templateStr|templateString"))n=a.templateStr||a.templateString||"",spa.updateTemplateScript(t,n),a.template="#"+t;else if(spa.hasPrimaryKeys(a,"templateUrl")){var s=(a.templateUrl||"").trim();if(s&&/^(\.\/)/.test(s)){var o=/[^a-z0-9]/gi.test(e);s=spa.defaults.components.rootPath+(spa.defaults.components.inFolder||o?e.replace(/[^a-z0-9]/gi,"/")+"/":"")+s.substr(2)}a.template=s}}return a&&_.isObject(a)&&!spa.hasPrimaryKeys(a,"data|dataUrl")&&spa.hasPrimaryKeys(spa.api.urls,"$"+e)&&(a.dataUrl="@$"+e),spa.console.log("$ Adj.Options>>>>",e,a?a.__now():a),a}spa.env="",spa.compiledTemplates4DataBind={},spa.compiledTemplates={},spa.viewModels={},spa.renderHistory={},spa.renderHistoryMax=0,spa.components={},spa.tempBind$data={},spa.defaults={components:{templateEngine:"handlebars",rootPath:"app/components/",inFolder:!0,templateExt:".html",scriptExt:".js",templateScript:!1,templateCache:!0,dataPreRequest:"",render:"",callback:"",extend$data:!0,offline:!1},routes:{base:"#",attr:{route:"data-spa-route",params:"data-spa-route-params",onNavAway:"onNavAway"},className:{hide:"HIDE-SPA-NAV",block:"BLOCK-SPA-NAV",allow:"ALLOW-SPA-NAV"}},lang:{path:"app/language/",ext:".txt",cache:!0,async:!0},validation:{xss:{on:"input_onBlur",fn:"_check.xss",msg:"i18n:invalid.input"}},set:function(e,a){return spa.is(e,"object")?(e.hasOwnProperty("set")&&delete e.set,_.merge(this,e)):"string"==typeof e&&("components.extend$data"==e?spa.defaults.components.extend$data=a:spa.setSimpleObjProperty(this,e,a)),this}};var reservedCompNames="api,debug,lang";function _$renderCountUpdate(e){e=String(e).replace(/[^a-z0-9]/gi,"_"),app[e]&&(app[e].__renderCount__=spa.toInt(spa.$renderCount(e))+1)}function _spaComponentOp(){var a=this.action;if(arguments.length){var e=arguments;1==arguments.length&&(_.isArray(arguments[0])?e=arguments[0]:_.isString(arguments[0])&&(e=arguments[0].split(","))),spa.console.log(e),e&&e.length&&_.each(e,function(e){spa.console.info(a+" spa-component:["+e.trim()+"]"),spa[a](e.trim())})}}function _spaRenderRefreshComponents(){var a=this.action;if(arguments.length){var t=arguments;1==arguments.length&&(t=_.isArray(arguments[0])?arguments[0]:_.isString(arguments[0])?arguments[0].split(","):arguments[0]),spa.is(t,"object")?_.each(Object.keys(t),function(e){spa.console.info("Rendering spa-component:["+e+"]"),spa[a](e,t[e])}):t&&t.length&&_.each(t,function(e){spa.console.info("Rendering spa-component:["+e+"]"),spa[a](e.trim())})}}function _get$dataInAttr(e,a,t){var n,r,s,o,i="app."+(a=a.replace(/[^a-z0-9]/gi,"_"))+".";spa.is(t,"object")&&(spa.tempBind$data.hasOwnProperty(a)||(spa.tempBind$data[a]={}),spa.tempBind$data[a].$data=_.merge({},spa.findSafe(app,a+".$data",{}),t),i="spa.tempBind$data."+a+"."),r=(n=$(e)).data(),(s=((n.attr("data-spa-component")||"").split("|")[1]||"").trim())&&(/\:\s*\$data/.test(s)&&(s=s.replace(/\:\s*\$data/g,":"+i+"$data")),s=spa.toJSON(s));var p=n.attr("data-spa-component-options")||n.attr("data-spa-$options")||n.attr("spa-$options")||"{}";if((o=_.merge({},s,r,spa.toJSON(p))).hasOwnProperty("data")&&spa.is(o.data,"string")){var l=o.data.trim();/^\$data/.test(l)&&(l=i+l),o.data=_.merge({},spa.findSafe(window,l,{}))}var c=(n.attr("data-spa-component-$data")||n.attr("data-spa-$data")||n.attr("spa-$data")||"").trim();if(c&&(/\:\s*\$data/.test(c)&&(c=c.replace(/\:\s*\$data/g,":"+i+"$data")),spa.isBlank(o.data)?o.data=spa.toJSON(c):_.merge(o.data,spa.toJSON(c))),!spa.isBlank(o.data)&&o.data.hasOwnProperty("$data")){var d=_.merge({},o.data.$data);delete o.data.$data,_.merge(o.data,d)}return o.hasOwnProperty("data")?o.data:{}}function _appApiDefaultPayload(){var e=spa.findSafe(app,"api.ajaxOptions.defaultPayload",{});return spa.is(e,"function")?e():spa.is(e,"object")?_.merge({},e):e}function _disabledElClick(e){var $el=$(this);if($el.hasClass("disabled")||$el.is("[disabled]")||$el.is(":disabled"))return e.preventDefault(),e.stopPropagation(),void e.stopImmediatePropagation();eval($el.attr("onclicknative"))}function _initSpaElements(e){var a=$(e||"body"),t=a.find("form:not([onsubmit])"),n=_routeByHref?".no-spa-route":"",r=a.find('a[href]:not([href^="#"]):not([href^="javascript:"]):not([target])'+n),s=a.find("a:not([href])"),o=a.find("[onclick]:not(:input):not(["+_attrSpaRoute+"]):not([onclicknative])");t.filter(function(){return!$(this).closest("pre").length}).attr("onsubmit","return false;").addClass("spa-form"),r.filter(function(){return!$(this).closest("pre").length}).attr("target","_blank").addClass("spa-external-link"),s.filter(function(){return!$(this).closest("pre").length}).attr("href","javascript:;").addClass("spa-link"),o.filter(function(){return!$(this).closest("pre").length}).addClass("as-btn").renameAttr("onclick","onclicknative").on("click",_disabledElClick)}function _initFormValidation(e){var a,t,n,r=$(e),s=spa.findSafe(spa,"_validate.defaults.offline",!0);if(1==r.length){if((a=r.attr("id")||"")||(a=r.attr("name")||"spaForm"+spa.now(),r.attr("id",a)),t=r.data(),n=r.has(".ctrl-on-change,.ctrl-on-validate").length,s){var o=(r.attr("data-validate-defaults")||"").trim();if(o){if(o.indexOf("offline")<0)if(o.endsWithStr("}")){var i=o.lastIndexOf("}");o=[o.slice(0,i),",offline:true",o.slice(i)].join("")}else o+=",offline:true";r.attr("data-validate-defaults",o)}else r.attr("data-validate-defaults","{offline:true}")}r.is("[data-validate-form]")||r.attr("data-validate-form",""),r.attr("data-validation-initialized",""),r.attr("onsubmit")||r.attr("onsubmit","return false;"),r.on("change",function(){spa.updateTrackFormCtrls(this)}),r.find("textarea,input:not(:checkbox),input:not(:radio)").filter(":not([data-validate])").each(function(){this.setAttribute("data-validate","{onInput:{fn:_check.noop}}")});var p="",l=spa.defaults.validation.xss,c=(r.attr("data-validate-xss")||"").trim(),d=(l.msg||"").trim();/msg\s*:/g.test(c)&&((d=spa.toJSON(c).msg)?c="on":d="Invalid input."),d&&!(c.equalsIgnoreCase("off")||c.equalsIgnoreCase("no")||c.equalsIgnoreCase("skip")||c.equalsIgnoreCase("false"))&&(p=4<c.length?","+c:",on"+l.on.capitalize()+":{fn:'"+l.fn+"',msg:'"+d+"'}");var u,f="onFocus:{fn:_clearSpaValidateMsg,offline:false}"+p,m=(r.attr("data-validate-common")||"").trim();if(m){if(m.indexOf("_clearSpaValidateMsg")<0)u="{"==m[0]?(m[0]=",","{"+f+m):"{"+f+","+m+"}",r.attr("data-validate-common",u)}else r.attr("data-validate-common","{"+f+"}");spa.initDataValidation("#"+((t.validateForm||t.validateScope||"").replace(/[#onRender]/gi,"")||a)),!r.hasClass("track-changes")&&n&&spa.trackFormElChange(e),"onRender".equalsIgnoreCase(t.validateForm)&&spa.validateForm("#"+a,!0,!0)}}function _initFormValidationInScope(e){spa.hasOwnProperty("initDataValidation")?$(e||"body").find("[data-validate-form],[data-validate-scope],form:has([data-validate])").filter(":not([data-validation-initialized])").each(function(e,a){_initFormValidation(a)}):console.warn("SPA validation module is not loaded.")}function __renderView(e,a){var t=spa.setElIdIfNot(e);return a&&!$.isEmptyObject(a)?spa.render("#"+t,a):spa.render("#"+t)}function init_i18n_Lang(){$(document).on("click","[data-i18n-lang]",function(){var e=$(this).data(),t=e.i18nLang||"",n=(e.i18nLang||"").replace("-","_"),r=($("body").attr("i18n-lang-key-prefix")||"lang.name.")+n;_setLang(n,{callback:function(){var e="-",a=$("[data-i18n-lang]:first");a.length&&(e=(a.data("i18nLang")||"").replace(/[a-z]/gi,"")),$(".lang-text").attr("data-i18n",r).data("i18n",r),$(".lang-icon").removeClass(Array.prototype.join.call($("[data-i18n-lang]").map(function(e,a){return $(a).data("i18nLang")})," ")).addClass("_"==e?n:t),$("[data-i18n-lang]").removeClass("active"),$('[data-i18n-lang="'+t+'"],[data-i18n-lang="'+n+'"]').addClass("active"),spa.i18n.apply(".lang-text")}})});var e=($("body").attr("i18n-lang")||"").replace(/ /g,""),a=e.split(",")[0];if(e){if("*"==a&&(a=spa.i18n.browserLang(),(","+e.toLowerCase()+",").indexOf(","+a.toLowerCase()+",")<0)){a=a.getLeftStr(2).toLowerCase();for(var t=e.split(","),n="",r="",s=0;s<t.length;s++)if(0==(n=(t[s]||"").trim()).toLowerCase().indexOf(a)){r=n;break}a=r||(e.split(",")[1]||"")}a&&(_setLang(a,{},!0),setTimeout(function(){spa.i18n.displayLang()},500))}}function _isLiveApiUrl(e,a){var t="",n=a||spa.findSafe(window,"app.api.liveApiPrefix","");if(n){var r,s,o=[],i=0;if(spa.is(n,"string")?o=n.split(","):spa.is(n,"array")&&(o=n),0<(r=o.length))for(;!t&&i<r;)t=(s=o[i++].trim())?e.beginsWithStr(s)?s:!_isRelativePath(e)&&0<e.indexOf(s)?s:"":"";else t=e.beginsWithStr(n)?n:!_isRelativePath(e)&&0<e.indexOf(n)?n:""}return t}function _ajaxSetReqHeaders(a,e){var t=spa.findSafe(window,"app.api.reqHeaders"),n=is(t,"function")?t(a,e):t;is(n,"object")?_.forEach(Object.keys(n),function(e){a.setRequestHeader(e,n[e])}):is(n,"string")&&(_isLiveApiUrl(e.url)?(e.data=e.data||"",e.data+=(spa.isBlank(e.data)?"":"&")+n):a.setRequestHeader("reqHeadersInLiveUrl",n))}function _isRelativePath(e){var a=e.getLeftStr(6).toLowerCase();return!(a.beginsWithStr("http:")||a.beginsWithStr("https:")||a.beginsWithStr("//"))}function _isFn(){return"function"==typeof arguments[0]}function _isObj(){return"object"==typeof arguments[0]}function _ajax(a){var t={url:"",responseType:"json",async:!0,cache:!1,method:"GET",headers:{},auth:null,timeout:0,success:null,error:null,finally:null},n=t.responseType.toUpperCase(),e={TEXT:"text/plain",HTML:"text/html",CSS:"text/css",CSV:"text/csv",XML:"text/xml",JSON:"application/json",PDF:"application/pdf",ZIP:"application/zip"}[n]||t.responseType,r={};Object.keys(a||{}).forEach(function(e){t[e]=a[e]}),t.method=t.method.toUpperCase(),_isFn(t.headers)&&(t.headers=t.headers.call(void 0,t)),_isObj(t.headers)&&Object.keys(t.headers).forEach(function(e){r[e]=t.headers[e]}),e&&(r["Content-Type"]=e),r["Cache-Control"]=t.cache?"max-age=86400000":"no-cache, no-store, must-revalidate, max-age=0",r.Expires=t.cache?new Date((new Date).setDate((new Date).getDate()+1)).toUTCString():"0",t.cache||(r.Pragma="no-cache");var s,o,i=new XMLHttpRequest;(i.requestOptions=t).timeout&&(i.timeout=t.timeout),Object.keys(t).forEach(function(a){var e=a.toLowerCase();"onreadystatechange"===e&&_isFn(t[a])?o=t[a]:0===e.indexOf("on")&&_isFn(t[a])&&(i[e]=function(e){t[a].call(t,i,e)})}),i.onreadystatechange=function(e){if(o&&o.call(t,i,e),4===i.readyState){var a=i.responseText;if(200<=i.status&&i.status<300){if("JSON"===n)try{a=a&&JSON.parse(a)}catch(e){a=i.responseText,console.warn("Invalid JSON response.",a,i,e)}_isFn(t.success)&&t.success.call(t,a,i.status,i)}else _isFn(t.error)&&t.error.call(t,i.status,i.statusText,i);_isFn(t.finally)&&t.finally.call(t,a,i.status,i)}},t.hasOwnProperty("data")&&"GET"===t.method&&(s=_isObj(t.data)?_toQueryString(t.data):""+t.data)&&(t.url+=(t.url.indexOf("?")<0?"?":/\?$|\&$/.test(t.url)?"":"&")+s);try{t.auth&&_isObj(t.auth)?t.auth.hasOwnProperty("user")&&(t.auth.hasOwnProperty("pwd")?i.open(t.method,t.url,t.async,t.auth.user,t.auth.pwd):i.open(t.method,t.url,t.async,t.auth.user)):i.open(t.method,t.url,t.async),Object.keys(r).forEach(function(e){i.setRequestHeader(e,r[e])}),"GET"!==t.method&&t.hasOwnProperty("data")?(s=_isObj(t.data)?JSON.stringify(t.data):t.data,i.send(s)):i.send()}catch(e){console.warn("Ajax-Exception",i,e)}return i}function _mockSysTest(){app.api&&_ajax({url:_mockFinalUrl(),method:"HEAD",error:function(){var e=(spa.findSafe(app,"api.mockBaseUrl")||spa.findSafe(spa,"api.mockBaseUrl")||location.origin).trimRightStr("/")+"/",a=(spa.findSafe(app,"api.mockRootFolder")||spa.findSafe(spa,"api.mockRootFolder")||"api_").trimRightStr("/"),t=prompt("Enter Mock Root Address: http[s]://server.address[:port]/root-folder",e+a);if(t){var n=t.indexOf("/",8),r=0<n?t.slice(0,n):t,s=0<n?t.substr(n+1):"";app.api.mockBaseUrl=r==location.origin?"":r,app.api.mockRootFolder=s,_mockSysTest()}}})}function _mockFinalUrl(e,a,t){e=e||"/",a=a||"",t=t||_isLiveApiUrl(e);var n="",r=spa.findSafe(app,"api.mockBaseUrl")||spa.findSafe(spa,"api.mockBaseUrl")||"",s=(spa.findSafe(app,"api.mockRootFolder")||spa.findSafe(spa,"api.mockRootFolder")||"api_").trimRightStr("/")+"/";n=(e||"").replace(/[\{\}]/g,"").replace(RegExp("(.*)(/*)"+t.trimLeftStr("/")),s).replace(/(\/)*\?/,a+"/data.json?").replace(/\?$/,"");if(r){r=r.trimRightStr("/")+"/";var o=n.indexOf("//");o<0?n=r+n:o<7&&(n=r+n.substr(n.indexOf("/",n.indexOf("//")+2)+1))}return n}function _ajaxPrefilter(a,e,t){a.url.beginsWithStr(spa.api.urlKeyIndicator)&&(a.url=spa.api.url(a.url.trimLeftStr(spa.api.urlKeyIndicator),a.data));var n,r=a.url;spa.findSafe(window,"app.api.reqHeaders")&&(a.beforeSend=function(e){_ajaxSetReqHeaders(e,a)}),"script"==a.dataType||a.hasOwnProperty("error")||(a.error=app.api.onError||spa.api.onReqError);var s,o="",i=/({+)([^}])*(}+)/;if(spa.api.mock||app.api.mock||r.beginsWithStr("!"))if(r.beginsWithStr("~"))a.url=(_isRelativePath(r.trimLeftStr("~"))&&spa.api.baseUrl||"")+r.trimLeftStr("~")+(spa.api.liveUrlSuffix||""),spa.api.baseUrl&&(a.crossDomain=!0);else{var p=("/"+a.type.toUpperCase()).replace("/GET","");if(a.type="GET",o=_isLiveApiUrl(r=r.trimLeftStr("!"))){if(r.containsStr("\\?")||(r=r.trimRightStr("/")+"?"),i.test(r)){spa.console.log("URL has undefined params >>",r,a.data);try{s=spa.is(a.data,"string")?JSON.parse(a.data):a.data,r=spa.api.url(r.replace(/{{/g,"{").replace(/}}/g,"}"),s)}catch(e){}spa.console.log("Updated URL>>",r)}var l=_mockFinalUrl(r,p,o);a.url=l,(app.debug||spa.debug)&&console.warn(">>>>>>Intercepting Live API URL: ["+r+"] ==> ["+l+"]"),n=!0}}else o=_isLiveApiUrl(r),(app.debug||spa.debug)&&console.log("actualUrl:"+r+",baseUrl:"+spa.api.baseUrl+",liveApiPrefix:"+o),o&&(a.url=(_isRelativePath(r)&&spa.api.baseUrl||"")+r+(spa.api.liveUrlSuffix||""),spa.api.baseUrl&&(a.crossDomain=!0));if(spa.console.log("Remove mock params if any in URL>",a.url),a.url=a.url.replace(/{{([^}])*}}(\/*)/g,""),i.test(a.url)){spa.console.log("URL has undefined params>",a.url,a.data);try{s=spa.is(a.data,"string")?JSON.parse(a.data):a.data,a.url=spa.api.url(a.url.replace(/{</g,"{").replace(/>}/g,"}"),s)}catch(e){}}spa.console.log("Final Ajax URL>",a.url),(i.test(a.url)||/<([^>])*>/.test(a.url))&&(console.warn("URL has undefined params >>",a.url,a.data),a.url=a.url.replace(/[{<>}]/g,"_"));var c=app.api.defaultPayload||spa.api.defaultPayload;if(c){var d,u,f=spa.of(a.data),m="string"==f?spa.toJSON(a.data):a.data;spa.is(c,"function")?(d=c.call(a,m,a),spa.is(d,"object")&&(u=JSON.parse(JSON.stringify(d)),spa.isBlank(u)||(a.data="string"==f?JSON.stringify(u):u))):(u=spa.is(c,"object|array")?JSON.parse(JSON.stringify(c)):c,u=spa.is(u,"object|array")&&spa.is(m,"object|array")?_.merge({},u,m):u,a.data=spa.isBlank(u)||"string"!=f?u:JSON.stringify(u))}if(spa.ajaxPreProcess&&spa.ajaxPreProcess(a,e,t),(spa.isBlank(a.data)||spa.is(a.data,"string")&&!/[a-z0-9]/i.test(a.data))&&(spa.console.log("REMVOING EMPTY PAYLOAD"),delete a.data),n){var g=spa.is(a.data,"string")?a.data:JSON.stringify(a.data);g&&spa.is(g,"string")&&6144<g.length&&(g="LAREGE-PAYLOAD-WITH-CHAR-LENGTH:"+g.length),a.headers=_.merge({},a.headers,{"Z-Live-URL":r,"Z-Payload":g}),delete a.data}(app.debug||spa.debug)&&console.log("ajax Options",a)}spa.component=spa.$=spa.registerComponent=function(e,a){var t=!!a,n=e;if(a=a||{},e)if(_is(e,"object")&&(e=(a=_.merge({},e)).name||a.componentName||"spaComponent"+spa.now(),a.componentName=e,n=e),_is(n,"string")){if(0<=reservedCompNames.indexOf(n))console.error("Invalid component name "+n+". Cannot create Reserved components:"+reservedCompNames.join());else if(is(n,"string")&&n&&(n=n.trim())){if(!t){var r,s,o=-1;return 0<n.indexOf(" ")&&(r=n.getRightStr(" ").trim(),n=n.getLeftStr(" ")),0<n.indexOf(":")&&(o=spa.toInt(n.getRightStr(":").trim()),n=n.getLeftStr(":")),n=n.replace(/[^a-z0-9]/gi,"_"),spa.components[n]||console.warn('Unknown SPA Component "'+(e.getLeftStr(" ")||e)+'"'),(s=$('[data-rendered-component="'+n+'"]')).length&&0<=o&&(s=$(s[o])),r&&s.length&&(s="<"==r[0]?(r=r.getRightStr(0).trim(),s.find("[data-rendered-component]").length?s.find(r).filter(function(){return $(this).closest("[data-rendered-component]").data("renderedComponent")==n}):s.find(r)):s.find(r)),s}if(/[^a-z0-9\/]/gi.test(n)||!/^([a-z])/i.test(n))return void console.error('Invalid component name "'+n+'" to create. Component name must contain only Alphanumeric (a-z A-Z 0-9) and must begin with alphabet (a-z A-Z).');if(/[^a-z0-9]/gi.test(n)&&(n=n.replace(/[^a-z0-9]/gi,"_")),spa.components[n])return;a.componentName=n,a.hasOwnProperty("beforeRender")||(a.beforeRender="app."+n+".onRender"),a.hasOwnProperty("renderCallback")||(a.renderCallback="app."+n+".renderCallback"),a.hasOwnProperty("require")&&spa.loadComponents(a.require,function(){spa.console.log("Required components successfully loaded.")},function(){spa.console.log("Failed to load required components.")}),a=_adjustComponentOptions(n,a);var i=_.merge({},a);_.each(["target","template","templateCache","templateScript","templateUrl","templateUrlMethod","templateUrlParams","templateUrlPayload","templateUrlHeaders","onTemplateUrlError","style","styleCache","styles","stylesCache","scripts","scriptsCache","require","dataPreRequest","data","dataCollection","dataUrl","dataUrlMethod","dataUrlParams","dataUrlHeaders","dataParams","dataType","dataModel","dataCache","dataUrlCache","dataDefaults","data_","dataExtra","dataXtra","onDataUrlError","onError","dataValidate","dataProcess","dataPreProcessAsync","beforeRender","beforeRefresh","componentName"],function(e){delete a[e]}),is(a.renderCallback,"string")&&delete a.renderCallback,_.each(Object.keys(a),function(e){delete i[e]}),i.renderCallback="app."+n+".renderCallback",spa.components[n]=i,spa.extendComponent(e,a)}}else console.error("Invalid ComponentName:",n);else console.error("Missing ComponentName to register.")},spa.$$=spa.registerComponents=function(){if(arguments.length){var a=arguments;1==arguments.length&&(a=_.isArray(arguments[0])?arguments[0]:_.isString(arguments[0])?arguments[0].split(","):arguments[0]),spa.is(a,"object")?_.each(Object.keys(a),function(e){spa.console.info("Registering spa-component:["+e+"]"),spa.registerComponent(e,a[e])}):a&&a.length&&_.each(a,function(e){spa.console.info("Registering spa-component:["+e+"]"),spa.registerComponent(e.trim())})}},spa.extendComponent=spa.$extend=spa.module=function(e,a){if(a=a||{},e)if(is(e,"object")&&(e=(a=_.merge({},e)).name||a.componentName||"spaComponent"+spa.now(),a.componentName=e),is(e,"string")&&e){if(e=e.trim()){if(0<=reservedCompNames.indexOf(e))return void console.error("Invalid component name "+e+". Cannot extend Reserved components: "+reservedCompNames.join());if(/[^a-z0-9\/]/gi.test(e)||!/^([a-z])/i.test(e))return void console.error('Invalid component name "'+e+'" to extend. Component name must contain only Alphanumeric (a-z A-Z 0-9) and must begin with alphabet (a-z A-Z).');/[^a-z0-9]/gi.test(e)&&(e=e.replace(/[^a-z0-9]/gi,"_")),window.app=window.app||{},window.app[e]=window.app[e]||{},a&&_.isFunction(a)&&(a=a.call(spa.components[e]||{})),a=spa.is(a,"object")?a:{},spa.components[e]||(spa.components[e]={componentName:e,beforeRender:"app."+e+".onRender",renderCallback:"app."+e+".renderCallback"}),spa.components[e]&&(a.__prop__&&_.merge(spa.components[e],$.extend({},a.__prop__)),a.__prop__=spa.components[e]),$.extend(window.app[e],a),window["$$"+e]=window.app[e]}}else console.error("Invalid ComponentName:",e);else console.error("Missing ComponentName to extend.")},spa.extendComponents=spa.$$extend=function(){if(arguments.length){var a=arguments;1==arguments.length&&(a=_.isArray(arguments[0])?arguments[0]:_.isString(arguments[0])?arguments[0].split(","):arguments[0]),spa.is(a,"object")?_.each(Object.keys(a),function(e){spa.console.info("Extend spa-component:["+e+"]"),spa.extendComponent(e,a[e])}):a&&a.length&&_.each(a,function(e){spa.console.info("Extend spa-component:["+e+"]"),spa.extendComponent(e.trim())})}},spa.$bind=function(e,a){e=String(e).replace(/[^a-z0-9]/gi,"_"),spa.isBlank(a)&&(a=spa.findSafe(app,e+".$data",{})),spa.$(e).spaBindData(a)},spa.$data=function(a,e,t){var n;if(a=((a=String(a).replace(/[^a-z0-9]/gi,"_"))||"").trim(),t=t||"update",a)if(app.hasOwnProperty(a)){if(n=spa.findSafe(app,a+".$data"),e){if(n=function update$data(e){return spa.is(e,"object")&&(["update","merge"].__has(t,"i")?_.merge(app[a].$data,e):["*","reset","replace","overwrite"].__has(t,"i")&&(app[a].$data=e)),app[a].is$DataUpdated=spa.components[a].is$DataUpdated=!0,app[a].$data}(spa.is(e,"function")?e.call(app[a],app[a].$data):e),spa.$(a).is(":visible")){var r=spa.components[a],s=r.dataCache,o=(r.on$dataChange||"").trim().toLowerCase();s&&o&&["render","refresh","bind"].__has(o)&&(spa.console.log(a+"$"+o+" on $data update ..."),spa["$"+o](a)),spa.renderUtils.runCallbackFn("app."+a+".$dataChangeCallback",app[a].$data,app[a])}else console.log("Component is not visible! Skipped $on$dataChange.");spa.$dataNotify(a)}}else spa.console.warn("SPA Component[",a,"] is not loaded.");return n},spa.$dataWatch=function(e,a,t){if((e=String(e).replace(/[^a-z0-9]/gi,"_"))&&a&&spa.is(t,"function"))return _$dataWatchList.hasOwnProperty(e)||(_$dataWatchList[e]={}),_$dataWatchList[e].hasOwnProperty(a)?void console.warn("$dataWatch [",a,"] already exists in spa$[",e,"]"):(_$dataWatchList[e][a]=t,!0)},spa.$dataUnwatch=function(e,a){var t;return(e=String(e).replace(/[^a-z0-9]/gi,"_"))&&a&&_$dataWatchList.hasOwnProperty(e)&&("*"==a&&(delete _$dataWatchList[e],t=!0),_$dataWatchList[e].hasOwnProperty(a)&&(delete _$dataWatchList[e][a],t=!0)),t||console.warn("$dataWatch [",a,"] does not exist in spa$[",e,"]"),t},spa.$dataNotify=function(a,e){if((a=String(a).replace(/[^a-z0-9]/gi,"_"))&&_$dataWatchList.hasOwnProperty(a)){var t=Object.keys(_$dataWatchList[a]);e&&(t=e.split(",")),_.each(t,function(e){e=(e||"").trim(),_$dataWatchList[a].hasOwnProperty(e)&&_$dataWatchList[a][e].call(void 0,app[a].$data,app[a],e)})}},spa.$renderCount=function(e){return spa.findSafe(window,"app."+String(e).replace(/[^a-z0-9]/gi,"_")+".__renderCount__",0)},spa.removeComponent=function(e,n){var a;function isOk2Remove$(e){e=String(e).replace(/[^a-z0-9]/gi,"_").trim();var a,t=spa.isBlank(e);return t||(a=spa.renderUtils.runCallbackFn("app."+e+".onRemove",n||"_script_",app[e]),(t=spa.is(a,"undefined")||spa.is(a,"boolean")&&a)||spa.console.warn("Remove $"+e+" request denied onRemove()")),t}if(e=(e||"").replace(/[^a-z0-9]/gi,"_").trim(),n=n&&(e==n?"_self_":n),e){var t=$('[data-rendered-component="'+e+'"]');if(t.length){var r=t.find("[data-rendered-component]").map(function(){return $(this).attr("data-rendered-component")});(0==r.length||_.every(r,function(e){return isOk2Remove$(e)}))&&isOk2Remove$(e)&&(t.html("").text("").val("").data("renderedComponent","").removeAttr("data-rendered-component"),a=!0)}else a=!0}return spa.is(a,"boolean")&&a},spa.destroyComponent=function(e){var a;if((e=(e||"").replace(/[^a-z0-9]/gi,"_").trim())&&spa.removeComponent(e)&&(delete app[e],spa.components[e])){var t=spa.findSafe(spa.components[e],"template","");t&&!t.beginsWithStr("#")&&(t="#__tmpl_"+(""+t).replace(/[^a-z0-9]/gi,"_")),$("script"+t).remove(),delete spa.components[e],delete spa.compiledTemplates4DataBind[e],delete spa.compiledTemplates[e],delete _$dataWatchList[e],a=!0}return a},spa.showComponent=function(e,a){var t=(e||"").replace(/[^a-z0-9]/gi,"_").trim();if(t){var n=$('[data-rendered-component="'+t+'"]');n.length?n.show():spa.$render(e,a)}},spa.hideComponent=function(e){(e=(e||"").replace(/[^a-z0-9]/gi,"_").trim())&&$('[data-rendered-component="'+e+'"]').hide()},spa.disableComponent=function(e){(e=(e||"").replace(/[^a-z0-9]/gi,"_").trim())&&$('[data-rendered-component="'+e+'"]').css("pointer-events","none").addClass("disabled").attr("disabled","disabled")},spa.enableComponent=function(e){(e=(e||"").replace(/[^a-z0-9]/gi,"_").trim())&&$('[data-rendered-component="'+e+'"]').css("pointer-events","auto").removeClass("disabled").removeAttr("disabled")},spa.removeComponents=spa.$remove=spa.$$remove=function(){_spaComponentOp.apply({action:"removeComponent"},arguments)},spa.destroyComponents=spa.$destroy=spa.$$destroy=function(){_spaComponentOp.apply({action:"destroyComponent"},arguments)},spa.showComponents=spa.$show=spa.$$show=function(){_spaComponentOp.apply({action:"showComponent"},arguments)},spa.hideComponents=spa.$hide=spa.$$hide=function(){_spaComponentOp.apply({action:"hideComponent"},arguments)},spa.enableComponents=spa.$enable=spa.$$enable=function(){_spaComponentOp.apply({action:"enableComponent"},arguments)},spa.disableComponents=spa.$disable=spa.$$disable=function(){_spaComponentOp.apply({action:"disableComponent"},arguments)},spa.refreshComponent=spa.$refresh=function(e,a){e&&(a=a||{},spa.is(a,"object")&&(a.hasOwnProperty("beforeRender")||(a.beforeRender=a.beforeRefresh||"app."+e.replace(/[^a-z0-9]/gi,"_")+".onRefresh"),a.hasOwnProperty("renderCallback")||(a.renderCallback=a.refreshCallback||"app."+e.replace(/[^a-z0-9]/gi,"_")+".refreshCallback"),a.isRefreshCall=!0,spa.console.info("Calling refreshComponent: "+e+" with below options"),spa.console.info(a),spa.$render(e,a)))},spa.renderComponent=spa.$render=function(e,n){if(n=n||{},e){var r=e;is(e,"object")&&(n=_.merge({},e),e=n.name||n.componentName||"spaComponent"+spa.now(),n.componentName=e,r=e);var a=!n._reqFrTag_;if(_is(e,"string")){if("$"==(e=e.trim())[0]&&(a=!0),!(n&&is(n,"object")&&n.isRefreshCall)&&spa.$renderCount(r)&&spa.findSafe(window,"app."+r+".refreshCallback",""))return spa.console.info("Component ["+e+"] has been rendered already. Refreshing instead of re-render."),void spa.refreshComponent(r,n);if(spa.console.info("Called renderComponent: "+e+" with options",n),!a&&/[^a-z0-9]/gi.test(r)){var t,s=r;if(r[0]===spa.api.urlKeyIndicator&&(t=r.trimLeftStr(spa.api.urlKeyIndicator),s=spa.api.urls[t]||""),n.componentUrl=s,spa.console.info("Called to render ServerComponent: ["+r+"] with options",n),t&&!s&&console.warn("ComponentURL undefined: app.api.urls."+t),s){var o=n.targetEl,i=__finalValue(spa.toJSON(n.urlHeaders),n),p=__finalValue(spa.toJSON(n.urlParams),n),l=__finalValue(spa.toJSON(n.urlPayload),n),c=(n.urlMethod||"GET").toLowerCase(),d="false"!==String(n.urlCache||"false").toLowerCase(),u=spa.api.url(s,p),f=__finalValue(n.urlError);spa.console.log("Loading ServerComponent ..."),spa.api[c](u,l,function _onSuccess(e){$(o).html(e),spa.renderComponentsInHtml(o)},function _onFail(e,a,t){this.onError&&_is(this.onError,"function")?this.onError.call(this,e,a,t):(console.warn("Unable to load ServerComponent."),console.error(String(a).toUpperCase()+":"+t,e))},{ajaxOptions:{dataType:"html",headers:i,cache:d,onError:f}})}}else{var m=/[^a-z0-9]/gi.test(e);m&&(r=e.replace(/[\s\$]/g,"").replace(/[^a-z0-9]/gi,"_"));var g="_rtt_"+r,h="";n=_adjustComponentOptions(r,n);var y=m?r.replace(/[^a-z0-9]/gi,"/"):r,v=r;if(m){var b=r.split("_");v=b[b.length-1]}function lG(){if(spa.console.info("_renderComp: "+r+" with below options"),spa.console.info(n),!spa.components[r].hasOwnProperty("template"))if(spa.components[r].hasOwnProperty("templateStr")||spa.components[r].hasOwnProperty("templateString"))h=spa.components[r].templateStr||spa.components[r].templateString||"",spa.updateTemplateScript(g,h),spa.components[r].template="#"+g;else if(spa.hasPrimaryKeys(spa.components[r],"templateUrl")){var e=(spa.components[r].templateUrl||"").trim();e&&/^(\.\/)/.test(e)&&(e=S+e.substr(2)),spa.components[r].template=e}else spa.components[r].template=C;spa.console.info("render-options: spa.components["+r+"]"),spa.console.info(spa.components[r]);var a=n&&n.saveOptions?spa.components[r]:$.extend({},spa.components[r]);if(n&&(n.hasOwnProperty("mountComponent")||delete a.mountComponent,$.extend(a,n),spa.console.info("Extended> render-options: spa.components["+r+"]"),spa.console.info(a)),a.hasOwnProperty("style")&&spa.is(a.style,"string")&&(a.dataStyles={},a.dataStyles[r+"Style"]="."==a.style||"$"==a.style?O+".css":/^(\.\/)/.test(a.style)?S+a.style.substr(2):a.style,delete a.style,spa.console.info("Using component style for ["+r+"]"),spa.console.info(a)),a&&_.isObject(a)&&a.dataCache){var t=spa.findSafe(app,r+".$data",{});spa.isBlank(t)?(a.dataCache=!1,spa.console.log("dataCache:false; Using/Ajaxing new data ...")):(a.data=t,a.dataProcess=!1,spa.console.log("dataCache:true; Using $data and ingored data + dataProcess ..."))}spa.render(a)}function mG(){w?spa.console.info("Loaded component ["+r+"] source from ["+w+"]"):spa.console.info("Skipped Loading component ["+r+"] source from script file."),spa.console.info("In Source> spa.components["+r+"]"),spa.console.info(spa.components[r]),spa.components.hasOwnProperty(r)||(spa.console.warn("spa.components["+r+"] NOT DEFINED in ["+(w||"spa.components")+"]. Creating *NEW*"),spa.isBlank(n)&&(n={}),n.hasOwnProperty("componentName")||(n.componentName=r),spa.components[r]=n,spa.console.info("NEW> spa.components["+r+"]"),spa.console.info(spa.components[r])),lG()}var S=spa.defaults.components.rootPath+(spa.defaults.components.inFolder||m?y+"/":""),O=S+v,C=O+spa.defaults.components.templateExt,T=spa.defaults.components.scriptExt,w=n&&_.isObject(n)&&n.hasOwnProperty("script")?n.script:T?O+T:"";spa.components.hasOwnProperty(r)?(spa.console.info("Re-rending spa.components["+r+"]"),spa.console.info(spa.components[r]),lG()):w?(spa.console.info("Attempt to load component ["+e+"]'s properties from ["+w+"]"),$.cachedScript(w,{success:mG,cache:spa.defaults.components.offline}).done(spa.noop).fail(function(){spa.console.info("Attempt to Load component ["+e+"]'s properties from ["+w+"] has FAILED. Not to worry. Continuing to render with default properties."),mG()})):mG()}}else console.error("Invalid ComponentName:",e)}else console.error("Missing ComponentName to render.")},spa.renderComponents=spa.$$render=function(){_spaRenderRefreshComponents.apply({action:"renderComponent"},arguments)},spa.refreshComponents=spa.$$refresh=function(){_spaRenderRefreshComponents.apply({action:"refreshComponent"},arguments)},spa.renderComponentsInHtml=function(e,i){e=e||"body",i=(i||"").trim(),$(e).find("spa-component[src]:not([data-spa-component]),x-component[src]:not([data-spa-component])").each(function(){this.setAttribute("data-spa-component",this.getAttribute("src"))});var p,l,c,d,u,f,m,a=$(e).find("[data-spa-component]");a.length&&a.each(function(e,a){if(p=$(a),m=p.data(),l=(p.attr("data-spa-component")||"").split("|"),c=l[0].trim(),(d=(l[1]||"").trim())&&(/\:\s*\$data/.test(d)&&(d=d.replace(/\:\s*\$data/g,":app."+i+".$data")),d=spa.toJSON(d)),c){if(!a.id){var t=String(c).trim();"$"==t[0]&&(t=t.replace(/[^a-z0-9]/gi,"_")),t=t.replace(/[^a-z0-9_]/gi,""),f="spaCompContainer_"+t+"_"+($("body").find("[rel=spaComponentContainer_"+t+"]").length+1),a.id=f,a.setAttribute("rel","spaComponentContainer_"+t)}var n=p.attr("data-spa-component-options")||p.attr("data-spa-$options")||p.attr("spa-$options")||"{}";if((u=_.merge({target:"#"+a.id,targetEl:a,spaComponent:c.trim(),_reqFrTag_:1},d,m,spa.toJSON(n))).hasOwnProperty("data")&&spa.is(u.data,"string")){var r=u.data.trim();/^\$data/.test(r)&&(r="app."+i+"."+r),u.data=_.merge({},spa.findSafe(window,r,{}))}var s=(p.attr("data-spa-component-$data")||p.attr("data-spa-$data")||p.attr("spa-$data")||"").trim();if(s&&(/\:\s*\$data/.test(s)&&(s=s.replace(/\:\s*\$data/g,":app."+i+".$data")),spa.isBlank(u.data)?u.data=spa.toJSON(s):_.merge(u.data,spa.toJSON(s))),!spa.isBlank(u.data)&&u.data.hasOwnProperty("$data")){var o=_.merge({},u.data.$data);delete u.data.$data,_.merge(u.data,o)}u.hasOwnProperty("data")&&(u.data_=_.merge({},u.data),delete u.data),spa.console.log("inner-component",c,"options:",u),spa.renderComponent(c,u)}})},spa.renderUtils={array2ObjWithKeyPrefix:function(e,a,t){var n={};return _.each(e,function(e){(e=(""+e).trimStr())&&(n[a+(e.equals(".")?t:e).replace(/[^a-z0-9]/gi,"_")]=""+e)}),spa.console.log([a,n]),n},getFn:function(e){var a=e;return e&&_.isString(e)&&(a=spa.findSafe(window,e)),a&&_.isFunction(a)?a:void 0},runCallbackFn:function(e,a,t){if(e){var n,r=e,s=t;if(_.isString(r)&&(s||(e.match("]$")?n=e.substring(0,e.lastIndexOf("[")):0<e.indexOf(".")&&(n=e.substring(0,e.lastIndexOf("."))),s=n?spa.findSafe(window,n):window),r=spa.findSafe(window,r)),r){if(_.isFunction(r))return spa.console.info("calling callback: "+e),spa.is(a,"array")&&"(...)"==a[0]?(a.shift(),r.apply(s,a)):r.call(s,a);spa.console.error("CallbackFunction <"+e+" = "+r+"> is NOT a valid FUNCTION.")}else spa.console.warn("CallbackFunction <"+e+"> is NOT defined.")}},registerComponentEvents:function(r){var e;r&&app[r]&&app[r].hasOwnProperty("events")&&_.each(Object.keys(app[r].events),function(n){app[r].events[n].hasOwnProperty("target")&&!spa.isBlank(app[r].events[n].target)&&(e=app[r].events[n].target,spa.$(r+" "+e).filter(":not([spa-events-"+n+'="'+r+'"])').attr("spa-events-"+n,r).each(function(e,t){_.each(Object.keys(app[r].events[n]),function(a){0==a.indexOf("on")&&_.each(a.split("_"),function(e){spa.console.log("registering component ["+r+"] event: "+n+"-"+e),$(t).on(e.trimLeftStr("on").toLowerCase(),app[r].events[n][a])})})}))})}},spa.render=function(viewContainerId,uOptions){if(spa.console.log("spa.render",viewContainerId,uOptions),arguments.length){if(1!==arguments.length||"object"!=typeof viewContainerId){uOptions&&function transOptions(t){_.each({template:"dataTemplate",templates:"dataTemplates",templateCache:"dataTemplatesCache",templatesCache:"dataTemplatesCache",html:"dataTemplate",htmls:"dataTemplates",htmlCache:"dataTemplatesCache",htmlsCache:"dataTemplatesCache",script:"dataScripts",scripts:"dataScripts",scriptCache:"dataScriptsCache",scriptsCache:"dataScriptsCache",style:"dataStyles",styles:"dataStyles",styleCache:"dataStylesCache",stylesCache:"dataStylesCache",renderType:"dataRenderType",beforeRender:"dataBeforeRender",dataRenderCallBack:"dataRenderCallback",renderCallback:"dataRenderCallback",renderCallBack:"dataRenderCallback",callback:"dataRenderCallback",callBack:"dataRenderCallback",onRemove:"dataRemoveCallback",dataRenderMode:"dataRenderMode",renderMode:"dataRenderMode",renderId:"dataRenderId"},function(e,a){t.hasOwnProperty(a)&&(t[e]=uOptions[a],delete t[a])})}(uOptions);var retValue={id:"",view:{},model:{},cron:"",elDataAttr:{},target:viewContainerId,iOptions:uOptions},spaAjaxRequestsQue=[],doDeepRender=!1,foundViewContainer=spa.isElementExist(viewContainerId);foundViewContainer&&(retValue.elDataAttr=$(viewContainerId).data());var noOfArgs=arguments.length,useOptions=1<noOfArgs,useParamData=useOptions&&uOptions.hasOwnProperty("data"),dataFound=!0,rCompName=uOptions&&uOptions.componentName?uOptions.componentName:"",spaRVOptions={data:{},dataPreRequest:spa.defaults.components.dataPreRequest,dataUrl:"",dataUrlParams:{},dataUrlMethod:"GET",dataUrlErrorHandle:"",dataUrlHeaders:{},dataParams:{},dataType:"",dataExtra:{},dataXtra:{},data_:{},dataDefaults:{},dataModel:"",dataValidate:!1,dataProcess:"",dataUrlCache:!1,dataCache:!1,extend$data:spa.defaults.components.extend$data,dataCollection:{},dataTemplates:{},dataTemplate:"",dataTemplatesCache:!0,templateScript:!1,templateEngine:"",dataScripts:{},dataScriptsCache:!0,dataStyles:{},dataStylesCache:!0,dataBeforeRender:"",dataRenderCallback:"",dataRemoveCallback:"",dataRenderMode:"",skipDataBind:!1,render:"",dataRenderId:""};if(foundViewContainer||(spa.isElementExist("#spaRunTimeHtmlContainer")||$("body").append("<div id='spaRunTimeHtmlContainer' style='display:none;'></div>"),$("#spaRunTimeHtmlContainer").append("<div id='"+viewContainerId.replace(/\#/gi,"")+"'></div>")),useOptions){var _globalCompOptions={dataTemplatesCache:spa.defaults.components.templateCache};uOptions=_.merge({},_globalCompOptions,uOptions);var saveOptions=uOptions.hasOwnProperty("saveOptions")&&uOptions.saveOptions;for(var key in uOptions)spaRVOptions[key]=uOptions[key],saveOptions&&"data"!==key&&"saveOptions"!==key&&$(viewContainerId).data(""+(""+(_.at(""+key,4)||"")).toLowerCase()+key.slice(5),spa.toStr(uOptions[key]))}spa.console.log(rCompName+".$"+(spaRVOptions.isRefreshCall?"refresh":"render")+" with options:",spaRVOptions,"$data",spa.findSafe(app,rCompName+".$data"));var $viewContainerId=$(viewContainerId),pCompName=$viewContainerId.attr("data-rendered-component")||"",is$refresh=pCompName==rCompName;if(_isSpaNavBlocked($viewContainerId)){spa.console.log("Component container [",viewContainerId,"] blocks navigation.");var $navBlockContainer=$viewContainerId.hasClass(_blockNavClassName)?$viewContainerId:$viewContainerId.find(_blockNavClass);if(1<$navBlockContainer.length&&($navBlockContainer=$($navBlockContainer[0])),$navBlockContainer.length){var onNavAway=($navBlockContainer.attr(_attrOnNavAway)||"").trim(),navAwayFn,navAwayFnRes;if(onNavAway){if("#"==onNavAway[0]||">"==onNavAway[0]){var navAwayTargetSelector=">"==onNavAway[0]?onNavAway.substr(1).trim():onNavAway,$navAwayTarget=$navBlockContainer.find(navAwayTargetSelector).filter(":not(.disabled):not(:disabled)");if($navAwayTarget.length)return void $navAwayTarget.trigger("click")}else if(navAwayFn=spa.findSafe(window,onNavAway.split("(")[0].split(";")[0]),navAwayFn&&spa.is(navAwayFn,"function")&&(navAwayFnRes=navAwayFn.call(app[pCompName],app[pCompName],app[rCompName])),navAwayFn&&(!spa.is(navAwayFnRes,"boolean")||!navAwayFnRes))return}else if(navAwayFn=spa.findSafe(app,pCompName+".onNavBlock"),navAwayFn&&spa.is(navAwayFn,"function")&&(navAwayFnRes=navAwayFn.call(app[pCompName],app[pCompName],app[rCompName])),navAwayFn&&(!spa.is(navAwayFnRes,"boolean")||!navAwayFnRes))return}spa.console.log("Render continues.")}is$refresh&&(spa.console.log("$refresh - Auto-Detected",rCompName,spaRVOptions),"auto".equalsIgnoreCase(""+spaRVOptions.render)&&(spa.console.log("Finding for refresh events."),_fixRefreshCalls("dataBeforeRender",".onRender","onRefresh"),_fixRefreshCalls("dataRenderCallback",".renderCallback","refreshCallback")));var _renderOptionInAttr=function(e){return(""+$viewContainerId.data(e)).replace(/undefined/,"")},_renderOption=function(e,a){return spa.isBlank(spaRVOptions[e])?_renderOptionInAttr(a):spaRVOptions[e]},spaRenderId=_renderOption("dataRenderId","renderId");retValue.id=spaRenderId.ifBlankStr("spaRender"+spa.now()+spa.rand(1e3,9999));var targetRenderMode=_renderOption("dataRenderMode","renderMode")||"replace";spa.console.log("Render Mode: <"+targetRenderMode+">");var spaTemplateType="x-spa-template",spaTemplateEngine=(spaRVOptions.templateEngine||spa.defaults.components.templateEngine||"handlebars").toLowerCase();if(spa.console.group("spaLoadingViewScripts"),useOptions&&uOptions.hasOwnProperty("dataScriptsCache"))spa.console.info("Override [data-scripts-cache] with user option [dataScriptsCache]: "+spaRVOptions.dataScriptsCache);else{var scriptsCacheInTagData=_renderOptionInAttr("scriptsCache");spa.isBlank(scriptsCacheInTagData)||(spaRVOptions.dataScriptsCache=scriptsCacheInTagData.toBoolean(),spa.console.info("Override [data-scripts-cache] with [data-scripts-cache] option in tag-attribute: "+spaRVOptions.dataScriptsCache))}var vScriptsList=_renderOptionInAttr("scripts");vScriptsList&&spa.isBlank((vScriptsList||"").replace(/[^:'\"]/g,""))&&(vScriptsList="'"+vScriptsList.split(",").join("','")+"'");var vScripts=spa.toJSON(vScriptsList||"{}"),vScriptsNames,scriptPath;if(!_.isObject(spaRVOptions.dataScripts)&&_.isString(spaRVOptions.dataScripts)&&(vScriptsList=(spaRVOptions.dataScripts||"").trimStr(),spa.isBlank((vScriptsList||"").replace(/[^:'\"]/g,""))&&(vScriptsList="'"+vScriptsList.split(",").join("','")+"'"),spaRVOptions.dataScripts=spa.toJSON(vScriptsList)),$.isEmptyObject(spaRVOptions.dataScripts)||(vScripts=spaRVOptions.dataScripts),_.isArray(vScripts)&&_.remove(vScripts,function(e){return!e}),spa.console.info(vScripts),vScriptsList=[],vScripts&&!$.isEmptyObject(vScripts)){if(_.isArray(vScripts)){spa.console.info("Convert array of script(s) without scriptID to object with scriptID(s).");var newScriptsObj=spa.renderUtils.array2ObjWithKeyPrefix(vScripts,"__scripts_",viewContainerId);spa.console.info("Scripts(s) with scriptID(s)."),spa.console.log(newScriptsObj),vScripts=_.isEmpty(newScriptsObj)?{}:newScriptsObj}spa.console.info("External scripts to be loaded [cache:"+spaRVOptions.dataScriptsCache+"] along with view container ["+viewContainerId+"] => "+JSON.stringify(vScripts)),vScriptsNames=_.keys(vScripts)}else spa.console.info("No scripts defined [data-scripts] in view container ["+viewContainerId+"] to load.");if(spa.console.groupEnd("spaLoadingViewScripts"),vScriptsNames)vScriptsList=_.map(vScriptsNames,function(e){return!(scriptPath=_getFullPath4Component(vScripts[e],rCompName)).endsWithStrIgnoreCase(".js")&&scriptPath.indexOf("?")<0&&(scriptPath+=spa.defaults.components.scriptExt),(spaRVOptions.dataScriptsCache?"":"~")+scriptPath});return spa.console.log("component [",rCompName,"] scripts:",vScriptsList),spa.loadScriptsSync(vScriptsList,function _onScriptsLoadComplete(){spa.console.info("External Scripts Loaded."),!_appApiInitialized&&Object.keys(app.api).length&&_initApiUrls();var dataPreRequest=spaRVOptions?spaRVOptions.dataPreRequest:"";if(spa.is(dataPreRequest,"string")&&(dataPreRequest=spa.renderUtils.getFn(dataPreRequest)),spa.is(dataPreRequest,"function"))try{var dataPreRequestRes=dataPreRequest.call(app[rCompName]);dataPreRequestRes&&spa.is(dataPreRequestRes,"object")&&Object.keys(dataPreRequestRes).forEach(function(e){0==e.indexOf("data")&&(spaRVOptions[e]=dataPreRequestRes[e])})}catch(e){console.error("dataPreRequest-Error in app."+rCompName,e)}spa.console.group("spaDataModel");var dataModelName=_renderOption("dataModel","model"),dataModelUrl=_renderOption("dataUrl","url"),viewDataModelName,isLocalDataModel=useParamData||dataModelUrl.beginsWithStrIgnoreCase("local:"),defaultDataModelName=dataModelUrl.beginsWithStrIgnoreCase("local:")?dataModelUrl.replace(/local:/gi,""):"data",defPayLaod=_appApiDefaultPayload(),dataUrlPayLoad,_stringifyPayload=spaRVOptions&&spaRVOptions.hasOwnProperty("stringifyPayload")?spaRVOptions.stringifyPayload:spa.findSafe(app,"api.ajaxOptions.stringifyPayload");dataModelName=dataModelName.ifBlankStr(defaultDataModelName),viewDataModelName=dataModelName.replace(/\./g,"_");var spaTemplateModelData={};if(useParamData)spaTemplateModelData[viewDataModelName]=spa.is(spaRVOptions.data,"function")?spaRVOptions.data():spaRVOptions.data,spa.console.info("Loaded data model ["+dataModelName+"] from argument");else{if(useOptions&&uOptions.hasOwnProperty("dataCache"))spa.console.info("Override [data-cache] with user option [dataCache]: "+spaRVOptions.dataCache);else{var dataCacheInTagData=_renderOptionInAttr("cache");spa.isBlank(dataCacheInTagData)||(spaRVOptions.dataCache=dataCacheInTagData.toBoolean(),spa.console.info("Override [data-cache] with [data-cache] option in tag-attribute: "+spaRVOptions.dataCache))}if(spa.isBlank(dataModelUrl)){spaTemplateModelData[viewDataModelName]={};var dataModelCollection=_renderOptionInAttr("collection");dataModelCollection=dataModelCollection&&spa.toJSON(dataModelCollection),spa.isBlank(spaRVOptions.dataCollection)||(dataModelCollection=spaRVOptions.dataCollection),_.isArray(dataModelCollection)&&(dataModelCollection={urls:dataModelCollection});var dataModelUrls=dataModelCollection.urls;if(spa.isBlank(dataModelUrls))spa.console.warn("Model Data ["+dataModelName+"] or [data-url] or [data-collection] NOT found! Check the arguments or html markup. Rendering with options."),spaTemplateModelData[viewDataModelName]=_.merge({},spaRVOptions.dataDefaults,spaRVOptions.data_,spaRVOptions.dataExtra,spaRVOptions.dataXtra);else if(_.isArray(dataModelUrls)){spa.console.info("Processing data-URLs");var dataIndexApi=0,defaultAutoDataNamePrefix=dataModelCollection.nameprefix||"data";_.each(dataModelUrls,function(p){var e=defaultAutoDataNamePrefix+dataIndexApi,l=_.has(p,"name")?(""+p.name).replace(/[^a-zA-Z0-9]/gi,""):_.has(p,"target")?""+p.target:e,c=_.has(p,"url")?p.url:_.has(p,"path")?p.path:"";if(l.containsStr(".")&&(l=_.last(l.split("."),1)),l=l.ifBlankStr(e),spa.console.info("processing data-api for: "+l),spa.console.log(p),c){_.has(p,"urlParams")&&(c=spa.api.url(c,p.urlParams));var a=_.has(p,"headers")?p.headers:spaRVOptions.dataUrlHeaders;spa.isBlank(a)&&(a=spa.findSafe(window,"app.api.ajaxOptions.headers",{})),dataUrlPayLoad=_.has(p,"params")?p.params:_.has(p,"data")?p.data:{},_.has(p,"defaultPayload")||spa.isBlank(defPayLaod)||(dataUrlPayLoad=_.merge({},defPayLaod,!spa.isBlank(dataUrlPayLoad)&&spa.is(dataUrlPayLoad,"object")?dataUrlPayLoad:{})),!spa.isBlank(dataUrlPayLoad)&&_stringifyPayload&&(dataUrlPayLoad=JSON.stringify(dataUrlPayLoad)),spaAjaxRequestsQue.push($.ajax({url:c,method:(""+(p.method||"GET")).toUpperCase(),headers:spa.is(a,"function")?a():a,data:dataUrlPayLoad,cache:_.has(p,"cache")?p.cache:spaRVOptions.dataCache,dataType:_.has(p,"type")?p.type:spaRVOptions.dataType||spa.findSafe(window,"app.api.ajaxOptions.dataType","text"),success:function(e,a,t){var n,r=_.has(p,"target")?""+p.target:"",s=spa.is(e,"string")?spa.toJSON(""+e,"data"):e;if(0<r.indexOf("."))n=spa.hasKey(s,r)?spa.find(s,r):s;else try{n=s.hasOwnProperty(r)?s[r]:s}catch(e){console.warn("Error in Data Model ["+r+"] in URL ["+c+"].\n"+e.stack)}spaTemplateModelData[viewDataModelName][l]?(spaTemplateModelData[viewDataModelName][l]=[spaTemplateModelData[viewDataModelName][l]],spaTemplateModelData[viewDataModelName][l].push(n)):spaTemplateModelData[viewDataModelName][l]=n,spa.console.info("Loaded data model ["+l+"] from ["+c+"]");var o=p.success||p.onsuccess||p.onSuccess;if(o=o||(dataModelCollection.success||dataModelCollection.onsuccess||dataModelCollection.onSuccess))if(_.isFunction(o))o.call(this,s,p,a,t);else if(_.isString(o)){var i=spa.findSafe(window,o);"function"==typeof i?i.call(this,s,p,a,t):spa.console.log("Unknown ajax success handle: "+o)}},error:function(e,a,t){spa.console.warn("Error processing data-api ["+c+"]");var n=p.error||p.onerror||p.onError;if(!n){n=dataModelCollection.error||dataModelCollection.onerror||dataModelCollection.onError;var r=spaRVOptions.dataUrlErrorHandle||spaRVOptions.onDataUrlError||spaRVOptions.onError;!n&&r&&(n=r)}if(n){if(_.isFunction(n))n.call(this,e,a,t);else if(_.isString(n)){var s=spa.findSafe(window,n);"function"==typeof s?s.call(this,oResult,p):spa.console.log("Unknown ajax error handle: "+n)}}else spa.is(app.api.onError,"function")?app.api.onError.call(this,e,a,t):spa.api.onReqError.call(this,e,a,t)}}))}else spa.console.error("data-api-url not found. Please check the arguments or html markup. Skipped this data-api request");dataIndexApi++})}else spa.console.warn("Invalid [data-urls].Check the arguments or html markup. Rendering with empty data {}.")}else if(dataModelUrl.beginsWithStrIgnoreCase("local:")){var localDataModelName=dataModelUrl.replace(/local:/gi,""),localDataModelObj={};if(_isValidEvalStr(localDataModelName)&&(void 0!==eval("("+localDataModelName+")")&&eval("(localDataModelObj="+localDataModelName+")"),spa.console.info("Using LOCAL Data Model: "+localDataModelName)),!isLocalDataModel&&0<dataModelName.indexOf("."))spaTemplateModelData[viewDataModelName]=spa.hasKey(localDataModelObj,dataModelName)?spa.find(localDataModelObj,dataModelName):localDataModelObj;else try{spaTemplateModelData[viewDataModelName]=localDataModelObj.hasOwnProperty(dataModelName)?localDataModelObj[dataModelName]:localDataModelObj}catch(e){console.warn("Error in Data Model ["+dataModelName+"] in Local Object ["+localDataModelName+"].\n"+e.stack)}}else{spa.isBlank(spaRVOptions.dataUrlParams)||(dataModelUrl=spa.api.url(dataModelUrl,spaRVOptions.dataUrlParams)),spa.console.info("Request Data ["+dataModelName+"] [cache:"+(spaRVOptions.dataUrlCache||spaRVOptions.dataCache)+"] from URL =>"+dataModelUrl);var ajaxReqHeaders=spaRVOptions.dataUrlHeaders;spa.isBlank(ajaxReqHeaders)&&(ajaxReqHeaders=spa.findSafe(window,"app.api.ajaxOptions.headers",{})),dataUrlPayLoad=spaRVOptions.dataParams,spaRVOptions.hasOwnProperty("defaultPayload")||spa.isBlank(defPayLaod)||(dataUrlPayLoad=_.merge({},defPayLaod,!spa.isBlank(dataUrlPayLoad)&&spa.is(dataUrlPayLoad,"object")?dataUrlPayLoad:{})),!spa.isBlank(dataUrlPayLoad)&&_stringifyPayload&&(dataUrlPayLoad=JSON.stringify(dataUrlPayLoad));var axOptions={url:dataModelUrl,method:(""+(_renderOption("dataUrlMethod","urlMethod")||"GET")).toUpperCase(),headers:spa.is(ajaxReqHeaders,"function")?ajaxReqHeaders():ajaxReqHeaders,data:dataUrlPayLoad,cache:spaRVOptions.dataUrlCache||spaRVOptions.dataCache,dataType:spaRVOptions.dataType||spa.findSafe(window,"app.api.ajaxOptions.dataType","text"),success:function(e){var a=spa.is(e,"string")?spa.toJSON(""+e,"data"):e,t=_renderOption("dataValidate","validate");if(0<dataModelName.indexOf("."))spaTemplateModelData[viewDataModelName]=spa.hasKey(a,dataModelName)?spa.find(a,dataModelName):a;else try{"data"!=dataModelName||a.hasOwnProperty(dataModelName)||(viewDataModelName=dataModelName="Data"),spaTemplateModelData[viewDataModelName]=!t&&a.hasOwnProperty(dataModelName)?a[dataModelName]:a}catch(e){console.error("Error in Data Model ["+dataModelName+"] in URL ["+dataModelUrl+"].\n"+e.stack)}spa.console.info("Loaded data model ["+dataModelName+"] from ["+dataModelUrl+"]")},error:function(e,a,t){var n=_renderOption("dataUrlErrorHandle","urlErrorHandle");if(spa.isBlank(n))spa.is(app.api.onError,"function")?app.api.onError.call(this,e,a,t):spa.api.onReqError.call(this,e,a,t);else{var r=spa.findSafe(window,n);"function"==typeof r?r.call(this,e,a,t):spa.console.log("Unknown ajax error handle: "+n)}}};spaAjaxRequestsQue.push($.ajax(axOptions))}}if(spa.console.info("End of Data Processing"),spa.console.log({o:spaTemplateModelData}),spa.console.groupEnd("spaDataModel"),dataFound){var vTemplate2RenderInTag=_renderOptionInAttr("template")||_renderOptionInAttr("html"),vTemplatesList=_renderOptionInAttr("templates")||_renderOptionInAttr("htmls");vTemplatesList&&spa.isBlank((vTemplatesList||"").replace(/[^:'\"]/g,""))&&(vTemplatesList="'"+vTemplatesList.split(",").join("','")+"'");var vTemplates=spa.toJSON(vTemplatesList||"{}");if(!_.isObject(spaRVOptions.dataTemplates)&&_.isString(spaRVOptions.dataTemplates)&&(vTemplatesList=(spaRVOptions.dataTemplates||"").trimStr(),spa.isBlank((vTemplatesList||"").replace(/[^:'\"]/g,""))&&(vTemplatesList="'"+vTemplatesList.split(",").join("','")+"'"),spaRVOptions.dataTemplates=spa.toJSON(vTemplatesList)),$.isEmptyObject(spaRVOptions.dataTemplates)||(vTemplates=spaRVOptions.dataTemplates,vTemplatesList=""+JSON.stringify(vTemplates)),(_.isEmpty(spa.toJSON((vTemplatesList||"").trimStr()))||_.isArray(vTemplates)&&1==vTemplates.length&&spa.isBlank(vTemplates[0]))&&(vTemplates={},vTemplatesList=""),spa.console.info("Templates:"),spa.console.info(vTemplates),_.isArray(vTemplates)&&!_.isEmpty(vTemplates)){spa.console.info("Array of template(s) without templateID(s).");var newTemplatesObj=spa.renderUtils.array2ObjWithKeyPrefix(vTemplates,"__tmpl_",viewContainerId);spa.console.info("Template(s) with template ID(s)."),spa.console.log(newTemplatesObj),vTemplatesList=_.isEmpty(newTemplatesObj)?(vTemplates={},""):(vTemplates=newTemplatesObj,""+JSON.stringify(vTemplates))}if(!vTemplates||$.isEmptyObject(vTemplates)){vTemplates={};var _dataTemplate=spaRVOptions.dataTemplate,_tmplKey="",_tmplLoc="";spa.isBlank(_dataTemplate)&&(spa.isBlank(vTemplate2RenderInTag)||(spa.console.info("Template to load from location <"+vTemplate2RenderInTag+">"),_dataTemplate=vTemplate2RenderInTag)),_dataTemplate=(_dataTemplate||"").trimStr(),spa.console.info("Primary Template: <"+_dataTemplate+">"),spa.isBlank(_dataTemplate)||_dataTemplate.equalsIgnoreCase("inline")||_dataTemplate.equals(".")?(spa.console.info("Using target container (inline) content as template."),_tmplKey="_tmplInline_"+viewContainerId.trimStr("#")):_dataTemplate.beginsWithStr("#")?(spa.console.info("Using page container <"+_dataTemplate+"> content as template."),_tmplKey=_dataTemplate.trimStr("#")):(spa.console.info("External path <"+_dataTemplate+"> content as template."),_tmplKey="__tmpl_"+(""+_dataTemplate).replace(/[^a-z0-9]/gi,"_"),_tmplLoc=_dataTemplate),vTemplates[_tmplKey]=_tmplLoc.replace(/['\"]/g,""),spa.console.info(vTemplates)}if(spa.console.group("spaView"),vTemplates&&!$.isEmptyObject(vTemplates)){spa.console.info("Templates of ["+spaTemplateType+"] to be used in view container ["+viewContainerId+"] => "+JSON.stringify(vTemplates));var vTemplateNames=_.keys(vTemplates);if(spa.console.group("spaLoadingTemplates"),spa.console.group("spaLoadingTemplatesCache"),useOptions&&uOptions.hasOwnProperty("dataTemplatesCache"))spa.console.info("Override [data-templates-cache] with user option [dataTemplatesCache]: "+spaRVOptions.dataTemplatesCache);else{var templatesCacheInTagData=_renderOptionInAttr("templatesCache")||_renderOptionInAttr("templateCache")||_renderOptionInAttr("htmlsCache")||_renderOptionInAttr("htmlCache");spa.isBlank(templatesCacheInTagData)||(spaRVOptions.dataTemplatesCache=templatesCacheInTagData.toBoolean(),spa.console.info("Override [data-templates-cache] with [data-templates-cache] option in tag-attribute: "+spaRVOptions.dataTemplatesCache))}spa.console.groupEnd("spaLoadingTemplatesCache"),spa.console.info("Load Templates"),spa.console.info(vTemplates);var tmplPayload=spaRVOptions.templateUrlPayload;tmplPayload&&_is(tmplPayload,"string")&&tmplPayload.indexOf("=")<0&&(tmplPayload=__finalValue(tmplPayload,spaRVOptions));var tmplOptions={method:spaRVOptions.templateUrlMethod,params:__finalValue(spaRVOptions.templateUrlParams,spaRVOptions),payload:tmplPayload,headers:__finalValue(spaRVOptions.templateUrlHeaders,spaRVOptions),onError:__finalValue(spaRVOptions.onTemplateUrlError||spaRVOptions.onError)};_.each(vTemplateNames,function(e,a){spa.console.info([a,e,vTemplates[e],spaTemplateType,viewContainerId,spaRVOptions]),spaAjaxRequestsQue=spa.loadTemplate(e,vTemplates[e],spaTemplateType,viewContainerId,spaAjaxRequestsQue,!spaRVOptions.dataTemplatesCache,tmplOptions)});var vTemplate2RenderID="#"+vTemplateNames[0].trimStr("#");if(spa.console.info("External Data/Templates Loading Status: "+JSON.stringify(spaAjaxRequestsQue)),spa.console.groupEnd("spaLoadingTemplates"),spa.console.info("Render TemplateID: "+vTemplate2RenderID),spa.console.group("spaLoadingViewStyles"),useOptions&&uOptions.hasOwnProperty("dataStylesCache"))spa.console.info("Override [data-styles-cache] with user option [dataStylesCache]: "+spaRVOptions.dataStylesCache);else{var stylesCacheInTagData=_renderOptionInAttr("stylesCache");spa.isBlank(stylesCacheInTagData)||(spaRVOptions.dataStylesCache=stylesCacheInTagData.toBoolean(),spa.console.info("Override [data-styles-cache] with [data-styles-cache] option in tag-attribute: "+spaRVOptions.dataStylesCache))}var vStylesList=_renderOptionInAttr("styles");vStylesList&&spa.isBlank((vStylesList||"").replace(/[^:'\"]/g,""))&&(vStylesList="'"+vStylesList.split(",").join("','")+"'");var vStyles=spa.toJSON(vStylesList||"{}");if($.isEmptyObject(spaRVOptions.dataStyles)||(vStyles=spaRVOptions.dataStyles),_.isArray(vStyles)&&_.remove(vStyles,function(e){return!e}),vStyles&&!$.isEmptyObject(vStyles)){if(_.isArray(vStyles)){spa.console.info("Convert array of style(s) without styleID to object with styleID(s).");var newStylesObj=spa.renderUtils.array2ObjWithKeyPrefix(vStyles,"__styles_",viewContainerId);spa.console.info("Style(s) with styleID(s)."),spa.console.log(newStylesObj),vStyles=_.isEmpty(newStylesObj)?{}:newStylesObj}spa.console.info("External styles to be loaded [cache:"+spaRVOptions.dataStylesCache+"] along with view container ["+viewContainerId+"] => "+JSON.stringify(vStyles));var vStylesNames=_.keys(vStyles),fullStylePath;spa.console.group("spaLoadingStyles"),_.each(vStylesNames,function(e){fullStylePath=_getFullPath4Component(vStyles[e],rCompName),spaAjaxRequestsQue=spa.loadStyle(e,fullStylePath,spaRVOptions.dataStylesCache,spaAjaxRequestsQue)}),spa.console.info("External Styles Loading Status: "+JSON.stringify(spaAjaxRequestsQue)),spa.console.groupEnd("spaLoadingStyles")}else spa.console.info("No styles defined [data-styles] in view container ["+viewContainerId+"] to load.");spa.console.groupEnd("spaLoadingViewStyles"),$.when.apply($,spaAjaxRequestsQue).then(function(){spa.console.group("spaRender["+spaTemplateEngine+"] - spa.renderHistory["+retValue.id+"]"),spa.console.info("Rendering "+viewContainerId+" using master template: "+vTemplate2RenderID);try{var x,N=!1,e=!_renderOption("dataValidate","validate");if(!e){spa.console.info("Validating Data");var a=_renderOption("dataValidate","validate");a&&_.isString(a)&&(a=spa.findSafe(window,a)),e=a&&_.isFunction(a)?a.call(spaTemplateModelData[viewDataModelName],spaTemplateModelData[viewDataModelName]):spa.api.isCallSuccess(spaTemplateModelData[viewDataModelName])}var P=spaTemplateModelData[viewDataModelName];e?$.when.apply($,function _dataPreProcessAsync(){var e,a=_renderOption("dataPreProcessAsync","preProcessAsync");if(a&&_.isString(a)&&(a=spa.findSafe(window,a)),retValue.modelOriginal=$.extend({},P),retValue.model=P,a&&_.isFunction(a)){N=!0;var t=$.extend({},app[rCompName]||{},uOptions||{});e=a.call(t,P),(N=!spa.is(e,"undefined"))||(e=[]),N&&(x=!spa.is(e,"array")||spa.is(e,"array")&&1==e.length,spa.is(e,"array")||(e=[e]))}return e}()).done(function(){var t=Array.prototype.slice.call(arguments);N&&(spa.console.log(rCompName,".dataPreProcessAsync() =>",t.__now()),x&&1<t.length&&"success"==t[1]?(t[0]=spa.toJSON(t[0]),t.splice(1)):_.each(t,function(e,a){e&&spa.is(e,"array")&&1<e.length&&"success"==e[1]&&(t[a]=spa.toJSON(e[0]))}),spa.console.log(t.__now()));var e,a=_renderOption("dataProcess","process");if(a&&_.isString(a)&&(a=spa.findSafe(window,a)),retValue.modelOriginal=$.extend({},P),retValue.model=P,a&&_.isFunction(a)){var n=$.extend({},app[rCompName]||{},uOptions||{});t.unshift(P),e=a.apply(n,t)}else N&&(spa.console.warn(rCompName,".dataPreProcessAsync without dataProcess. Merging responses."),t.unshift(P),_.merge.apply(_,t));if(retValue.model=spa.is(e,"undefined")?P:e,_.isObject(retValue.model)||(retValue.model=retValue.modelOriginal),spa.console.log(rCompName,"Final Template Data:",retValue.model),rCompName){if(is(app,"object")&&app.hasOwnProperty(rCompName)){var r=_.merge({},is(retValue.model,"object")?retValue.model:{_noname:retValue.model});r.hasOwnProperty("spaComponent")?app[rCompName].$data={}:app[rCompName].$data=spaRVOptions.extend$data?_.merge({},spaRVOptions.dataDefaults,spaRVOptions.data_,spaRVOptions.dataExtra,spaRVOptions.dataXtra,spaRVOptions.dataParams,r):{},app[rCompName].__global__=window||{}}retValue.model._this=_.merge({},spa.findSafe(window,"app."+rCompName,{})),retValue.model._this_=_.merge({},spa.components[rCompName]||{},uOptions)}retValue.model._global_=window||{};var s,o=retValue.model,i=($(vTemplate2RenderID).html()||"").replace(/_LINKTAGINTEMPLATE_/g,"link"),p=spaRVOptions.templateScript||spa.defaults.components.templateScript,l=(i=p?i.replace(/_BlockedScript_ src-ref="([^"])*"/g,"script").replace(/_BlockedScript_/g,"script"):i.replace(/<\/_BlockedScript_>/g,"&lt;/_BlockedScript_&gt;")).match(/({\s*\@\$(.*?)\s*})/g);!spaRVOptions.skipDataBind&&l&&_.forEach(l,function(e){i=i.replace(new RegExp(e.replace(/\$/,"\\$"),"g"),e.replace(/{\s*\$this|{\s*\@\$/g,"_global_.app.").replace(/}/,".").replace(/\s/g,"").replace(/\.\./,"."+(rCompName||"")+"."))});var c,d,u=i.match(/({\s*\$(.*?)\s*})/g);if(!spaRVOptions.skipDataBind&&u&&_.forEach(u,function(e){i=i.replace(new RegExp(e.replace(/\$/,"\\$"),"g"),e.replace(/{\s*\$this|{\s*\$/g,"app.").replace(/}/,".").replace(/\s/g,"").replace(/\.\./,"."+(rCompName||"")+"."))}),s=i,spa.console.log("Template Source:",i),spa.console.log("DATA for Template:",o),!spa.isBlank(o))if(spaRVOptions.skipDataBind)spa.console.log("Skipped Data Binding.");else{if(spaRVOptions.dataTemplatesCache||(delete spa.compiledTemplates4DataBind[rCompName],delete spa.compiledTemplates[rCompName]),!spa.compiledTemplates4DataBind.hasOwnProperty(rCompName)&&/ data-bind\s*=/i.test(i)){i=_maskHandlebars(i),spa.console.log("TemplateBeforeBind",i);var f=is(o,"object")?_.merge({},spaRVOptions.dataDefaults,spaRVOptions.data_,spaRVOptions.dataExtra,spaRVOptions.dataXtra,spaRVOptions.dataParams,o):o;spa.console.log("SPA built-in binding ... ...",f),i=_unmaskHandlebars(i=spa.bindData(i,f,"$"+rCompName)),spa.console.log("TemplateAfterBind",i),spa.compiledTemplates4DataBind.hasOwnProperty(rCompName)||(spa.compiledTemplates4DataBind[rCompName]={}),c=!0}if(0<=spaTemplateEngine.indexOf("handlebar")||0<=spaTemplateEngine.indexOf("{"))if("undefined"!=typeof Handlebars&&Handlebars){spa.console.log("Data bind using handlebars.js.",i);try{var m=spa.compiledTemplates[rCompName]||Handlebars.compile(i),g=is(o,"object")?_.merge({},retValue,spaRVOptions.dataDefaults,spaRVOptions.data_,spaRVOptions.dataExtra,spaRVOptions.dataXtra,spaRVOptions.dataParams,o):o;d=g,spa.compiledTemplates.hasOwnProperty(rCompName)||(spa.compiledTemplates[rCompName]=m),s=m(g),spa.console.log(s)}catch(e){console.error("Error in Template",e)}}else spa.console.error("handlebars.js is not loaded.")}spa.console.log("Template Compiled:",s),doDeepRender=!1,retValue.view=s.replace(/\_\{/g,"{{").replace(/\}\_/g,"}}");var h=rCompName?_.merge({},app[rCompName]||{},{__prop__:_.merge({},uOptions||{})}):{};h.__prop__&&h.__prop__.data&&(delete h.__prop__.data._global_,delete h.__prop__.data._this_,delete h.__prop__.data._this),retValue.model&&(delete retValue.model._global_,delete retValue.model._this_,delete retValue.model._this),spa.renderUtils.runCallbackFn(spa.defaults.components.render,O,h);var y,v,b,S=_renderOption("dataBeforeRender","beforeRender");if(S){var O={template:i,data:retValue.model,view:retValue.view};if(y=spa.renderUtils.runCallbackFn(S,O,h),!spa.is(y,"undefined"))switch(spa.of(y)){case"string":retValue.view=y;break;case"boolean":v=!y}}if(b=retValue.view.beginsWithStr("\x3c!----\x3e"),v)retValue={},spa.console.warn("Render aborted by "+S);else if(!b){var C=$viewContainerId.attr("data-rendered-component");C&&!spa.removeComponent(C,rCompName)&&(v=!0,retValue={},spa.console.warn("Render $"+rCompName+" aborted by $"+C+".onRemove()"))}if(!v){if(b)spa.console.log("Rendering component [",rCompName,"] view aborted.");else{var T=_renderOption("dataRenderType","renderType");switch(spa.console.log("Injecting component in DOM (",viewContainerId,")."+(T||"html")),T){case"value":$(viewContainerId).val(retValue.view);break;case"text":$(viewContainerId).text(retValue.view);break;default:switch(doDeepRender=!0){case targetRenderMode.equalsIgnoreCase("append"):$(viewContainerId).append(retValue.view);break;case targetRenderMode.equalsIgnoreCase("prepend"):$(viewContainerId).prepend(retValue.view);break;default:$(viewContainerId).html(retValue.view)}}}$(viewContainerId).attr("data-rendered-component",rCompName).data("renderedComponent",rCompName),_$renderCountUpdate(rCompName),spa.console.info("Render: SUCCESS");var w=_.keys(spa.renderHistory),k=w.length;if(k>spa.renderHistoryMax&&$.each(w.splice(0,k-spa.renderHistoryMax),function(e,a){delete spa.renderHistory[a]}),retValue.cron=""+spa.now(),0<spa.renderHistoryMax&&(spa.renderHistory[retValue.id]=retValue),doDeepRender&&!b&&(spa.renderUtils.registerComponentEvents(rCompName),$(viewContainerId).find(".lang-icon,.lang-text,[data-i18n-lang]").length&&spa.i18n.displayLang(),_init_SPA_DOM_(viewContainerId),c||spa.dataBind(viewContainerId,d,"",!0),spa.i18n.apply(viewContainerId),_routeReloadUrl(rCompName)))return retValue;spa.console.log(retValue);var A=_renderOptionInAttr("renderCallback");spaRVOptions.dataRenderCallback&&(A=spaRVOptions.dataRenderCallback);var R=_.isString(A)&&A.equalsIgnoreCase("off");spa.console.info("Processing callback: "+A),R||spa.renderUtils.runCallbackFn(A,retValue),spa.renderUtils.runCallbackFn(spa.defaults.components.callback,retValue,h),doDeepRender&&!b&&($(viewContainerId).find("[rel='spaRender'],[data-render],[data-sparender],[data-spa-render]").spaRender(),spa.renderComponentsInHtml(viewContainerId,rCompName))}}):spa.is(app.api.onResError,"function")?app.api.onResError(spaTemplateModelData[viewDataModelName],"Invalid-Data",void 0):spa.api.onResError(spaTemplateModelData[viewDataModelName],"Invalid-Data",void 0)}catch(e){console.error(e)}spa.console.groupEnd("spaRender["+spaTemplateEngine+"] - spa.renderHistory["+retValue.id+"]")}).fail(function(){console.error("External Data|Template|Style|Script Loading failed! Unexpected!! Check the template Path / Network. Rendering aborted.")})}else spa.console.error("No templates defined [data-templates] in view container ["+viewContainerId+"] to render. Check HTML markup.");spa.console.groupEnd("spaView")}},function _onScriptsLoadFailed(){console.error("External Scripts Loading Failed! Unexpected!? Check the Script Path/Network.")}),retValue}if(uOptions=_.merge({},viewContainerId),uOptions.hasOwnProperty("target"))viewContainerId=uOptions.target,delete uOptions.target;else{var oldTarget=$('[data-rendered-component="'+uOptions.componentName+'"]').attr("id");viewContainerId=(oldTarget?"#":"")+oldTarget,viewContainerId||(spa.console.warn("Render target is missing."),viewContainerId="dynRender_"+spa.now()+"_"+spa.rand(1e3,9999))}spa.render(viewContainerId,uOptions)}function _fixRefreshCalls(e,a,t){spa.is(spaRVOptions[e],"string")&&spaRVOptions[e]=="app."+rCompName+a&&app[rCompName].hasOwnProperty(t)&&(spaRVOptions[e]="app."+rCompName+"."+t)}},spa.initElementsIn=_initSpaElements,spa.setElIdIfNot=function(e){var a=$(e);return spa.isBlank(a.attr("id"))&&a.attr("id","_el_"+spa.now()+"_"+spa.rand(1e3,9999)),a.attr("id")},spa.Foundation={autoReflow:!1},spa.reflowFoundation=function(e){"Foundation"in window&&spa.Foundation.autoReflow&&$(e||document).foundation("reflow")},$.expr[":"].regex=function(e,a,t){var n=t[3].split(","),r=/^(data|css):/,s={method:n[0].match(r)?n[0].split(":")[0]:"attr",property:n.shift().replace(r,"")};return new RegExp(n.join("").replace(/^\s+|\s+$/g,""),"ig").test($(e)[s.method](s.property))},$.fn.extend({spaRender:function(e){this.each(function(){__renderView(this,e)})}}),$.extend({spaRender:function(e,a){$(e).spaRender(a)}}),$.fn.extend({renameAttr:function(e,a){return this.each(function(){this.setAttribute(a,this.getAttribute(e)),this.removeAttribute(e)}),this},spa$:function(){return this.map(function(){return $(this).closest("[data-rendered-component]")})},spa$name:function(){var e=this.map(function(){return $(this).closest("[data-rendered-component]").attr("data-rendered-component")});return 1==e.length?e[0]:e},spaBindData:function(e,a){return spa.bindData(this,e,a)},inBlockedSpaNavContainer:function(){return!!this.closest(_blockNavClass).length},blockNav:function(){return _blockSpaNavigation(this),this},allowNav:function(){return _allowSpaNavigation(this),this},isNavBlocked:function(){return _isSpaNavBlocked(this)},isNavAllowed:function(){return _isSpaNavAllowed(this)},disable:function(e){return e||spa.is(e,"undefined")?this.css("pointer-events","none").addClass("disabled").attr("disabled","disabled"):this.enable(!0)},enable:function(e){return e||spa.is(e,"undefined")?this.css("pointer-events","auto").removeClass("disabled").removeAttr("disabled"):this.disable(!0)},value:function(e,a){return spa.is(e,"undefined")?this.val():(this.each(function(){$(this).val(e).trigger(a||"change")}),this)},htm:function(e){return spa.is(e,"undefined")?this.html():(this.each(function(){$(this).html(spa.sanitizeScript(e))}),this)},dataJSON:function(e,a,t){var n;if(arguments.length){if(n=spa.toJSON(this.data(e)),n=spa.is(n,"object")?n:{},!spa.is(a,"undefined")){n=t?a:_.merge(n,a);var r=JSON.stringify(n),s=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();this.attr("data-"+s,r).data(e,r)}}else n=this.data();return n},isDisabled:function(e){var a=this.hasClass("disabled")||this.is("[disabled]");return a&&e&&e.call(this,this),a},isEnabled:function(e){var a=!this.isDisabled();return a&&e&&e.call(this,this),a},trackChanges:function(){spa.trackFormElChange(this)},isChanged:function(e){var a="ALL"==(e=(e||"ANY").toUpperCase()),t=!a,n=!1,r=this;if(r.length)for(var s=0;s<r.length;s++){var o=r[s].tagName.toUpperCase();if("FORM"==o)n=$(r[s]).find("input,textarea,select").isChanged(e);else if(0<"/INPUT/TEXTAREA/SELECT/".indexOf(o)){if(n=spa.isElValueChanged(r[s]),t&&n)break;if(a&&!n)break}}return n},initSpaRoutes:function(){_initRouteHash(this)},initFormValidation:function(){var e=this.filter("form");if(!e.length)return"Form Not Found";e.each(function(e,a){_initFormValidation(a)})},validateForm:function(e,a,t){var n,r=this;if(1<r.length)n=[{errcode:1,errmsg:"Too many forms to validate."}];else if(1==r.length){var s="#"+r.attr("id");if("FORM"==(r.prop("tagName")||"").toUpperCase())if(spa.is(e,"string")){var o=r.find(e).map(function(){return this.id}).get().join();n=spa.validateForm(s,o,a,t)}else n=spa.validateForm(s,e,a);else n=[{errcode:1,errmsg:"NOT a FORM"}]}else n=[{errcode:1,errmsg:"Form Not Found."}];return n},updateValidation:function(t,n){this.each(function(e,a){spa._validate._showValidateMsg(a,n,t)})},updateValidationPromise:function(e,a,t){spa.updateValidationPromise(e,this,t,a)}}),spa.initDataValidation=function(){spa.console.log("include validate framework lib (spa-validate.js) to use this feature!")},spa.doDataValidation=function(){spa.console.log("include validate framework lib (spa-validate.js) to use this feature!")},spa.properties={version:spa.VERSION},spa.api={baseUrl:"",liveUrlSuffix:"",urls:{},mock:!1,mockBaseUrl:"",mockRootFolder:"api_",defaultPayload:!1,forceParamValuesInMockUrls:!1,urlKeyIndicator:"@",url:function(e,a){e=(e||"").trimLeftStr(spa.api.urlKeyIndicator),a=a||{};var t,n,r=spa.api.urls[e]||e,s=r.beginsWithStr("!")||spa.api.mock||app.api.mock,o=r.beginsWithStr("!!")||r.beginsWithStr("~")||spa.api.forceParamValuesInMockUrls,i=_.uniq(r.extractStrBetweenIn("{","}"));return spa.isBlank(i)||_.each(i,function(e){(t=e.replace(/[{}<>]/g,""))&&(n=spa.findSafe(a,t,a._undefined),n=s&&!o?e.containsStr(">")?n:"_"+t:n,r=r.replace(new RegExp(e.replace(/([^a-zA-Z0-9])/g,"\\$1"),"g"),n))}),r},success:function(e){return[e,"success"]},isCallSuccess:function(){return!0},onReqError:function(e,a,t){spa.console.error([e,a,t]),spa.console.error($(e.responseText).text())},onResError:function(){},_call:function(n){var e=spa.findSafe(window,"app.api.ajaxOptions",{}),a=spa.is(n,"object")&&n.hasOwnProperty("error")?n.error:app.api.onError||spa.api.onReqError;if((n=$.extend({},e,n,{error:a,success:function(e,a,t){e=_.isString(e)&&"html"!=String(this.dataType).toLowerCase()?spa.toJSON(e):e,spa.api.isCallSuccess(e)?n._success.call(this,e,a,t):spa.is(app.api.onResError,"function")?app.api.onResError.call(this,e,a,t):spa.api.onResError.call(this,e,a,t)}})).dataType||(n.dataType="text"),"json".equalsIgnoreCase(n.dataType)&&!n.contentType&&(n.contentType="application/json"),n.data&&spa.is(n.data,"object")&&n.stringifyPayload&&(delete n.stringifyPayload,n.data=JSON.stringify(n.data)),n.defaultPayload){var t=spa.of(n.data),r=n.defaultPayload,s=spa.is(r,"function")?r(o):spa.is(r,"object")?_.merge({},r):r,o="string"==t?spa.toJSON(n.data):n.data;if(spa.is(s,"object")){var i=spa.is(o,"object")?_.merge({},s,o):s;spa.isBlank(i)||"string"!=t||(i=JSON.stringify(i)),n.data=i}}return n.url.beginsWithStr(spa.api.urlKeyIndicator)&&(n.url=spa.api.url(n.url.trimLeftStr(spa.api.urlKeyIndicator),n.data)),(app.debug||spa.debug)&&console.info(["API(ajax) call with options",n]),$.ajax(n)},_params2AxOptions:function(){var a,t,n,r,s={method:"GET",url:"",data:{},_success:function(){},async:!0};return _.each(arguments,function(e){switch(!0){case _.isString(e):a="url",s.url&&(t=!0,a="data");break;case spa.is(e,"function"):a=r?"error":(r=!0,"_success");break;case _.isBoolean(e):a="async";break;case _.isObject(e):t||e.__hasPrimaryKeys("ajaxOptions|dataUrlParams")?(a="axOptions",n=e.hasOwnProperty("ajaxOptions")?e.ajaxOptions:e):(a="data",t=!0);break;default:a="unknown"}"axOptions"!=a&&(s[a]=e)}),n&&(n.dataUrlParams&&((""+s.url).beginsWithStr(spa.api.urlKeyIndicator)&&(s.url=spa.api.url(s.url.trimLeftStr(spa.api.urlKeyIndicator),n.dataUrlParams)),delete n.dataUrlParams),_.merge(s,n)),spa.console.log("API ajax options >>"),spa.console.log(s),s},get:function(){return spa.api._call(spa.api._params2AxOptions.apply(void 0,arguments))},post:function(){return spa.api._call($.extend(spa.api._params2AxOptions.apply(void 0,arguments),{method:"POST"}))},put:function(){return spa.api._call($.extend(spa.api._params2AxOptions.apply(void 0,arguments),{method:"PUT"}))},del:function(){return spa.api._call($.extend(spa.api._params2AxOptions.apply(void 0,arguments),{method:"DELETE"}))},mix:function(){for(var e=[],a=arguments[arguments.length-1],t=0;t<arguments.length;t++)spa.is(arguments[t],"array")?e=e.concat(arguments[t]):spa.is(arguments[t],"function")||e.push(arguments[t]);return $.when.apply($,e).done(function(){var t=Array.prototype.slice.call(arguments);1==e.length&&1<t.length&&"success"==t[1]?(t[0]=spa.toJSON(t[0]),t.splice(1)):_.each(t,function(e,a){e&&spa.is(e,"array")&&1<e.length&&"success"==e[1]&&(t[a]=spa.toJSON(e[0]))}),a&&spa.is(a,"function")&&a.apply(void 0,t)})}},spa.i18n.onLangChange,spa.i18n.displayLang=function(){var e=$("html").attr("lang");if(e){var a=e,t=e.replace("-","_"),n=$('[data-i18n-lang="'+a+'"],[data-i18n-lang="'+t+'"]'),r=($("body").attr("i18n-lang-key-prefix")||"lang.name.")+t,s="-";$(".lang-text").attr("data-i18n",r).data("i18n",r),$("[data-i18n-lang]").removeClass("active"),n.length&&(n.addClass("active"),s=($(n[0]).data("i18nLang")||"").replace(/[a-z]/gi,""),$(".lang-icon").removeClass(Array.prototype.join.call($("[data-i18n-lang]").map(function(e,a){return $(a).data("i18nLang")})," "))),$(".lang-icon").addClass("-"==s?a:t),spa.i18n.apply(".lang-text")}return e},spa.ajax=_ajax,spa.mockSysTest=_mockSysTest;var _PubSubQue={},_PubSub={pub:function(t,e,n,r){var s,o;spa.is(e,"function")?(r=n,n=e):s=e;var i,p,l=0,c=[];return _.each(_PubSubQue[t],function(a){try{l++,i=a.fn,p=null,i&&(p=i.call(s||{},t,s,n,r)),c.push({id:""+(a.name||l),response:p}),!o&&spa.is(p,"boolean")&&(o=!p)}catch(e){console.warn("Execution error in subscribed function:"+a.name+" on-"+t),console.error(e.stack)}}),o?r&&spa.is(r,"function")&&r(c):n&&spa.is(n,"function")&&n(c),c},sub:function(e,a,t){return _PubSubQue.hasOwnProperty(e)||(_PubSubQue[e]=[]),_PubSubQue[e].push({fn:a,name:t}),_PubSubQue[e].length},unSub:function(e,a){var t=!1;return _PubSubQue.hasOwnProperty(e)&&(t=!0,a?_PubSubQue[e][a-1]=null:_PubSubQue[e]=[]),t}};spa.event={on:_PubSub.sub,off:_PubSub.unSub,trigger:_PubSub.pub,announce:_PubSub.pub};var _urlHashBase="#",_blockNav,_hideNavClassName="",_hideNav,_onAutoRoute=!0,_autoRoutesFound=[],_maxAutoRoute=100,_routeOnClick=!1,_prevUrlHash="",_curBlockedUrlHash="",_isDelayed=!1,_isDelayedOnUrl="",_lastBlockedUrl="",_blockNavClassName="",_blockNavClass="",_allowNavClassName="",_attrSpaRoute="",_attrSpaRouteParams="",_routeByHref=!1,_attrOnNavAway="";function _initAutoRoute(){_autoRoutesFound=[],_maxAutoRoute=50}function _initRoutesDefaults(){_prevUrlHash=spa.urlHashFull(_urlHashBase),_urlHashBase=(spa.findSafe(spa,"defaults.routes.base","")||"#").trim(),_blockNavClassName=(spa.findSafe(spa,"defaults.routes.className.block","")||"BLOCK-SPA-NAV").trim(),_blockNavClass="."+_blockNavClassName,_allowNavClassName=(spa.findSafe(spa,"defaults.routes.className.allow","")||"ALLOW-SPA-NAV").trim(),_hideNavClassName=(spa.findSafe(spa,"defaults.routes.className.hide","")||"HIDE-SPA-NAV").trim(),_attrSpaRoute=(spa.findSafe(spa,"defaults.routes.attr.route","")||"data-spa-route").trim(),_attrSpaRouteParams=(spa.findSafe(spa,"defaults.routes.attr.params","")||"data-spa-route-params").trim(),_routeByHref=_attrSpaRoute.equalsIgnoreCase("href"),_attrOnNavAway=(spa.findSafe(spa,"defaults.routes.attr.onNavAway","")||"onNavAway").trim(),_hideNav=$("body").hasClass(_hideNavClassName)}function _blockSpaNavigation(e){var a=$(e||"body :first");return a.addClass(_blockNavClassName),_blockNav=_isSpaNavBlocked()||!0,a}function _allowSpaNavigation(e){var a=$(e||_blockNavClass);return a.removeClass(_blockNavClassName),a.find(_blockNavClass).removeClass(_blockNavClassName),_blockNav=_isSpaNavBlocked(),a}function _isToShowSpaNav(){return!_hideNav}function _isSpaNavBlocked(e){if(e){var a=$(e);return a.hasClass(_blockNavClassName)||0<a.find(_blockNavClass).length}return!!$(_blockNavClass).length}function _isSpaNavAllowed(e){return!_isSpaNavBlocked(e)}function _inBlockedSpaNavContainer(e){return!!$(e).closest(_blockNavClass).length}function _blockBrowserNav(){_blockNav&&_replaceUrlHash(_prevUrlHash)}function _onpageshow(){_blockBrowserNav()}var _skipUrlChangeOn="x"+spa.now();function _onPopStateChange(e){_routeSpaUrlOnHashChange(),_curBlockedUrlHash=_curBlockedUrlHash&&_curBlockedUrlHash!=_skipUrlChangeOn?(spa.console.warn("Blocked:",_curBlockedUrlHash),_skipUrlChangeOn):(_curBlockedUrlHash!=_skipUrlChangeOn&&(spa.onUrlHashChange?spa.onUrlHashChange(spa.urlHash([],_urlHashBase),e):spa.onUrlChange&&spa.onUrlChange(spa.urlHash([],_urlHashBase),e)),"")}function _onWindowReload(){var e,a;switch(spa.onReload&&(e=spa.onReload()),spa.of(e)){case"boolean":if(!e)return a="spa.message.on.window.reload",spa.i18n.text(a).replace(a,"");break;case"string":return(e=e.trim())&&(a=e.beginsWithIgnoreCase("i18n")?e.replace(/i18n(:)*/i,""):"")?spa.i18n.text(a).replace(a):e;default:if(a="spa.message.on.window.reload",_blockNav)return spa.i18n.text(a).replace(a,"")}}function _handleNavAwayEvent(e,a){var t,n,r,s,o,i;_lastBlockedUrl=e,spa.console.log("Trying to navigate away from:["+_prevUrlHash+"] To:["+e+"] by",a),$(_blockNavClass).each(function(){t=$(this),"#"==(n=(t.attr(_attrOnNavAway)||"").trim())[0]||">"==n[0]?(r=">"==n[0]?n.substr(1).trim():n,(s=t.find(r).filter(":not(.disabled):not(:disabled)")).length&&(a&&(i="id:'"+a.attr("id")+"', spaRoute:'"+a.attr(_attrSpaRoute)+"'"),s.data("navToUrl",e).attr("data-nav-to-url",e),s.data("navBy",i).attr("data-nav-by",i),s.trigger("click"))):(o=spa.findSafe(window,n.split("(")[0].split(";")[0]))&&spa.is(o,"function")&&o.call(t,e,t,a)})}function _ctrlBrwowserNav(){window.onpageshow=_onpageshow,window.onpopstate=_onPopStateChange,is(window,"window")&&(window.onbeforeunload=_onWindowReload)}function _routeSpaUrlOnHashChange(){var e=spa.urlHashFull(_urlHashBase);spa.console.log("on Hash Change: Url To [",e,"] from[",_prevUrlHash,"] on click:",_routeOnClick," block-Navigation:",_blockNav,"isDelayed:",_isDelayed),!_isToShowSpaNav||!_routeOnClick&&_blockNav?(spa.console.log("-------------\x3e",_prevUrlHash,e,_isDelayed,_isDelayedOnUrl),spa.console.log("lastBlocked:",_lastBlockedUrl),_lastBlockedUrl=_lastBlockedUrl||_prevUrlHash,"#"==_urlHashBase[0]?(_replaceUrlHash(_isDelayed?_isDelayedOnUrl:_prevUrlHash,e),_lastBlockedUrl==e&&_handleNavAwayEvent(e)):(_replaceUrlHash(_isDelayed?_isDelayedOnUrl:_prevUrlHash,e),_handleNavAwayEvent(e))):(spa.console.log("Triggering next hash... by href:",_routeByHref,"autoRoute:",_onAutoRoute,"byClick",_routeOnClick),_triggerNextHash(_onAutoRoute||!_routeOnClick))}spa.blockNav=_blockSpaNavigation,spa.allowNav=_allowSpaNavigation,spa.isNavBlocked=_isSpaNavBlocked,spa.isNavAllowed=_isSpaNavAllowed,spa.isToShowNav=_isToShowSpaNav,spa.isInBlockedSpaNavContainer=_inBlockedSpaNavContainer,window.onerror=function(e,a,t){console.warn("Invalid Content: Check the network/path/content.",e,a,t)};var _dynHashProcessed=[];function _processDynHash(e,a){var t=0<=e.indexOf(":"),n=a;if(spa.is(a,"boolean")&&(n=a?"click":""),t){var r,s,o=t?e.split(":")[0]:"",i={},p=0<e.indexOf("&")?e.split("&"):0<e.indexOf(",")?e.split(","):[e];_.each(p,function(e){r=e.split(":")[0],s=e.getRightStr(":"),i[r]=decodeURIComponent(s)});var l=$("["+_attrSpaRoute+'*="/'+o+':"]['+_attrSpaRouteParams+"]"),c=(l.attr(_attrSpaRouteParams)||"").trim();if(t=!spa.isBlank(c)){_dynHashProcessed.push(e);var d=spa.toJSON(c);_.each(d,function(e,a){if(e=e.trim(),/(^app\.(.)+\.)|(^\$)|(^\#)/.test(e))spa.setElValue(e,i[a]);else if(/^fn:/i.test(e)){var t=e.split(" ")[0].getRightStr(":").trim().split("(")[0];(t=t?spa.findSafe(window,t):"")&&spa.is(t,"function")?t(a,i[a]):console.warn("Not a function",e)}}),n&&l.isEnabled()&&!l.hasClass("AUTO-ROUTING")&&l.trigger(n)}}return t}function _processDynHashInUrl(){for(var e,a=spa.urlHash([],_urlHashBase),t="",n=0;n<a.length;n++)t=a[n],0<=(e=_dynHashProcessed.indexOf(t))?_dynHashProcessed.splice(e,1):_processDynHash(t,n==a.length-1)}function _triggerNextHash(e){e&&_initAutoRoute(),_onAutoRoute=spa.is(e,"undefined")?_onAutoRoute:e;var a,t,n,r=spa.urlHash([],_urlHashBase),s=r.length-1;if(_maxAutoRoute<0&&(_onAutoRoute=!1),_onAutoRoute){_maxAutoRoute--;for(var o=s;0<=o&&(n=r[o-1]||"",_onAutoRoute&&0<n.indexOf(":")&&!_autoRoutesFound.__has(n)&&o--,a=r[o],t=o==s,_onAutoRoute&&!_autoRoutesFound.__has(a));o--)if(a){var i=0<=a.indexOf(":"),p=i?a.split(":")[0]:"",l="["+_attrSpaRoute+'$="/'+a+'"]:not(:disabled):not(.disabled):not(.AUTO-ROUTING):first';i&&(l="["+_attrSpaRoute+'*="/'+p+':"]['+_attrSpaRouteParams+"]");var c=$(l);if(c.length){if(i=i&&_processDynHash(a),_autoRoutesFound.push(a),_onAutoRoute=!t,c.isEnabled()&&!c.hasClass("AUTO-ROUTING")&&c.addClass("AUTO-ROUTING").trigger(c.data("routeEvent")||"click"),t){_winLocHash_="";break}o+=2}}}_routeOnClick=!1}function _updateBrowserAddress(e,a){spa.console.log("_updateBrowserAddress >>>>>>>>>[",e,"]delay:",a,"prev:",_prevUrlHash);var t="#"==_urlHashBase[0];if(e)if(_prevUrlHash=e,t){spa.console.log(e);var n=$("#_spaRouteLink_");n.length||(n=$('<a id="_spaRouteLink_" href=""></a>'),$("body").append(n)),spa.console.log("################# "+e),n.attr("href",e)[0].click()}else spa.console.log(e),"#"!=(e=e.trimLeftStr("/"))[0]&&(e="//"+window.location.host+_getAboluteUrl("/",e),spa.console.log("updating the address bar with >>>>>",e)),spa.console.log(">>>>>>>>>>>>>>>>> "+e),history.pushState(null,null,e)}function _replaceUrlHash(e,a){e!=a&&(spa.console.log("attempt to set URL:",e,"insteadOf",a),_curBlockedUrlHash=a,_updateBrowserAddress(e))}function _updateUrlHash(e,a,t){spa.console.log("Updating url with:",e,"delay:",a,"autoRoute:",t),_onAutoRoute=t,_isDelayedOnUrl=(_isDelayed=a)?_prevUrlHash:"",a?_prevUrlHash=e:(_routeOnClick=!0,spa.isToShowNav()?_onAutoRoute||_updateBrowserAddress(e,a):_prevUrlHash=e)}function _getNewMatchingRoutes(e){if(!(e=(e||"").trim()))return[];var a=spa.urlHash([],_urlHashBase),t=e.trimStr("/").split("/"),n=[],r=t[0];function getMatchHash(e,a){var t=a,n=a.getLeftStr("*");if(n)for(var r=0;r<e.length;r++)if(e[r].beginsWithStr(n)){t=e[r];break}return t}var s=a.indexOf(r);if(0<r.indexOf("*")){r=r.getLeftStr("*");for(var o=0;o<a.length;o++)if(a[o].beginsWithStr(r)){s=o;break}}if(0<=s){for(var i,p=a.splice(s),l=0;l<t.length;l++)i=t[l].indexOf("*"),n[l]=i<0?t[l]:i?getMatchHash(p,t[l]):p[l];n=a.concat(n)}else n="/"==e[0]?t:a.concat(t);return n}function _onRouteElClick(e){var spaRoutePath=spa.urlHash([],_urlHashBase),$routeEl=$(this),routeData,usePrevHash,delayUpdate,routeDir,routeName,newHashUrl,continueAutoRoute,elClick=$routeEl.attr("onrouteclick");if($routeEl.hasClass("disabled")||$routeEl.is(":disabled"))return e.stopImmediatePropagation(),e.stopPropagation(),void e.preventDefault();function update(e,a){"#"==(routeData=(e||"").trim())[0]&&(routeData=routeData.substr(1)),usePrevHash="<"==routeData[0],delayUpdate=">"==routeData[0],routeDir=a||routeData[delayUpdate?1:0],routeName=routeData.substr(delayUpdate?2:1),continueAutoRoute=!1}"#"!=_urlHashBase[0]&&e.preventDefault(),update($routeEl.attr(_attrSpaRoute),$routeEl.attr("data-route-dir"));var routeStoreSpec=($routeEl.attr(_attrSpaRouteParams)||"").trim();if(routeStoreSpec){var routeStoreSpecObj=spa.toJSON(routeStoreSpec),paramValue;_.each(routeStoreSpecObj,function(e,a){if(/(^app\.(.)+\.)|(^\$)|(^\#)/.test((paramValue=e).trim()))paramValue=spa.getElValue(e);else if(/^fn:/i.test(e.trim())){var t=e.split(" ")[0].getRightStr(":").trim().split("(")[0];(t=t?spa.findSafe(window,t):"")&&spa.is(t,"function")?paramValue=t(a):console.warn("Not a function",e)}routeName=routeName.replace(new RegExp(a+":","g"),a+":"+encodeURIComponent(paramValue))})}if(elClick&&eval(elClick),$routeEl.hasClass("AUTO-ROUTING"))$routeEl.removeClass("AUTO-ROUTING");else{switch("^"==routeDir&&(spa.isBlank(spaRoutePath)?update(routeData.substr(1)):(e.preventDefault(),continueAutoRoute=!0,routeDir="/",routeName=spa.urlHash("",_urlHashBase))),"#/-<>".indexOf(routeDir)<0&&(routeName=routeDir+routeName,routeDir="?"),routeDir){case"#":case"/":spaRoutePath=_getNewMatchingRoutes(routeName);break;case"-":var revCount=spa.toInt(routeName.replace(/[^0-9]/g,""))||1;spaRoutePath.length&&(spaRoutePath.length=spaRoutePath.length-revCount);break;case"<":newHashUrl=_prevUrlHash;break;case"?":spaRoutePath=_getNewMatchingRoutes(routeName)}usePrevHash||(newHashUrl=_getAboluteUrl(_urlHashBase,spaRoutePath.join("/"))),_blockNav&&(usePrevHash||$routeEl.hasClass(_allowNavClassName)||$routeEl.inBlockedSpaNavContainer()||(delayUpdate=!0,_handleNavAwayEvent(newHashUrl,$routeEl))),spa.console.log("Routing to...",newHashUrl,"delay:",delayUpdate,"prev:",_prevUrlHash),_updateUrlHash(newHashUrl,delayUpdate,continueAutoRoute)}}function _onRouteAutoReg(){spa.route(this.getAttribute(_attrSpaRoute+"-AUTO").substr(1))}function _initRouteHash(e){$(e||"body").find("["+_attrSpaRoute+'^="*"]:not(.ROUTE):not(.ROUTE-AUTO)').renameAttr(_attrSpaRoute,_attrSpaRoute+"-AUTO").addClass("ROUTE-AUTO").on("click",_onRouteAutoReg);var a,t,n,r=$(e||"body").find("["+_attrSpaRoute+"]:not(.ROUTE)").renameAttr("onclick","onRouteClick").addClass("ROUTE").off("click",_onRouteElClick).on("click",_onRouteElClick);_routeByHref&&r.length&&r.each(function(){a=$(this),t=a.attr("href").replace(/\s*/g,"").trim(),n="","#"==t[0]?0<="^><-".indexOf(t[1])&&(n=t[1],t=t.substr(2)):0<="^".indexOf(t[0])&&(n=t[0],t=t.substr(1)),a.attr("href","#"+t).removeAttr("target").attr("data-route-dir",n)});_triggerNextHash(),_blockNav=spa.isNavBlocked()}function _routeToUrl(e){if(e=(e||"").trim()){var a,t,n=e[0],r=1;switch("#/-<>".indexOf(n)<0&&(n="?",r=0),a=e.substr(r),n){case"/":t=_getNewMatchingRoutes(a);break;case"-":t=spa.urlHash([],_urlHashBase);var s=spa.toInt(e.replace(/[^0-9]/g,""))||1;t.length&&(t.length=t.length-s);break;case"?":t=_getNewMatchingRoutes(a);break;default:t=[a]}return _getAboluteUrl(_urlHashBase,t.join("/"))}}function _$routeElement(e){return $("["+_attrSpaRoute+'$="'+e.trim()+'"].ROUTE:first')}function _$routeElements(e){return $("["+_attrSpaRoute+'$="'+e.trim()+'"].ROUTE')}function _routeNewUrl(e,a){var t=_routeToUrl(e);if(spa.console.log("Route:",e,"URL:",t),t)if(!a&&_blockNav)_handleNavAwayEvent(t);else{var n=_$routeElement(e);n.length?n.hasClass("disabled")||n.is("[disabled]")?console.warn("Route:",e,"is disabled."):n.click():(_isToShowSpaNav()?_updateBrowserAddress(t):_winLocHash_=t,"/"==e.trim()?(spa.allowNav(),window.location.reload()):_onPopStateChange())}}function _StoreMgmt(r){function _set(a,e){function _store(e,a){r.setItem(""+e,JSON.stringify(a))}1==arguments.length?_type(a,"object")?Object.keys(a).forEach(function(e){_store(e,a[e])}):_type(a,"array")&&a.forEach(function(e,a){_store(a,e)}):2==arguments.length&&_store(a,e)}function _get(e){return 0==arguments.length?_all():1!=arguments.length?_all.apply(null,arguments):_type(e,"string")?0<e.indexOf(",")?_all.apply(null,e.split(",")):JSON.parse(r.getItem(e)):_type(e,"array")?_all.apply(null,e):void 0}function _all(){var a=arguments.length,t=Array.prototype.slice.call(arguments).map(function(e){return(""+e).trim()}),n={};return Object.keys(r).forEach(function(e){(!a||-1<t.indexOf(e))&&(n[e]=_get(e))}),n}function _clear(){if(arguments.length){var a=Array.prototype.slice.call(arguments).map(function(e){return(""+e).trim()});Object.keys(r).forEach(function(e){a.indexOf(e)<0&&r.removeItem(e)})}else r.clear()}function _type(e,a){var t=Object.prototype.toString.call(e).split(" ")[1].toLowerCase().replace(/\]$/gi,"");return 2==arguments.length?-1<(""+a).toLowerCase().indexOf(t):t}function qP(e,a){return 0==arguments.length?_all():1==arguments.length?_type(e,"object|array")?(_set(e),e):_get(e):2==arguments.length?(_set(e,a),_get(e)):void 0}return qP.set=_set,qP.get=_get,qP.getAll=_all,qP.remove=function _remove(e){function _removeItems(){arguments.length&&Array.prototype.slice.call(arguments).forEach(function(e){r.removeItem(e)})}0==arguments.length?_clear():1==arguments.length?_type(e,"string")?0<e.indexOf(",")?_removeItems.apply(null,e.split(",")):function _removeItem(e){r.removeItem(e)}(e):_type(e,"array")&&_removeItems.apply(null,e):_removeItems.apply(null,arguments)},qP.removeAll=_clear,qP.removeExcept=_clear,qP.clear=_clear,qP.clearExcept=_clear,qP}spa.parseRoutes=_getNewMatchingRoutes;try{spa.sesStore=_StoreMgmt(sessionStorage)}catch(e){console.warn("No Access to sessionStorage.",e)}try{spa.locStore=_StoreMgmt(localStorage)}catch(e){console.warn("No Access to localStorage.",e)}function _routeReloadUrl(e){var a=(spa.sesStore.get("_spaReloadUrl")||"").trim();if(!e||0==a.indexOf(e))return a?(spa.sesStore.remove("_spaReloadUrl"),a=a.replace(/.*#/gi,""),spa.route(a,!0),!0):void 0}function _getBindKeyOf(e,a){var t,n,r=e.getAttribute("data-bind"),s="";return r&&!r.containsStr(":")&&(r=_defaultAttr(e)+":'"+r+"'"),(t=spa.toJSON(r||"{}"))&&!$.isEmptyObject(t)&&_.some(_.keys(t),function(e){return!s&&new RegExp(a,"i").test(e)&&(n=t[e].split("|"),s=n.shift().trim()),!!s}),s}function _onViewDataChange(){var e=this,a=$(e),t=spa.getElValue(e),n={},r=a.spa$()[0],s=a.spa$name(),o="2way".equalsIgnoreCase(spa.components[s].dataBindType);e.classList.add("DATA-MODEL-CHANGE-SRC");var i=_getBindKeyOf(e,"value|$");spa.setSimpleObjProperty(n,i,t),o&&(_.merge(spa.$data(s),n),app[s].is$DataUpdated=spa.components[s].is$DataUpdated=!0),spa.bindData(r,n,'[data-bind*="'+i+'"]:not(.DATA-MODEL-CHANGE-SRC)',!0),e.classList.remove("DATA-MODEL-CHANGE-SRC"),o&&spa.renderUtils.runCallbackFn("app."+s+".$dataChangeCallback",app[s].$data,app[s])}function _initDataBind(e,a){function _bindEvent(e,a){$(e).on((e.getAttribute("data-bind-event")||a).toLowerCase(),_onViewDataChange)}var t="[data-bind]:not(.SPA-DATA-BOUND)",n=$(e||"body").find((a||"")+" "+t);n.length||a||(n=$(e+t)),n.length&&(n.filter("textarea,input:not([type=radio]):not([type=checkbox])").addClass("SPA-DATA-BOUND").each(function(){_bindEvent(this,"keyup")}),n.filter("select,input[type=radio],input[type=checkbox]").addClass("SPA-DATA-BOUND").each(function(){_bindEvent(this,"change")}))}function _init_SPA_DOM_(e){spa.reflowFoundation(e),_initKeyTracking("",e),_initKeyPauseEvent(e),_initSpaElements(e),spa.initTrackFormElChanges(e),_initFormValidationInScope(e),_initRouteHash(e),spa.initTogglePassword(e),_initDataBind(e),_processDynHashInUrl()}function _init_SPA_(){_ctrlBrwowserNav(),init_i18n_Lang(),_init_SPA_DOM_("body"),spa.i18n.apply("body")}function _initApiUrls(){(_appApiInitialized=!!Object.keys(app.api).length)&&spa.console.log("Initializing app.api");var e=spa.findSafe(window,"app.api.baseUrl");spa.isBlank(e)||(spa.api.baseUrl=e);var a=spa.findSafe(window,"app.api.urls");if(spa.isBlank(spa.api.urls)&&!spa.isBlank(a)&&(spa.api.urls=app.api.urls),!spa.isBlank(spa.api.urls)){var t=spa.findSafe(window,"app.api.liveApiPrefix|app.api.mockRootAtPaths");if(!spa.isBlank(t)){var n,r,s=is(t,"array")?t:(""+t).split(",");_.each(s,function(t,e){t=t.trim(),"!"!=(n=t[0])&&"~"!=n||(t=t.substr(1),_.each(spa.api.urls,function(e,a){"!"!=(r=e[0])&&"~"!=r&&(0==e.indexOf(t)||0<e.indexOf("/"+t))&&(spa.api.urls[a]=n+e)})),s[e]=t}),app.api.liveApiPrefix=s,delete app.api.mockRootAtPaths}}}function _initSpaApp(){function runSpaEvent(e){if(spa[e])return spa[e]()}$.when(runSpaEvent("onInit")).done(function initSpaModules(){if(spa.env&&"dev".equalsIgnoreCase(spa.env)){var e={components:{templateCache:!(spa.api.mock=!0),callback:function(){console.log("spa$>",this.__prop__.componentName)}}};spa.defaults.set(e)}$.when(_init_SPA_()).done(function(){$.when(runSpaEvent("onInitComplete")).done(function(){$.when(runSpaEvent("onReady")).done(spa.renderComponentsInHtml)})})})}function _initSpaDefaults(){var a,t=$("body").data();_.each(Object.keys(spa.defaults),function(e){e.equalsIgnoreCase("set")||(a=t["spaDefaults"+e.capitalize()],spa.isBlank(a)||_.merge(spa.defaults[e],spa.toJSON(a)))}),_initRoutesDefaults(),_initApiUrls()}spa.reload=function(e){e&&spa.sesStore.set("_spaReloadUrl",e||""),spa.allowNav(),window.location.reload()},spa.hasReloadUrl=function(){return!!(spa.sesStore.get("_spaReloadUrl")||"").trim()},spa.initRoutes=_initRouteHash,spa.route=_routeNewUrl,spa.routeUrl=_routeToUrl,spa.routeEl=_$routeElements,spa.initDataBind=_initDataBind,spa.async=function(n){var r=Array.prototype.slice.call(arguments,1);setTimeout(function fnAsyc(){var e=n.apply(void 0,r),a=r.length,t=a?r[a-1]:"";t&&spa.is(t,"function")&&t(e)},0)},$(document).ready(function(){_initSpaDefaults(),spa.debug=spa.urlParam("spa.debug")||spa.hashParam("spa.debug")||spa.debug,$.ajaxPrefilter(_ajaxPrefilter),_initSpaApp()})}(),spa.console.info("spa loaded.");

/** @license SPA.js Validation Extension | (c) Kumararaja | License (MIT) */
function _clearSpaValidateMsg(a){return spa._validate._showValidateMsg(a),!0}spa._validateDefaults={required:"Required",digits:"Digits",numbers:"Numbers",integer:"Integer",alphabet:"Alpha",alphanumeric:"AlphaNumeric",pattern:"PatternMatch",range:"ValueRange",fixedlength:"Lengths",minlength:"LengthMin",maxlength:"LengthMax",email:"Email",url:"Url",date:"Date",cardno:"CardNo",ipv4:"IPv4",ipv6:"IPv6",ipaddress:"IP",subnetmask:"Subnet",phoneUS:"PhoneUS",wordsize:"WordSize",compare:"Compare",promise:"Promise",xss:"CheckXSS",noop:"Noop"},spa._validate={defaults:{offline:!0},_isOnOfflineValidation:!1,_validateAlertTemplate:'<div class="errortxt error-txt break-txt" data-i18n=""></div>',_offlineValidationRules:{},_fn:{Noop:function(){return!0},CheckXSS:function(a){var e=spa.getElValue(a);return!(/<\s*\/?\s*(\bscript\b)/gi.test(e)||/<(.)+\s+on([a-z])+\s*=|javascript:/gi.test(e))},Promise:function(a){if(!spa._validate._isOnOfflineValidation){var e=$(a),t=e.data("validate")||"";/(promise)(\s)*:(\s)*(\'|\")/.test(t)&&spa._validate._addValidationClass(e,"validation-pending")}return!0},Required:function(a){var e=spa.getElValue(a);return!spa.isBlank(e)},Digits:function(a){var e=$(a).val(),t=0===e.length||/^\d+$/.test(e);return t},Numbers:function(a){var e=$(a).val(),t=0===e.length||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(e);return t},Integer:function(a){var e=$(a).val(),t=0===e.length||/^-?\d+$/.test(e);return t},Alpha:function(a){var e=$(a).val(),t=0===e.length||!/[^a-z]/gi.test(e);return t},AlphaNumeric:function(a){var e=$(a).val(),t=0===e.length||!/[^a-z0-9]/gi.test(e);return t},PatternMatch:function(a){var e=$(a).val(),t=0===e.length;if(!t){var n=RegExp($(a).data("validatePattern"),$(a).data("validatePatternOptions").replace(/!/g,""));t=n.test(e),$(a).data("validatePatternOptions").indexOf("!")>=0&&(t=!t)}return t},ValueRange:function(a){var e=$(a).val(),t=0===e.length;if(!t&&(t=!1,/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(e))){var n=spa.toFloat(e),i=(" "+($(a).data("validateRange")||"")+": ").split(":"),s=!spa.isBlank(i[0]),r=!spa.isBlank(i[1]),l=spa.toFloat(i[0]),o=spa.toFloat(i[1]);s&&r?t=n>=l&&o>=n:s?t=n>=l:r&&(t=o>=n)}return t},LengthMin:function(a){var e=$(a).val(),t=spa.toInt($(a).data("minlength")||$(a).attr("minlength")),n=e.length>=t;return n},LengthMax:function(a){var e=$(a).val(),t=spa.toInt($(a).data("maxlength")),n=t>=e.length;return n},Lengths:function(a){var e=$(a).val(),t=e.length,n=spa.toInt($(a).data("minlength")||$(a).attr("minlength")),i=spa.toInt($(a).data("maxlength")),s=t>=n&&i>=t;return s},WordSize:function(a){var e=$(a).val(),t=_.max(_.map((""+e).replace(/[-\n]/g," ").split(" "),function(a){return a.length})),n=spa.toInt($(a).data("validWordSize"))||20,i=n>=t;return i},Email:function(a){var e=$(a).val(),t=0===e.length;return t||(t=(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(e)||/[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/i.test(e))&&/[a-z0-9]/i.test(e[e.length-1])&&1==((e||"").match(/@/g)||[]).length),t},Url:function(a){var e=$(a).val(),t=0===e.length;return t||(t=/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)),t},Date:function(a){var e=$(a).val(),t=0===e.length;if(!t){t=!1;var n,i,s,r,l=["","JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],o=["","JANUARY","FEBRUARY","MARCH","APRIL","MAY","JUNE","JULY","AUGUST","SEPTEMBER","OCTOBER","NOVEMBER","DECEMBER"],d=$(a).data("validateFormat")||"YMD",u="^\\d{1,2}[\\/\\-\\.]\\d{1,2}[\\/\\-\\.]\\d{4}$",F=e.replace(/[^a-z]/gi,"");F&&(r=_.indexOf(l,F.toUpperCase()),0>=r&&(r=_.indexOf(o,F.toUpperCase())),r>0&&(e=e.replace(RegExp(F,"gi"),r))),e=e.replace(/[^0-9]/g," ").normalizeStr().replace(/ /g,"/");var f=e.split("/");switch(d.toUpperCase()){case"YMD":u="^\\d{4}[\\/\\-\\.]\\d{1,2}[\\/\\-\\.]\\d{1,2}$",n=f[0],i=f[1],s=f[2];break;case"MDY":i=f[0],s=f[1],n=f[2];break;case"DMY":s=f[0],i=f[1],n=f[2]}if(RegExp(u,"").test(e)){s=parseInt(s,10),i=parseInt(i,10),n=parseInt(n,10);var p=new Date(n,i-1,s);t=p.getFullYear()===n&&p.getMonth()===i-1&&p.getDate()===s}}return t},CardNo:function(a){var e=$(a).val(),t=0===e.length;if(!t){var n=!/[^0-9 \-]+/.test(e),i=e.replace(/[^0-9]/g,""),s=i.length;if(n&&s&&"0345".indexOf(i[0])>0&&(15==s||16==s)){for(var r=0,l=0,o=!1,d=e.replace(/\D/g,""),u=d.length-1;u>=0;u--){var F=d.charAt(u);l=parseInt(F,10),o&&(l*=2)>9&&(l-=9),r+=l,o=!o}t=0===r%10}}return t},IPv4:function(a){var e=$(a).val(),t=0===e.length;return t||(t=/^(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)$/i.test(e)&&_.every(e.split("."),function(a){return a.length>1?!a.beginsWithStr("0"):!0})),t},IPv6:function(a){var e=$(a).val(),t=0===e.length;return t||(t=/^((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))$/i.test(e)),t},IP:function(a,e){var t=$(a).val(),n=0===t.length;if(!n){var i=t,s=spa.toInt($(a).data("validateIpaddressOctates")||4)-1,r=RegExp("^(([01]?[0-9]?[0-9]|2([0-4][0-9]|5[0-5]))\\.){"+s+"}([01]?[0-9]?[0-9]|2([0-4][0-9]|5[0-5]))$","g");n=r.test(i)&&_.every(i.split("."),function(a){return a.length>1?!a.beginsWithStr("0"):!0}),spa._validate._showValidateMsg(a,e,n);var l=$(a).data("validateIpaddressClass");if(n&&l){var o=i.split("."),d={A:{oct1:{B:0,E:127},oct2:{B:0,E:256},oct3:{B:0,E:256},oct4:{B:1,E:255}},B:{oct1:{B:127,E:192},oct2:{B:1,E:256},oct3:{B:0,E:256},oct4:{B:0,E:255}},C:{oct1:{B:191,E:224},oct2:{B:0,E:256},oct3:{B:1,E:256},oct4:{B:1,E:255}},D:{oct1:{B:223,E:240},oct2:{B:0,E:256},oct3:{B:0,E:256},oct4:{B:0,E:256}},E:{oct1:{B:239,E:255},oct2:{B:0,E:256},oct3:{B:0,E:256},oct4:{B:0,E:255}}};n=1*o[0]>d[l].oct1.B&&d[l].oct1.E>1*o[0]?1*o[1]>=d[l].oct2.B&&d[l].oct2.E>1*o[1]?1*o[2]>=d[l].oct3.B&&d[l].oct3.E>1*o[2]?1*o[3]>d[l].oct4.B&&d[l].oct4.E>1*o[3]?!0:!1:!1:!1:!1,spa._validate._showValidateMsg(a,e,n)}}return n},Subnet:function(a){var e=$(a).val(),t=0===e.length;if(!t){var n=RegExp("^((128|192|224|240|248|252|254)\\.0\\.0\\.0)|(255\\.(((0|128|192|224|240|248|252|254)\\.0\\.0)|(255\\.(((0|128|192|224|240|248|252|254)\\.0)|255\\.(0|128|192|224|240|248|252|254)))))$");t=n.test(e)&&_.every(e.split("."),function(a){return a.length>1?!a.beginsWithStr("0"):!0})}return t},PhoneUS:function(a){var e=$(a).val(),t=0===e.length;return t||(t=e.length>9&&e.match(/^(\+?1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)),t},Compare:function(a){var e=$(a).val(),t=0===e.length;if(!t){var n,i=$(a),s=i.data(),r=spa.toJSON(s.validateCompare||"{}");if(!spa.isBlank(r)&&r.target){n=$(r.target);var l=r.valid||"=",o=spa.getElValue(a),d=spa.getElValue(n);if(("number".equalsIgnoreCase(r.type)||l.indexOf("<")>=0||l.indexOf(">")>=0)&&(o=spa.toFloat(o),d=spa.toFloat(d)),"date".equalsIgnoreCase(r.type));else switch(l){case"!=":t=o!=d;break;case"!==":t=o!==d;break;case"===":t=o===d;break;case">":t=o>d;break;case"<":t=d>o;break;case">=":t=o>=d;break;case"<=":t=d>=o;break;default:t=o==d}}}return t}},_showValidateMsg:function(a,e,t,n,i){e=e||"";var s=$(a);if(!s.length)return spa.console.warn("Validation config/setup is wrong for validation Msg:["+e+"] forEl:",a),void 0;arguments.length>2&&_.isString(t)&&(n=t),arguments.length>2&&_.isBoolean(t)&&t&&(e=""),n=n||spa._validate._validateAlertTemplate;var r=!n.beginsWithStrIgnoreCase("<"),l=s.parent(),o=s.data("errorClassTarget"),d=o?s.closest(o):l,u=s.data("errorPosition");a=s.get(0),spa._validate._isOnOfflineValidation||(d.removeClass("has-error-msg no-error-msg")[t===!1?"addClass":"removeClass"]("validation-error "+(e?"has-error-msg":"no-error-msg")),s[t===!1?"addClass":"removeClass"]("invalid-data"),i||spa.updateTrackFormCtrls(a.form));var F=r?$(n):s.next();!r&&u&&("first".equalsIgnoreCase(u)?F=l.children().first():"last".equalsIgnoreCase(u)&&(F=l.children().last()));var f,p="",c="",g="";if($(F).attr("class")===$(n).attr("class")||r){if(e.beginsWithStrIgnoreCase("i18n:")){p=(e.getLeftStr("|")||e).replace(/i18n:/gi,""),g=e.getRightStr("|"),c="{html:'"+p+"'}",f=spa.toJSON(g),f=spa.is(f,"object")?f:{};var v=s.dataJSON("i18nData");spa.isBlank(v)||(f=_.merge(f,v)),e=spa.i18n.text(p,f)}spa._validate._isOnOfflineValidation||($(F).attr("data-i18n",c).data("i18n",c),$(F).attr("data-i18n-data",g).data("i18nData",g),$(F).html(e))}else spa.isBlank(e)||(u?"first".equalsIgnoreCase(u)?$(n).prependTo(l):"last".equalsIgnoreCase(u)?$(n).appendTo(l):$(n).insertAfter(s):$(n).insertAfter(s),spa._validate._showValidateMsg(a,e,t,n));return t},_getValidationClassTarget:function(a){var e=$(a),t=e.data("errorClassTarget");return t?e.closest(t):e.parent()},_addValidationClass:function(a,e){spa._validate._getValidationClassTarget(a).addClass(e)},_removeValidationClass:function(a,e){spa._validate._getValidationClassTarget(a).removeClass(e)},_deferValidate:function(){return!0},_registerPromise:function(a,e,t,n){var i=!spa.isBlank(a);if(i){var s=$(e),r=s.data("promises")||"",l=0>r.indexOf("["+a+"]");l&&(spa.console.log("validating promise: "+a),r+="["+a+"]",s.attr("data-promises",r).data("promises",r),spa._validate._addValidationClass(s,"validation-pending"),spa.is(t,"function")&&t.call(s,s,n,a))}return i},expose:function(a){return a=a||{},Object.keys(spa._validateDefaults).forEach(function(e){a[e]=spa._validate._fn[spa._validateDefaults[e]]}),a}};var _check=spa._validate.expose();spa.initValidation=spa.initDataValidation=function(a){spa.console.log(">>>>> initDataValidation request for context:"+a);var e=function(a){return a=a||{},_.each(_.keys(a),function(e){0==e.indexOf("on")&&e.indexOf("_")>0&&(_.each(e.split("_"),function(t){0>t.indexOf("on")&&(t="on"+t),a[t]?_.isArray(a[t])?a[t].push(a[e]):a[t]=[a[t],a[e]]:a[t]=[a[e]]}),delete a[e])}),a};a=a||"body";var t=$(a),n=t.data("validateElFilter")||"",i=e(spa.toJSON(t.data("validateCommon")||"{}")),s=_.merge({},i.onFocus),r=spa.toJSON(t.attr("data-validate-defaults")||{}),l=!!r.offline;spa.console.log("commonValidateRules");var o={fn:"_check.promise",offline:!1};spa.isBlank(s)?i.onFocus=o:(spa.is(s,"array")||(s=[s]),s.push(o)),i.onFocus=s,spa.console.log(i);var d,u,F,f,p,c=(t.data("validateForm")||t.data("validateScope")||"").replace(/onRender/i,"").replace(/[^a-zA-Z0-9]/g,"");if(spa.isBlank(c)){var g=a.replace(/[^a-zA-Z0-9]/g,"");c=g}spa.console.log("offlineValidationKey: "+c);var v=!spa.isBlank(c);v&&(spa.console.log("resetting the rules for "+c),spa._validate._offlineValidationRules[c]={rules:{}}),spa.console.log(c,spa._validate._offlineValidationRules[c]),t.find(n+"[data-validate]").each(function(a,t){var n=$(t).prop("id");n||(n=(t.name||t.type).replace(/[^a-z]/gi,"")+a,$(t).attr("id",n));var s={},r=$(t).data("validate");if(r&&0>r.indexOf("{")){var o=($(t).data("validateEvents")||"onBlur").replace(/[^a-z]/gi," ").normalizeStr().replace(/ /g,"_"),g=",offline:"+($(t).data("validateOffline")||l||"false"),h="{fn:"+r.replace(/[,;]/," ").normalizeStr().replace(/ /g,g+"},{fn:")+g+"}";r="{"+o+":["+h+"]}"}s=e(spa.toJSON(r)),spa.console.log(r),_.each(_.keys(i),function(a){var e=i[a];_.isArray(e)||(e=[e]),e.reverse(),_.each(e,function(e){if(d=!0,u="<",f=e.offline||!1,F=!1,e.el){var t=e.el.replace(/ /g,"").split(","),i=e.el.replace(/[< >!]/g,"").split(","),r=_.indexOf(i,n);d=r>=0,d&&(u=t[r].indexOf(">")>=0?">":"<",F=t[r].indexOf("!")>=0)}else e.ex&&(d=0>_.indexOf(e.ex.replace(/[< >!]/g,"").split(","),n));d&&(p=_.omit(e,["el","ex"]),F&&(p=_.extend(p,{offline:!f})),s[a]||(s[a]=[]),s[a]="<"===u?_.union([p],s[a]):_.union(s[a],[p]))})}),_.each(_.keys(s),function(a){var e=a.substring(2,3).toLowerCase()+a.substring(3);spa.console.log("settingup event on["+e+"]..."),_.isArray(s[a])||(s[a]=[s[a]]),spa.console.log(s),v&&_.each(s[a],function(a){spa.is(a,"array")||(a=[a]),_.each(a,function(a){if(a.hasOwnProperty("offline")||(a.offline=l),spa.console.log(a),a.offline&&!a.promise){var e={fn:a.fn,msg:a.msg};spa._validate._offlineValidationRules[c].rules[n]||(spa._validate._offlineValidationRules[c].rules[n]=[]),0>_.indexOf(spa._validate._offlineValidationRules[c].rules[n],e)&&spa._validate._offlineValidationRules[c].rules[n].push(e)}})}),spa.console.log("registering an event: "+a),a.beginsWithStrIgnoreCase("on")&&!"test".equalsIgnoreCase(e)&&$(t).on(e,function(){var e,t,n,i=this;_.every(s[a],function(a){return _.isArray(a)?_.every(a,function(a){return e=a.fn,spa.is(e,"string")&&(e=spa.findSafe(window,e)),spa.is(e,"function")||console.error("data-validate-function Not Found: "+a.fn),t=a.msg||$(i).data("validateMsg")||"",spa._validate._registerPromise(a.promise,i,e,t)&&(e=spa._validate._deferValidate),n=spa.is(e,"function")?e.call(i,i,t):!1,spa.is(n,"boolean")&&spa._validate._showValidateMsg(i,t,n),n}):(e=a.fn,spa.is(e,"string")&&(e=spa.findSafe(window,e)),spa.is(e,"function")||console.error("data-validate-function Not Found: "+a.fn),t=a.msg||$(i).data("validateMsg")||"",spa._validate._registerPromise(a.promise,i,e,t)&&(e=spa._validate._deferValidate),n=spa.is(e,"function")?e.call(i,i,t):!1,spa.is(n,"boolean")&&spa._validate._showValidateMsg(i,t,n),n)})})})})},spa.validateForm=spa.validate=spa.doDataValidation=function(a,e,t){var n;spa.is(arguments[1],"string")&&(n="#"+arguments[1].replace(/[ #]/g,"").replace(/,/g,",#")+",",e=arguments[2],t=arguments[3]);var i=a.replace(/[^a-zA-Z0-9]/g,""),s="#"+a.replace(/#/g,""),r=$(s),l=[];if(spa._validate._offlineValidationRules[i]){var o=spa._validate._offlineValidationRules[i].rules,d=function(a){var e,t,n,i=r.find("#"+a),s=i[0],d=spa.toBoolean(i.data("ignoreValidationIfInvisible"))&&!i.is(":visible");return d||(d=_.every(o[a],function(a){if(t=a.fn,spa.is(t,"string")&&(t=spa.findSafe(window,t)),spa.is(t,"function")||console.error("data-validate-function Not Found: "+a.fn),e=a.msg||i.data("validateMsg")||"",n=spa.is(t,"function")?t.call(s,s,e):!1,spa.is(n,"boolean")&&spa._validate._showValidateMsg(i,e,n,"",!0),!n){var r={errcode:2,el:s,fn:a.fn,msg:e};l.push(r)}return n})),d};if($.isEmptyObject(o)){var u=1,F="Offline rules not found in scope ["+a+"].";r.find(".validation-error,.validation-pending").length&&(u=3,F+=" Found .validation-error|.validation-pending"),l=[{errcode:u,errmsg:F}]}else{var f=_.keys(o);n&&(f=_.map(f,function(a){return n.indexOf("#"+a+",")>=0?a:""})),spa._validate._isOnOfflineValidation=!e,_.every(f,function(a){return a?d(a)||t:!0}),spa._validate._isOnOfflineValidation=!1}}else r.length?r.is("[data-validate-form]")&&(l=[{errcode:1,errmsg:"Form Not Initialized."}]):l=[{errcode:1,errmsg:"Form Not Found."}];return l},spa.removeValidationMsg=function(a){$(a).each(function(a,e){spa._validate._showValidateMsg(e,"",!0)})},spa.updateValidation=function(a,e,t,n){2==arguments.length&&(t=spa.isBlank(e)),$(a).each(function(a,i){spa._validate._showValidateMsg(i,e,t,n)})},spa.updateValidationPromise=function(a,e,t,n,i){var s,r,l=$(e);l.each(function(e,l){s=$(l),_.each(a.split(","),function(a){r=(s.data("promises")||"").replace("["+a.trim()+"]",""),s.attr("data-promises",r).data("promises",r),spa.isBlank(r)&&spa._validate._removeValidationClass(s,"validation-pending")}),spa._validate._showValidateMsg(l,t,n,i)})};

