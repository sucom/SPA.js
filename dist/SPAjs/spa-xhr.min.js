/*@license SPA.js (XHR/ajax) [MIT]*/
!function(t){var n=Object.prototype,a=Array.prototype,S=0;function o(e,t){return 1===arguments.length?a.slice.call(e):a.slice.call(e,t)}function s(e){return-1<r.indexOf(e)}function A(e,t){return n.hasOwnProperty.call(e,t)}var r="hasOwnProperty,prototype,__proto__".split(",");function e(t,n){return Object.keys(n).forEach(function(e){s(e)||Object.defineProperty(t,e,{value:n[e]})}),t}function C(e){e&&(Array.isArray(e)?[e]:e).forEach(function(e){e&&clearTimeout(e)})}var i,c,l,u=spa.extractStrBetweenIn,f=spa.is,D=spa.isString,p=spa.isArray,H=spa.isObject,d=spa.isObjectLike,q=spa.isFunction,U=spa.isUndefined,k=spa.extend,Q=spa.merge,h=spa.find;function N(e){if(H(e)){var a,s,r,i=e;return A(e,"_payload_")||function e(t){var n=!0;if("object"==typeof t)for(var a=Object.keys(t),s=0;n&&s<a.length;s++)n="object"!=typeof t[a[s]]||p(t[a[s]])&&e(t[a[s]]);return n}(e)||(i={_payload_:e}),Object.keys(i).reduce(function(e,t,n){return a=0===n?"":"&",s=encodeURIComponent(t),r=p(i[t])?i[t].map(function(e){return o(e)}).join(","):o(i[t]),[e,a,s,"=",r].join("")},"")}return String(e);function o(e){return encodeURIComponent("object"==typeof e?JSON.stringify(e):e)}}function L(e){return e instanceof I||e instanceof R||e instanceof v||t.Promise&&e instanceof Promise||t.jqXHR&&e instanceof jqXHR||t.Thenable&&e instanceof Thenable||t.Deferred&&e instanceof Deferred}function M(e,t,n){var a=e.fnQ.then,s=e.fnQ.fail,r=e.fnQ.done,i={then:"then,fail,done",fail:"fail,done",done:"done"}[n];if(L(t)){if(-1<i.indexOf("then"))for(;0<a.length;)t.then(a.shift());else e.fnQ.then=[];if(-1<i.indexOf("fail"))for(;0<s.length;)t.catch(s.shift());else e.fnQ.fail=[];if(-1<i.indexOf("done"))for(;0<r.length;)t.finally(r.shift())}}function v(t,n,a){Object.defineProperty(this,"fnQ",{value:{then:[],fail:[],done:[]}}),this.isPending=!0,this.isResolved=!1,this.isRejected=!1,this.response,this.prevFnRes;var i,o,c,l=this;function s(e,t){if(l.isPending){l.isPending=!1,l.response=t,l.prevFnRes=t,l.isResolved=e,l.isRejected=!e;var n=l.fnQ.then,a=l.fnQ.fail,s=l.fnQ.done;function r(e,t){for(;0<e.length;)l.prevFnRes=[e.shift().apply(l,l.prevFnRes)],M(l,l.prevFnRes[0],t)}l.isResolved?r(n,"then"):r(a,"fail"),r(s,"done")}else console.warn("Already this promise has been "+(l.isResolved?"Resolved.":"Rejected."));C([i,o,c])}function r(){s.call(l,!0,Array.prototype.slice.call(arguments))}function u(){s.call(l,!1,Array.prototype.slice.call(arguments))}var f={resolve:r,reject:u};i=setTimeout(function(){if(q(t)){var e=t.call(f,r,u);a&&(o=setTimeout(function(){l.isPending&&s.call(l,!!e,[e])},U(e)?a:n||S))}else c=setTimeout(function(){l.isPending&&s.call(l,!!t,[t])},n||S)},S)}function y(e,t,n){var a=e;if("function"==typeof n){var s=!a.isPending;if("then"===t?s=s&&a.isResolved:"fail"===t&&(s=s&&a.isRejected),s){var r=n.apply(a,a.prevFnRes);L(r)?a=r:a.prevFnRes=[r]}else a.fnQ[t].push(n)}return a}function T(e){return y(this,"fail",e)}function g(e){return y(this,"done",e)}function R(e){Object.defineProperty(this,"fnQ",{value:{then:[],fail:[],done:[]}}),this.requests=e,this.responses=[],this.length=e.length,this.isPending=e.length,this.isFailed=!1,this.failed=[],this.prevFnRes;var t,r=this;function n(e){for(var t,n=r.fnQ[e];0<n.length;)try{t=void 0===r.prevFnRes?[]:[r.prevFnRes],r.prevFnRes=n.shift().apply(r,t.concat(r.responses)),M(r,r.prevFnRes,e)}catch(e){console.error("Function Execution Error.",e)}}function i(){r.isPending--;try{r.isPending||(r.isFailed?n("fail"):n("then"),n("done"),C(t))}catch(e){console.error("Function Execution Error.",e),C(t)}}t=setTimeout(function(){e.forEach(function(e,t){if(L(e)||d(e)&&(q(e.then)||q(e.fail)||q(e.catch))){"function"==typeof e.then&&e.then(function(){r.responses[t]=o(arguments),i()});var n="function"==typeof e.fail?"fail":"function"==typeof e.catch?"catch":"";n&&e[n](function(){r.responses[t]=o(arguments),r.isFailed=!0,r.failed.push(t),i()})}else if("function"==typeof e){var a=e.call(r,r.requests,r.responses,t),s=void 0!==a&&!a;r.responses[t]=a,r.isFailed=r.isFailed||s,s&&r.failed.push(t),i()}else r.responses[t]=e,r.isFailed=r.isFailed||!e,r.isFailed&&r.failed.push(t),i()})},S)}function F(e,t,n){var a,s=e;if("function"==typeof n){var r=!s.isPending;"then"===t?r=r&&!s.isFailed:"fail"===t&&(r=r&&s.isFailed),r?(a=void 0===s.prevFnRes?[]:[s.prevFnRes],s.prevFnRes=n.apply(s,a.concat(s.responses)),L(s.prevFnRes)&&(s=s.prevFnRes)):s.fnQ[t].push(n)}return s}function O(e){return F(this,"fail",e)}function P(e){return F(this,"done",e)}function G(){var n,a,s=[],r={};if(arguments.length)for(var e=0;e<arguments.length;e++)Array.isArray(arguments[e])?s=s.concat(arguments[e]):s.push(arguments[e]);s.forEach(function(e,t){"string"==typeof e&&(/^(GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS)(:+)/i.test(e)?(n=e.split(":")[0],(a=e.replace(/^(GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS)(:+)/i,""))?e={url:a,method:n}:r.method=n):e={url:e},s[t]=e),"object"!=typeof e||e.url||(r=k(r,e))});var t=[];return s.forEach(function(e){H(e)&&e.url&&!L(e)?t.push(K(k({},r,e))):L(e)?t.push(e):t.push(function(e,t,n){return arguments.length?new v(e,t,n):new v(1,S)}(e))}),new R(t)}function I(e){Object.defineProperty(this,"fnQ",{value:{then:[],fail:[],done:[]}}),this.xhr=new XMLHttpRequest,this.reqOptions=e,this.isPending=!0,this.isSuccess=!1,this.isFailed=!1,this.response="",this.prevFnRes}function m(e,t,n){var a,s=e;if("function"==typeof n){var r=!s.isPending;"then"===t?r=r&&s.isSuccess:"fail"===t&&(r=r&&s.isFailed),r?(s.isFailed?(a=void 0===s.prevFnRes?s:s.prevFnRes,s.prevFnRes=n.call(s.reqOptions,a,s.statusText,s.statusMessage,s.response)):(a=void 0===s.prevFnRes?s.response:s.prevFnRes,s.prevFnRes=n.call(s.reqOptions,a,s.statusText,s,s.response)),L(s.prevFnRes)&&(s=s.prevFnRes)):s.fnQ[t].push(n)}return s}function x(e){return m(this,"fail",e)}function E(e){return m(this,"done",e)}i=v,c={then:function(e){return y(this,"then",e)},else:T,fail:T,catch:T,done:g,always:g,finally:g},Object.keys(c).forEach(function(e){s(e)||(l?i.prototype[e]=c[e]:Object.defineProperty(i.prototype,e,{value:c[e]}))}),Object.defineProperties(R.prototype,{then:{value:function(e){return F(this,"then",e)}},fail:{value:O},catch:{value:O},done:{value:P},always:{value:P},finally:{value:P}}),Object.defineProperties(I.prototype,{then:{value:function(e){return m(this,"then",e)}},fail:{value:x},catch:{value:x},done:{value:E},always:{value:E},finally:{value:E}});var _={defaults:{dataType:"text",async:!0,cache:!1,method:"GET",headers:{},auth:null,timeout:0,success:null,error:null,finally:null},dataParsers:{css:function(e){var t=document.createTextNode(e),n=document.createElement("style");return n.setAttribute("id","css-"+(new Date).getTime()),n.setAttribute("type","text/css"),n.appendChild(t),document.head.appendChild(n),e},json:function(e){var t=e;try{t=JSON.parse(e)}catch(e){}return t},script:$,javascript:$},urls:{},url:B,setup:b,preFilter:w,get:function(){return a.unshift.call(arguments,"get"),K.apply(void 0,arguments)},post:function(){return a.unshift.call(arguments,"post"),K.apply(void 0,arguments)},put:function(){return a.unshift.call(arguments,"put"),K.apply(void 0,arguments)},del:function(){return a.unshift.call(arguments,"delete"),K.apply(void 0,arguments)},patch:function(){return a.unshift.call(arguments,"patch"),K.apply(void 0,arguments)},head:function(){return a.unshift.call(arguments,"head"),K.apply(void 0,arguments)},options:function(){return a.unshift.call(arguments,"options"),K.apply(void 0,arguments)}},j="url,setup,converters,preFilter,get,post,put,del,patch,head,options".split(",");function b(n){H(n)&&Object.keys(n).forEach(function(t){if(j.indexOf(t)<0)switch(t){case"dataParsers":case"urls":H(n[t])&&Object.keys(n[t]).forEach(function(e){_[t][e]=n[t][e]});break;default:_.defaults[t]=n[t]}})}function w(e){q(e)&&(_.defaults.preFilter=e)}function X(e,t){return A(e,t)?e[t]:_.defaults[t]}function $(e){if(e.trim()){var t=document.createElement("script");t.setAttribute("id","js-"+(new Date).getTime()),t.text=e,document.head.appendChild(t).parentNode.removeChild(t)}return e}var J={200:"OK",301:"Moved Permanently",400:"Bad Request",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",511:"Network Authentication Required"},z={text:"text/plain",html:"text/html",css:"text/css",style:"text/css",csv:"text/csv",xml:"text/xml",json:"application/json",pdf:"application/pdf",script:"application/javascript",spacomponent:"application/javascript",zip:"application/zip"};function B(e){var t="@"===String(e||"")[0];e=String(e||"").replace(/^[@\s]+/,"");var n,a,s=t?_.urls[e]||h(_.urls,e,e):e,r=o(arguments,1).map(function(e){return f(e,"object|array")?e:{}});return r=Q.apply(null,r),Object.keys(r).length&&-1<s.indexOf("{")&&u(s,"{","}",!0).forEach(function(e){n=e.replace(/[{}<>]/g,""),a=h(r,n,r._undefined),s=s.replace(new RegExp(e.replace(/([^a-zA-Z0-9])/g,"\\$1"),"g"),a)}),s}function K(){if(!arguments.length)return G.apply(null,[]);if(2===arguments.length&&D(arguments[0])&&!/^(GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS)$/i.test(arguments[0])&&H(arguments[1])&&!A(arguments[1],"url")){var e=arguments[1];return e.url=arguments[0],K(e)}if(1<arguments.length||Array.isArray(arguments[0]))return G.apply(null,arguments);if(L(arguments[0]))return arguments[0];var t=H(arguments[0])?arguments[0]:D(arguments[0])?{url:arguments[0]}:{},n={},a=[];t.skipDefaults?("string"==typeof(a=t.skipDefaults)?a=a.split(","):"boolean"==typeof a&&(a=["payload","headers"]),Array.isArray(a)&&a.length?(a=a.map(function(e){return(e=e.replace(/default/gi,"").trim())?"default"+e[0].toUpperCase()+e.slice(1):""}),Object.keys(_.defaults).forEach(function(e){a.indexOf(e)<0&&(n[e]=_.defaults[e])})):(a=[],n=k({},_.defaults))):n=k({},_.defaults),n.method=t.method||t.type||_.defaults.method;var s=k({},n,t);if(s.url){s.type=s.method=s.method.toUpperCase();var l=s.dataType.toLowerCase(),r=z[l]||(l&&l.indexOf("/")<-1?"text/"+s.dataType:s.dataType),i={},o=s.defaultHeaders;q(o)&&(o=o.call(s,s)),q(s.headers)&&(s.headers=s.headers.call(void 0,s)),H(s.headers)&&Object.keys(s.headers).forEach(function(e){i[e]=s.headers[e]}),H(o)&&(U(i)?i=o:H(i)&&(i=k(o,i))),!i.hasOwnProperty("Content-Type")&&r&&(i["Content-Type"]=r),i["X-Requested-With"]="XMLHttpRequest",i["Cache-Control"]=s.cache?"max-age=86400000":"no-cache, no-store, must-revalidate, max-age=0",i.Expires=s.cache?new Date((new Date).setDate((new Date).getDate()+1)).toUTCString():"0",s.cache||(i.Pragma="no-cache"),s.headers=i;var u,f,p,d,h,v=new I(s),c=v.xhr,y=v.reqOptions,T=v.fnQ;q(y.success)&&T.then.push(y.success),q(y.error)&&T.fail.push(y.error),q(y.finally)&&T.done.push(y.finally),Object.keys(y).forEach(function(t){var e=t.toLowerCase();"onreadystatechange"===e&&q(y[t])?h=y[t]:0===e.indexOf("on")&&q(y[t])&&(c[e]=function(e){y[t].call(c,e,v)})}),c.onreadystatechange=w;var g=y.defaultPayload;q(g)&&(g=g.call(y,y));var R=y.data;H(g)&&(U(R)?R=g:H(R)&&(R=Q(g,R))),y.data=R;var F=X(y,"preFilter");F&&q(F)&&F.call(v,y,k({},y),v);var O=B(y.url,y.urlParams,y.data);/^(GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS)(:+)/i.test(O)&&(y.method=O.split(":")[0].toUpperCase(),O=O.replace(/^(GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS)(:+)/i,"")),y.url=O;var P=y.method=y.method.toUpperCase(),m=y.cache;if(R=y.data,!m){var x=(new Date).getTime();y.headers["X-T-"+x]=x,"GET"===P&&(O+=(O.indexOf("?")<0?"?":/\?$|&$/.test(O)?"":"&")+"_="+x)}"GET"===P&&R&&(R=N(R))&&(O+=(O.indexOf("?")<0?"?":/\?$|&$/.test(O)?"":"&")+R);try{y.auth&&H(y.auth)?y.auth.hasOwnProperty("user")&&(y.auth.hasOwnProperty("pwd")?c.open(P,O,y.async,y.auth.user,y.auth.pwd):c.open(P,O,y.async,y.auth.user)):c.open(P,O,y.async);var E=X(y,"beforeSend"),j=!0;if(E&&q(E))try{j=(j=E.call(c,c,y))||U(j),R=y.data}catch(e){j=!1,console.warn("beforeSend function failed.",e,v)}if(j){var b=y.headers;H(b)&&Object.keys(b).forEach(function(e){c.setRequestHeader(e,b[e])}),y.timeout&&(c.timeout=y.timeout,u=setTimeout(function(){f=!0,v.isPending&&0<c.readyState&&c.readyState<4&&c.abort()},y.timeout)),"GET"!==P&&R?(R=D(R)?R:JSON.stringify(R),y.async?d=setTimeout(function(){c.send(R)},S):c.send(R)):y.async?d=setTimeout(function(){c.send()},S):c.send()}else p=!0,c.abort(),w()}catch(e){console.warn("XHR-Exception",c,e)}return v}function w(e){var t=this,n=t.status;if(h&&h.call(y,t,e),p||4===t.readyState){v.isPending=!1,v.readyState=t.readyState,v.status=t.status,v.responseText=t.responseText,v.response=t.responseText;var a=t.responseText;if(200<=n&&n<300||304===n){var s,r;if(v.isSuccess=!0,v.statusText="success",v.statusMessage="OK",(s=A(y,"dataParser")?y.dataParser:_.dataParsers[l])&&q(s))try{r=s(a,l)}catch(e){console.warn("dataParsing failed.",a,v,e)}U(r)||(a=r);var i,o=X(y,"dataFilter");if(o&&q(o))try{i=o.call(v,a,l)}catch(e){console.warn("dataFilter failed.",a,v,e)}U(i)||(a=i),"json"===l&&(v.responseJSON=a)}else a=t.responseText,v.isFailed=!0,u&&f?(v.statusText="timeout",v.statusMessage="timeout"):p?(v.statusText="canceled",v.statusMessage="canceled"):(v.statusText="error",v.statusMessage=J[n]||"Unknown Error");v.response=a,v.isSuccess?c("then"):v.isFailed&&c("fail"),c("done"),C([u,d])}function c(e){for(var t,n=T[e];0<n.length;)try{v.isFailed?(t=void 0===v.prevFnRes?v:v.prevFnRes,v.prevFnRes=n.shift().call(y,t,v.statusText,v.statusMessage,v.response)):(t=void 0===v.prevFnRes?v.response:v.prevFnRes,v.prevFnRes=n.shift().call(y,t,v.statusText,v,v.response)),M(v,v.prevFnRes,e)}catch(e){console.error("Function Execution Error.",e)}}}console.error("XHR without URL.",arguments,s)}function V(){return G.apply(t,o(arguments))}e(K,_),e(V,{ajax:K,ajaxQ:G,when:G,defer:G,ajaxSetup:b,ajaxPrefilter:w}),t.spaXHR=V}(this);