/*@license SPA.js (XHR/ajax) [MIT]*/
!function(t){var n=Object.prototype,s=Array.prototype,S=0;function o(e,t){return 1===arguments.length?s.slice.call(e):s.slice.call(e,t)}function a(e){return-1<r.indexOf(e)}function A(e,t){return n.hasOwnProperty.call(e,t)}var r="hasOwnProperty,prototype,__proto__".split(",");function e(t,n){return Object.keys(n).forEach(function(e){a(e)||Object.defineProperty(t,e,{value:n[e]})}),t}function C(e){e&&(Array.isArray(e)?e:[e]).forEach(function(e){e&&clearTimeout(e)})}var i,c,l,u=spa.extractStrBetweenIn,p=spa.is,D=spa.isString,f=spa.isArray,H=spa.isObject,d=spa.isObjectLike,q=spa.isFunction,U=spa.isUndefined,k=spa.extend,Q=spa.merge,h=spa.find;function N(e){if(H(e)){var s,a,r,i=e;return A(e,"_payload_")||function e(t){var n=!0;if("object"==typeof t)for(var s=Object.keys(t),a=0;n&&a<s.length;a++)n="object"!=typeof t[s[a]]||f(t[s[a]])&&e(t[s[a]]);return n}(e)||(i={_payload_:e}),Object.keys(i).reduce(function(e,t,n){return s=0===n?"":"&",a=encodeURIComponent(t),r=f(i[t])?i[t].map(o).join(","):o(i[t]),[e,s,a,"=",r].join("")},"")}return String(e);function o(e){return encodeURIComponent("object"==typeof e?JSON.stringify(e):e)}}function L(e){return e instanceof I||e instanceof O||e instanceof v||t.Promise&&e instanceof Promise||t.jqXHR&&e instanceof jqXHR||t.Thenable&&e instanceof Thenable||t.Deferred&&e instanceof Deferred}function M(e,t,n){var s=e.fnQ.then,a=e.fnQ.fail,r=e.fnQ.done,i={then:"then,fail,done",fail:"fail,done",done:"done"}[n];if(L(t)){if(-1<i.indexOf("then"))for(;0<s.length;)t.then(s.shift());else e.fnQ.then=[];if(-1<i.indexOf("fail"))for(;0<a.length;)t.catch(a.shift());else e.fnQ.fail=[];if(-1<i.indexOf("done"))for(;0<r.length;)t.finally(r.shift())}}function v(t,n,s){Object.defineProperty(this,"fnQ",{value:{then:[],fail:[],done:[]}}),this.isPending=!0,this.isResolved=!1,this.isRejected=!1,this.response,this.prevFnRes;var i,o,c=this;function a(e,t){function n(e,t){for(;0<e.length;)c.prevFnRes=[e.shift().apply(c,c.prevFnRes)],M(c,c.prevFnRes[0],t)}var s,a,r;c.isPending?(c.isPending=!1,c.response=t,c.prevFnRes=t,c.isResolved=e,c.isRejected=!e,s=c.fnQ.then,a=c.fnQ.fail,r=c.fnQ.done,c.isResolved?n(s,"then"):n(a,"fail"),n(r,"done")):console.warn("Already this promise has been "+(c.isResolved?"Resolved.":"Rejected.")),C([p,i,o])}function r(){a.call(c,!0,Array.prototype.slice.call(arguments))}function l(){a.call(c,!1,Array.prototype.slice.call(arguments))}var u={resolve:r,reject:l},p=setTimeout(function(){var e;q(t)?(e=t.call(u,r,l),s&&(i=setTimeout(function(){c.isPending&&a.call(c,!!e,[e])},U(e)?s:n||S))):o=setTimeout(function(){c.isPending&&a.call(c,!!t,[t])},n||S)},S)}function y(e,t,n){var s,a,r=e;return"function"==typeof n&&(s=!r.isPending,"then"===t?s=s&&r.isResolved:"fail"===t&&(s=s&&r.isRejected),s?L(a=n.apply(r,r.prevFnRes))?r=a:r.prevFnRes=[a]:r.fnQ[t].push(n)),r}function T(e){return y(this,"fail",e)}function g(e){return y(this,"done",e)}function O(e){Object.defineProperty(this,"fnQ",{value:{then:[],fail:[],done:[]}}),this.requests=e,this.responses=[],this.length=e.length,this.isPending=e.length,this.isFailed=!1,this.failed=[],this.prevFnRes;var t,r=this;function n(e){for(var t,n=r.fnQ[e];0<n.length;)try{t=void 0===r.prevFnRes?[]:[r.prevFnRes],r.prevFnRes=n.shift().apply(r,t.concat(r.responses)),M(r,r.prevFnRes,e)}catch(e){console.error("Function Execution Error.",e)}}function i(){r.isPending--;try{r.isPending||(r.isFailed?n("fail"):n("then"),n("done"),C(t))}catch(e){console.error("Function Execution Error.",e),C(t)}}t=setTimeout(function(){e.forEach(function(e,t){var n,s,a;L(e)||d(e)&&(q(e.then)||q(e.fail)||q(e.catch))?("function"==typeof e.then&&e.then(function(){r.responses[t]=o(arguments),i()}),(n="function"==typeof e.fail?"fail":"function"==typeof e.catch?"catch":"")&&e[n](function(){r.responses[t]=o(arguments),r.isFailed=!0,r.failed.push(t),i()})):("function"==typeof e?(a=void 0!==(s=e.call(r,r.requests,r.responses,t))&&!s,r.responses[t]=s,r.isFailed=r.isFailed||a,a&&r.failed.push(t)):(r.responses[t]=e,r.isFailed=r.isFailed||!e,r.isFailed&&r.failed.push(t)),i())})},S)}function R(e,t,n){var s,a,r=e;return"function"==typeof n&&(a=!r.isPending,"then"===t?a=a&&!r.isFailed:"fail"===t&&(a=a&&r.isFailed),a?(s=void 0===r.prevFnRes?[]:[r.prevFnRes],r.prevFnRes=n.apply(r,s.concat(r.responses)),L(r.prevFnRes)&&(r=r.prevFnRes)):r.fnQ[t].push(n)),r}function F(e){return R(this,"fail",e)}function P(e){return R(this,"done",e)}function G(){var n,s,a=[],r={};if(arguments.length)for(var e=0;e<arguments.length;e++)Array.isArray(arguments[e])?a=a.concat(arguments[e]):a.push(arguments[e]);a.forEach(function(e,t){"string"==typeof e&&(/^(GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS)(:+)/i.test(e)?(n=e.split(":")[0],(s=e.replace(/^(GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS)(:+)/i,""))?e={url:s,method:n}:r.method=n):e={url:e},a[t]=e),"object"!=typeof e||e.url||(r=k(r,e))});var t=[];return a.forEach(function(e){H(e)&&e.url&&!L(e)?t.push(K(k({},r,e))):L(e)?t.push(e):t.push(function(e,t,n){return arguments.length?new v(e,t,n):new v(1,S)}(e))}),new O(t)}function I(e){Object.defineProperty(this,"fnQ",{value:{then:[],fail:[],done:[]}}),this.xhr=new XMLHttpRequest,this.reqOptions=e,this.isPending=!0,this.isSuccess=!1,this.isFailed=!1,this.response="",this.prevFnRes}function m(e,t,n){var s,a,r=e;return"function"==typeof n&&(a=!r.isPending,"then"===t?a=a&&r.isSuccess:"fail"===t&&(a=a&&r.isFailed),a?(r.isFailed?(s=void 0===r.prevFnRes?r:r.prevFnRes,r.prevFnRes=n.call(r.reqOptions,s,r.statusText,r.statusMessage,r.response)):(s=void 0===r.prevFnRes?r.response:r.prevFnRes,r.prevFnRes=n.call(r.reqOptions,s,r.statusText,r,r.response)),L(r.prevFnRes)&&(r=r.prevFnRes)):r.fnQ[t].push(n)),r}function x(e){return m(this,"fail",e)}function E(e){return m(this,"done",e)}i=v,c={then:function(e){return y(this,"then",e)},else:T,fail:T,catch:T,done:g,always:g,finally:g},Object.keys(c).forEach(function(e){a(e)||(l?i.prototype[e]=c[e]:Object.defineProperty(i.prototype,e,{value:c[e]}))}),Object.defineProperties(O.prototype,{then:{value:function(e){return R(this,"then",e)}},fail:{value:F},catch:{value:F},done:{value:P},always:{value:P},finally:{value:P}}),Object.defineProperties(I.prototype,{then:{value:function(e){return m(this,"then",e)}},fail:{value:x},catch:{value:x},done:{value:E},always:{value:E},finally:{value:E}});var _={defaults:{dataType:"text",async:!0,cache:!1,method:"GET",headers:{},auth:null,timeout:0,success:null,error:null,finally:null},dataParsers:{css:function(e){var t=document.createTextNode(e),n=document.createElement("style");return n.setAttribute("id","css-"+(new Date).getTime()),n.setAttribute("type","text/css"),n.appendChild(t),document.head.appendChild(n),e},json:function(e){var t=e;try{t=JSON.parse(e)}catch(e){}return t},script:$,javascript:$},urls:{},url:B,setup:b,preFilter:w,get:function(){return s.unshift.call(arguments,"get"),K.apply(void 0,arguments)},post:function(){return s.unshift.call(arguments,"post"),K.apply(void 0,arguments)},put:function(){return s.unshift.call(arguments,"put"),K.apply(void 0,arguments)},del:function(){return s.unshift.call(arguments,"delete"),K.apply(void 0,arguments)},patch:function(){return s.unshift.call(arguments,"patch"),K.apply(void 0,arguments)},head:function(){return s.unshift.call(arguments,"head"),K.apply(void 0,arguments)},options:function(){return s.unshift.call(arguments,"options"),K.apply(void 0,arguments)}},j="url,setup,converters,preFilter,get,post,put,del,patch,head,options".split(",");function b(n){H(n)&&Object.keys(n).forEach(function(t){if(j.indexOf(t)<0)switch(t){case"dataParsers":case"urls":H(n[t])&&Object.keys(n[t]).forEach(function(e){_[t][e]=n[t][e]});break;default:_.defaults[t]=n[t]}})}function w(e){q(e)&&(_.defaults.preFilter=e)}function X(e,t){var n=A(e,t)?e[t]:_.defaults[t];return n}function $(e){var t;return e.trim()&&((t=document.createElement("script")).setAttribute("id","js-"+(new Date).getTime()),t.text=e,document.head.appendChild(t).parentNode.removeChild(t)),e}var J={200:"OK",301:"Moved Permanently",400:"Bad Request",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",511:"Network Authentication Required"},z={text:"text/plain",html:"text/html",css:"text/css",style:"text/css",csv:"text/csv",xml:"text/xml",json:"application/json",pdf:"application/pdf",script:"application/javascript",spacomponent:"application/javascript",zip:"application/zip"};function B(e){var t="@"===String(e||"")[0];e=String(e||"").replace(/^[@\s]+/,"");var n,s,a=t?_.urls[e]||h(_.urls,e,e):e,r=o(arguments,1).map(function(e){return p(e,"object|array")?e:{}}),r=Q.apply(null,r);return Object.keys(r).length&&-1<a.indexOf("{")&&u(a,"{","}",!0).forEach(function(e){n=e.replace(/[{}<>]/g,""),s=h(r,n,r._undefined),a=a.replace(new RegExp(e.replace(/([^a-zA-Z0-9])/g,"\\$1"),"g"),s)}),a}function K(){if(!arguments.length)return G.apply(null,[]);if(2===arguments.length&&D(arguments[0])&&!/^(GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS)$/i.test(arguments[0])&&H(arguments[1])&&!A(arguments[1],"url")){var e=arguments[1];return e.url=arguments[0],K(e)}if(1<arguments.length||Array.isArray(arguments[0]))return G.apply(null,arguments);if(L(arguments[0]))return arguments[0];var t=H(arguments[0])?arguments[0]:D(arguments[0])?{url:arguments[0]}:{},n={},s=[];t.skipDefaults?("string"==typeof(s=t.skipDefaults)?s=s.split(","):"boolean"==typeof s&&(s=["payload","headers"]),Array.isArray(s)&&s.length?(s=s.map(function(e){return(e=e.replace(/default/gi,"").trim())?"default"+e[0].toUpperCase()+e.slice(1):""}),Object.keys(_.defaults).forEach(function(e){s.indexOf(e)<0&&(n[e]=_.defaults[e])})):(s=[],n=k({},_.defaults))):n=k({},_.defaults),n.method=t.method||t.type||_.defaults.method;var a=k({},n,t);if(a.url){a.type=a.method=a.method.toUpperCase();var l=a.dataType.toLowerCase(),r=z[l]||(l&&l.indexOf("/")<-1?"text/"+a.dataType:a.dataType),i={},o=a.defaultHeaders;q(o)&&(o=o.call(a,a)),q(a.headers)&&(a.headers=a.headers.call(void 0,a)),H(a.headers)&&Object.keys(a.headers).forEach(function(e){i[e]=a.headers[e]}),H(o)&&(U(i)?i=o:H(i)&&(i=k(o,i))),!i.hasOwnProperty("Content-Type")&&r&&(i["Content-Type"]=r),i["X-Requested-With"]="XMLHttpRequest",i["Cache-Control"]=a.cache?"max-age=86400000":"no-cache, no-store, must-revalidate, max-age=0",i.Expires=a.cache?new Date((new Date).setDate((new Date).getDate()+1)).toUTCString():"0",a.cache||(i.Pragma="no-cache"),a.headers=i;var u,p,f,d,h,v=new I(a),c=v.xhr,y=v.reqOptions,T=v.fnQ;q(y.success)&&T.then.push(y.success),q(y.error)&&T.fail.push(y.error),q(y.finally)&&T.done.push(y.finally),Object.keys(y).forEach(function(t){var e=t.toLowerCase();"onreadystatechange"===e&&q(y[t])?h=y[t]:0===e.indexOf("on")&&q(y[t])&&(c[e]=function(e){y[t].call(c,e,v)})}),c.onreadystatechange=w;var g=y.defaultPayload;q(g)&&(g=g.call(y,y));var O=y.data;H(g)&&(U(O)?O=g:H(O)&&(O=Q(g,O))),y.data=O;var R=X(y,"preFilter");R&&q(R)&&R.call(v,y,k({},y),v);var F=B(y.url,y.urlParams,y.data);/^(GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS)(:+)/i.test(F)&&(y.method=F.split(":")[0].toUpperCase(),F=F.replace(/^(GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS)(:+)/i,"")),y.url=F;var P,m=y.method=y.method.toUpperCase(),x=y.cache,O=y.data;x||(P=(new Date).getTime(),y.headers["X-T-"+P]=P,"GET"===m&&(F+=(F.indexOf("?")<0?"?":/\?$|&$/.test(F)?"":"&")+"_="+P)),"GET"===m&&O&&(O=N(O))&&(F+=(F.indexOf("?")<0?"?":/\?$|&$/.test(F)?"":"&")+O);try{y.auth&&H(y.auth)?y.auth.hasOwnProperty("user")&&(y.auth.hasOwnProperty("pwd")?c.open(m,F,y.async,y.auth.user,y.auth.pwd):c.open(m,F,y.async,y.auth.user)):c.open(m,F,y.async);var E,j=X(y,"beforeSend"),b=!0;if(j&&q(j))try{b=(b=j.call(c,c,y))||U(b),O=y.data}catch(e){b=!1,console.warn("beforeSend function failed.",e,v)}b?(E=y.headers,H(E)&&Object.keys(E).forEach(function(e){c.setRequestHeader(e,E[e])}),y.timeout&&(c.timeout=y.timeout,u=setTimeout(function(){p=!0,v.isPending&&0<c.readyState&&c.readyState<4&&c.abort()},y.timeout)),"GET"!==m&&O?(O=D(O)?O:JSON.stringify(O),y.async?d=setTimeout(function(){c.send(O)},S):c.send(O)):y.async?d=setTimeout(function(){c.send()},S):c.send()):(f=!0,c.abort(),w())}catch(e){console.warn("XHR-Exception",c,e)}return v}function w(e){var t=this,n=t.status;if(h&&h.call(y,t,e),f||4===t.readyState){v.isPending=!1,v.readyState=t.readyState,v.status=t.status,v.responseText=t.responseText,v.response=t.responseText;var s,a,r=t.responseText;if(200<=n&&n<300||304===n){if(v.isSuccess=!0,v.statusText="success",v.statusMessage="OK",(s=A(y,"dataParser")?y.dataParser:_.dataParsers[l])&&q(s))try{a=s(r,l)}catch(e){console.warn("dataParsing failed.",r,v,e)}U(a)||(r=a);var i,o=X(y,"dataFilter");if(o&&q(o))try{i=o.call(v.reqOptions,r,l)}catch(e){console.warn("dataFilter failed.",r,v,e)}U(i)||(r=i),"json"===l&&(v.responseJSON=r)}else r=t.responseText,v.isFailed=!0,u&&p?(v.statusText="timeout",v.statusMessage="timeout"):f?(v.statusText="canceled",v.statusMessage="canceled"):(v.statusText="error",v.statusMessage=J[n]||"Unknown Error");v.response=r,v.isSuccess?c("then"):v.isFailed&&c("fail"),c("done"),C([u,d])}function c(e){for(var t,n=T[e];0<n.length;)try{v.isFailed?(t=void 0===v.prevFnRes?v:v.prevFnRes,v.prevFnRes=n.shift().call(y,t,v.statusText,v.statusMessage,v.response)):(t=void 0===v.prevFnRes?v.response:v.prevFnRes,v.prevFnRes=n.shift().call(y,t,v.statusText,v,v.response)),M(v,v.prevFnRes,e)}catch(e){console.error("Function Execution Error.",e)}}}console.error("XHR without URL.",arguments,a)}function V(){return G.apply(t,o(arguments))}e(K,_),e(V,{ajax:K,ajaxQ:G,when:G,defer:G,ajaxSetup:b,ajaxPrefilter:w}),t.spaXHR=V}(this);