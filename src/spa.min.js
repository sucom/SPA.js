/** @license SPA.js | (c) Kumararaja | License (MIT) */
window.app=window.app||{api:{}},window.app.api=window.app.api||{},function(){for(var e,a=function(){},t=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],n=t.length,r=window.console=window.console||{};n--;)e=t[n],r[e]||(r[e]=a);"none"in window||(window.none=""),"noop"in window||(window.noop=function(){})}(),function(){function e(e,a){return e>a}function a(e){return e}function t(e,a,t){for(var n=-1,r=e.length;r>++n;){var s=e[n],o=a(s);if(null!=o&&(void 0===i?o===o&&!sa(o):t(o,i)))var i=o,p=s}return p}function n(n){return n&&n.length?t(n,a,e):void 0}function r(e){return e}function s(e,a,t){if(!K(t))return!1;var n=typeof a;return("number"==n?aa(t)&&ea(a,t.length):"string"==n&&a in t)?ua(t[a],e):!1}function o(e,a){return Xt.setToString(Xt.overRest(e,a,r),e+"")}function i(e){return o(function(a,t){var n=-1,r=t.length,s=r>1?t[r-1]:void 0,o=r>2?t[2]:void 0;for(s=e.length>3&&"function"==typeof s?(r--,s):void 0,o&&isIterateeCall(t[0],t[1],o)&&(s=3>r?void 0:s,r=1),a=Object(a);r>++n;){var i=t[n];i&&e(a,i,n,s)}return a})}function p(e,a,t){var n=-1,r=ft,s=e.length,o=!0,i=[],p=i;if(t)o=!1,r=mt;else if(s>=Xt.LARGE_ARRAY_SIZE){var l=a?null:Xt.createSet(e);if(l)return Xt.setToArray(l);o=!1,r=_t,p=new Xt.SetCache}else p=a?[]:i;e:for(;s>++n;){var c=e[n],u=a?a(c):c;if(c=t||0!==c?c:0,o&&u===u){for(var d=p.length;d--;)if(p[d]===u)continue e;a&&p.push(u),i.push(c)}else r(p,u,t)||(p!==i&&p.push(u),i.push(c))}return i}function l(e){return W(e)&&aa(e)}function c(e,a,t,n,r){var s=-1,o=e.length;for(t||(t=ia),r||(r=[]);o>++s;){var i=e[s];a>0&&t(i)?a>1?c(i,a-1,t,n,r):ct(r,i):n||(r[r.length]=i)}return r}function u(e){var a=null==e?0:e.length;return a?c(e,1):[]}function d(e){var a=e.length,t=e.constructor(a);return a&&"string"==typeof e[0]&&en.call(e,"index")&&(t.index=e.index,t.input=e.input),t}function f(e,a,t){var n=a(e);return X(e)?n:ct(n,t(e))}function m(e){return f(e,D,ln)}function g(e,a){return a=h(a,e),e=nt(e,a),null==e||delete e[ga(ba(a))]}function h(e,a){return X(e)?e:na(e,a)?[e]:Ca(va(e))}function v(e){return Xt.setToString(Xt.overRest(e,void 0,u),e+"")}function y(e){if(!W(e)||rt(e)!=Xt.objectTag)return!1;var a=sn(e);if(null===a)return!0;var t=en.call(a,"constructor")&&a.constructor;return"function"==typeof t&&t instanceof t&&tn.call(t)==nn}function _(e){return y(e)?void 0:e}function b(e,a){var t=-1,n=e.length;for(a||(a=Array(n));n>++t;)a[t]=e[t];return a}function S(e,a,t,n){var r=!t;t||(t={});for(var s=-1,o=a.length;o>++s;){var i=a[s],p=n?n(t[i],e[i],i,t,e):void 0;void 0===p&&(p=e[i]),r?it(t,i,p):I(t,i,p)}return t}function O(e,a){if(a)return e.slice();var t=e.length,n=an?an(t):new e.constructor(t);return e.copy(n),n}function C(e){return"function"!=typeof e.constructor||ra(e)?{}:Xt.baseCreate(sn(e))}function T(e){var a=new e.constructor(e.byteLength);return new Xt.Uint8Array(a).set(new Xt.Uint8Array(e)),a}function w(e,a){var t=a?T(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}function k(e){var a=-1,t=Array(e.size);return e.forEach(function(e,n){t[++a]=[n,e]}),t}function R(e,a,t,n){var r=-1,s=null==e?0:e.length;for(n&&s&&(t=e[++r]);s>++r;)t=a(t,e[r],r,e);return t}function N(e,a){var t=a?T(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)}function $(e){var a=new e.constructor(e.source,Xt.reFlags.exec(e));return a.lastIndex=e.lastIndex,a}function A(e,a){return e.set(a[0],a[1]),e}function x(e,a){return e.add(a),e}function E(e,a,t){var n=a?t(k(e),Xt.CLONE_DEEP_FLAG):k(e);return R(n,A,new e.constructor)}function P(e,a,t){var n=a?t(Xt.setToArray(e),Xt.CLONE_DEEP_FLAG):Xt.setToArray(e);return R(n,x,new e.constructor)}function j(e){return Xt.symbolValueOf?Object(Xt.symbolValueOf.call(e)):{}}function L(e,a,t,n){var r=e.constructor;switch(a){case Xt.numberTag:case Xt.stringTag:return new r(e);case Xt.boolTag:case Xt.dateTag:return new r(+e);case Xt.arrayBufferTag:return T(e);case Xt.float32Tag:case Xt.float64Tag:case Xt.int8Tag:case Xt.int16Tag:case Xt.int32Tag:case Xt.uint8Tag:case Xt.uint8ClampedTag:case Xt.uint16Tag:case Xt.uint32Tag:return w(e,n);case Xt.mapTag:return E(e,n,t);case Xt.dataViewTag:return N(e,n);case Xt.regexpTag:return $(e);case Xt.setTag:return P(e,n,t);case Xt.symbolTag:return j(e)}}function I(e,a,t){var n=e[a];en.call(e,a)&&ua(n,t)&&(void 0!==t||a in e)||it(e,a,t)}function U(e){return K(e)?Qa(e):J(e)?Qa(e.split("")):[]}function D(e){return aa(e)?et(e,!0):Za(e)}function B(e){return f(e,keys,Xt.getSymbols)}function M(e,a){return S(e,Xt.getSymbols(e),a)}function V(e,a){return S(e,ln(e),a)}function F(e,a){return e&&S(a,U(a),e)}function H(e,a){return e&&S(a,D(a),e)}function z(e,a){for(var t=-1,n=null==e?0:e.length;n>++t&&a(e[t],t,e)!==!1;);return e}function q(e,a,t,n,r,s){var o,i=a&CLONE_DEEP_FLAG,p=a&CLONE_FLAT_FLAG,l=a&CLONE_SYMBOLS_FLAG;if(t&&(o=r?t(e,n,r,s):t(e)),void 0!==o)return o;if(!K(e))return e;var c=X(e);if(c){if(o=d(e),!i)return b(e,o)}else{var u=ot(e),f=u==Xt.funcTag||u==Xt.genTag;if(Qt(e))return O(e,i);if(u==Xt.objectTag||u==Xt.argsTag||f&&!r){if(o=p||f?{}:C(e),!i)return p?V(e,H(o,e)):M(e,F(o,e))}else{if(!Xt.cloneableTags[u])return r?e:{};o=L(e,u,q,i)}}s||(s=new Xt.Stack);var g=s.get(e);if(g)return g;s.set(e,o);var h=l?p?m:B:p?D:U,v=c?void 0:h(e);return z(v||e,function(n,r){v&&(r=n,n=e[r]),I(o,r,q(n,a,t,r,e,s))}),o}function J(e){return"string"==typeof e||!X(e)&&W(e)&&rt(e)==Xt.stringTag}function K(e){var a=typeof e;return null!=e&&("object"==a||"function"==a)}function W(e){return null!=e&&"object"==typeof e}function G(e){return null!=e&&"function"==typeof e}function X(e){return"[object Array]"===Object.prototype.toString.call(e)}function Q(e){return e===!0||e===!1||W(e)&&rt(e)==Xt.boolTag}function Y(e){return"number"==typeof e||W(e)&&rt(e)==Xt.numberTag}function Z(e){return"number"==typeof e&&e>-1&&0==e%1&&Xt.MAX_SAFE_INTEGER>=e}function ea(e,a){return a=null==a?Xt.MAX_SAFE_INTEGER:a,!!a&&("number"==typeof e||Xt.reIsUint.test(e))&&e>-1&&0==e%1&&a>e}function aa(e){return null!=e&&Z(e.length)&&!G(e)}function ta(e){var a=typeof e;return"undefined"==a||null==e?!0:"string"==a||"[object Array]"===Object.prototype.toString.call(e)?!e.length:"object"==a?!Object.keys(e).length:!1}function na(e,a){if(X(e))return!1;var t=typeof e;return"number"==t||"symbol"==t||"boolean"==t||null==e?!0:Xt.reIsPlainProp.test(e)||!Xt.reIsDeepProp.test(e)||null!=a&&e in Object(a)}function ra(e){var a=e&&e.constructor,t="function"==typeof a&&a.prototype||Xt.objectProto;return e===t}function sa(e){return"symbol"==typeof e||W(e)&&ot(e)==Xt.symbolTag}function oa(e){return W(e)&&Z(e.length)&&!!Xt.typedArrayTags[ot(e)]}function ia(e){return X(e)||!!(Xt.spreadableSymbol&&e&&e[Xt.spreadableSymbol])}function pa(e){return Yt.call(e)}function la(e){return e===e&&!K(e)}function ca(e){return S(e,D(e))}function ua(e,a){return e===a||e!==e&&a!==a}function da(e,a){for(var t=e.length;t--;)if(ua(e[t][0],a))return t;return-1}function fa(e){return e!==e}function ma(e){var a=Xt.INFINITY,t=Xt.MAX_INTEGER;if(!e)return 0===e?e:0;if(e=1*e,e===a||e===-a){var n=0>e?-1:1;return n*t}return e===e?e:0}function ga(e){if("string"==typeof e)return e;var a=e+"";return"0"==a&&1/e==-Xt.INFINITY?"-0":a}function ha(e){if("string"==typeof e)return e;if(X(e))return _a(e,ha)+"";var a=e+"";return"0"==a&&1/e==-Xt.INFINITY?"-0":a}function va(e){return null==e?"":ha(e)}function ya(e){var a=ma(e),t=a%1;return a===a?t?a-t:a:0}function _a(e,a){for(var t=-1,n=null==e?0:e.length,r=Array(n);n>++t;)r[t]=a(e[t],t,e);return r}function ba(e){var a=null==e?0:e.length;return a?e[a-1]:void 0}function Sa(e,a,t,n){for(var r=-1,s=Math.max(Math.ceil((a-e)/(t||1)),0),o=Array(s);s--;)o[n?s:++r]=e,e+=t;return o}function Oa(e,a,t){return t&&"number"!=typeof t&&(t=void 0),e=ma(e),void 0===a?(a=e,e=0):a=ma(a),t=void 0===t?a>e?1:-1:ma(t),Sa(e,a,t,!1)}function Ca(e){var a=[];return Xt.reLeadingDot.test(e)&&a.push(""),e.replace(Xt.rePropName,function(e,t,n,r){a.push(n?r.replace(Xt.reEscapeChar,"$1"):t||e)}),a}function Ta(e,a,t){a=h(a,e);for(var n=-1,r=a.length,s=!1;r>++n;){var o=ga(a[n]);if(!(s=null!=e&&t(e,o)))break;e=e[o]}return s||++n!=r?s:(r=null==e?0:e.length,!!r&&Z(r)&&X(e))}function wa(e,a){return null!=e&&en.call(e,a)}function ka(e,a){return null!=e&&Ta(e,a,wa)}function Ra(e,a){return null!=e&&a in Object(e)}function Na(e,a){return null!=e&&Ta(e,a,Ra)}function $a(e,a){return pt(e||[],a||[],I)}function Aa(e,a,t){var n=null==e?0:e.length;if(!n)return-1;var r=null==t?0:ya(t);return 0>r&&(r=Math.max(n+r,0)),Wa(e,a,r)}function xa(e,a,t){var n=null==e?void 0:tt(e,a);return void 0===n?t:n}function Ea(e,a,t){var n=null==e?0:e.length;if(!n)return-1;var r=null==t?0:ya(t);return 0>r&&(r=Math.max(n+r,0)),Ct(e,Pt(a,3),r)}function Pa(e,a,t){var n=Object(e);if(!aa(e)){var r=Pt(a,3);e=U(e),a=function(e){return r(n[e],e,n)}}var s=Ea(e,a,t);return s>-1?n[r?e[s]:s]:void 0}function ja(e){return na(e)?At(ga(e)):xt(e)}function La(e,a){var t=[];if(!e||!e.length)return t;var n=-1,r=[],s=e.length;for(a=Pt(a,3);s>++n;){var o=e[n];a(o,n,e)&&(t.push(o),r.push(n))}return jt(e,r),t}function Ia(e,a){return e&&e.length&&a&&a.length?Bt(e,a):e}function Ua(e,a){var t=X(e)?z:dn;return t(e,Pt(a,3))}function Da(e,a,t){var n=X(e)?ut:Mt;return t&&s(e,a,t)&&(a=void 0),n(e,Pt(a,3))}function Ba(e,a){var t=X(e)?_a:Vt;return t(e,Pt(a,3))}function Ma(e,a,t){var n=X(e)?dt:Ft;return t&&s(e,a,t)&&(a=void 0),n(e,Pt(a,3))}function Va(e){return e&&e.length?p(e):[]}function Fa(e,a){var t=X(e)?gt:qt;return t(e,Pt(a,3))}function Ha(e,a){return function(t){return null==t?!1:t[e]===a&&(void 0!==a||e in Object(t))}}function za(e,a){return na(e)&&la(a)?Ha(ga(e),a):function(t){var n=xa(t,e);return void 0===n&&n===a?Na(t,e):wt(a,n,Xt.COMPARE_PARTIAL_FLAG|Xt.COMPARE_UNORDERED_FLAG)}}function qa(e,a){return Ja(e,a,function(a,t){return Na(e,t)})}function Ja(e,a,t){for(var n=-1,r=a.length,s={};r>++n;){var o=a[n],i=tt(e,o);t(i,o)&&Ka(s,h(o,e),i)}return s}function Ka(e,a,t,n){if(!K(e))return e;a=h(a,e);for(var r=-1,s=a.length,o=s-1,i=e;null!=i&&s>++r;){var p=ga(a[r]),l=t;if(r!=o){var c=i[p];l=n?n(c,p,i):void 0,void 0===l&&(l=K(c)?c:ea(a[r+1])?[]:{})}I(i,p,l),i=i[p]}return e}function Wa(e,a,t){return a===a?Ot(e,a,t):Ct(e,fa,t)}function Ga(e,a,t,n){for(var r=t-1,s=e.length;s>++r;)if(n(e[r],a))return r;return-1}function Xa(e,a){for(var t=-1,n=Array(e);e>++t;)n[t]=a(t);return n}function Qa(e){if(!ra(e))return rn(e);var a=[];for(var t in Object(e))en.call(e,t)&&"constructor"!=t&&a.push(t);return a}function Ya(e){var a=[];if(null!=e)for(var t in Object(e))a.push(t);return a}function Za(e){if(!K(e))return Ya(e);var a=ra(e),t=[];for(var n in e)("constructor"!=n||!a&&en.call(e,n))&&t.push(n);return t}function et(e,a){var t=X(e),n=!t&&un(e),r=!t&&!n&&Qt(e),s=!t&&!n&&!r&&oa(e),o=t||n||r||s,i=o?Xa(e.length,String):[],p=i.length;for(var l in e)!a&&!en.call(e,l)||o&&("length"==l||r&&("offset"==l||"parent"==l)||s&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||ea(l,p))||i.push(l);return i}function at(e,a,t){var n=-1,r=e.length;0>a&&(a=-a>r?0:r+a),t=t>r?r:t,0>t&&(t+=r),r=a>t?0:t-a>>>0,a>>>=0;for(var s=Array(r);r>++n;)s[n]=e[n+a];return s}function tt(e,a){a=h(a,e);for(var t=0,n=a.length;null!=e&&n>t;)e=e[ga(a[t++])];return t&&t==n?e:void 0}function nt(e,a){return 2>a.length?e:tt(e,at(a,0,-1))}function rt(e){return null==e?void 0===e?Xt.undefinedTag:Xt.nullTag:Xt.symToStringTag&&Xt.symToStringTag in Object(e)?st(e):pa(e)}function st(e){var a=en.call(e,Xt.symToStringTag),t=e[Xt.symToStringTag];try{e[Xt.symToStringTag]=void 0;var n=!0}catch(r){}var s=Yt.call(e);return n&&(a?e[Xt.symToStringTag]=t:delete e[Xt.symToStringTag]),s}function ot(e){return null==e?void 0===e?Xt.undefinedTag:Xt.nullTag:Xt.symToStringTag&&Xt.symToStringTag in Object(e)?st(e):pa(e)}function it(e,a,t){"__proto__"==a&&Xt.defineProperty?Xt.defineProperty(e,a,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[a]=t}function pt(e,a,t){for(var n=-1,r=e.length,s=a.length,o={};r>++n;){var i=s>n?a[n]:void 0;t(o,e[n],i)}return o}function lt(e,a){for(var t=-1,n=a.length,r=Array(n),s=null==e;n>++t;)r[t]=s?void 0:xa(e,a[t]);return r}function ct(e,a){for(var t=-1,n=a.length,r=e.length;n>++t;)e[r+t]=a[t];return e}function ut(e,a){for(var t=-1,n=null==e?0:e.length;n>++t;)if(!a(e[t],t,e))return!1;return!0}function _a(e,a){for(var t=-1,n=null==e?0:e.length,r=Array(n);n>++t;)r[t]=a(e[t],t,e);return r}function dt(e,a){for(var t=-1,n=null==e?0:e.length;n>++t;)if(a(e[t],t,e))return!0;return!1}function ft(e,a){var t=null==e?0:e.length;return!!t&&Wa(e,a,0)>-1}function mt(e,a,t){for(var n=-1,r=null==e?0:e.length;r>++n;)if(t(a,e[n]))return!0;return!1}function gt(e,a){for(var t=-1,n=null==e?0:e.length,r=0,s=[];n>++t;){var o=e[t];a(o,t,e)&&(s[r++]=o)}return s}function ht(e,a,t,n,r,s){var o=t&Xt.COMPARE_PARTIAL_FLAG,i=e.length,p=a.length;if(i!=p&&!(o&&p>i))return!1;var l=s.get(e);if(l&&s.get(a))return l==a;var c=-1,u=!0,d=t&Xt.COMPARE_UNORDERED_FLAG?new Xt.SetCache:void 0;for(s.set(e,a),s.set(a,e);i>++c;){var f=e[c],m=a[c];if(n)var g=o?n(m,f,c,a,e,s):n(f,m,c,e,a,s);if(void 0!==g){if(g)continue;u=!1;break}if(d){if(!dt(a,function(e,a){return _t(d,a)||f!==e&&!r(f,e,t,n,s)?void 0:d.push(a)})){u=!1;break}}else if(f!==m&&!r(f,m,t,n,s)){u=!1;break}}return s["delete"](e),s["delete"](a),u}function vt(e,a,t,n,r,s,o){switch(t){case Xt.dataViewTag:if(e.byteLength!=a.byteLength||e.byteOffset!=a.byteOffset)return!1;e=e.buffer,a=a.buffer;case Xt.arrayBufferTag:return e.byteLength==a.byteLength&&s(new Xt.Uint8Array(e),new Xt.Uint8Array(a))?!0:!1;case Xt.boolTag:case Xt.dateTag:case Xt.numberTag:return ua(+e,+a);case Xt.errorTag:return e.name==a.name&&e.message==a.message;case Xt.regexpTag:case Xt.stringTag:return e==a+"";case Xt.mapTag:var i=k;case Xt.setTag:var p=n&Xt.COMPARE_PARTIAL_FLAG;if(i||(i=Xt.setToArray),e.size!=a.size&&!p)return!1;var l=o.get(e);if(l)return l==a;n|=Xt.COMPARE_UNORDERED_FLAG,o.set(e,a);var c=ht(i(e),i(a),n,r,s,o);return o["delete"](e),c;case Xt.symbolTag:if(Xt.symbolValueOf)return Xt.symbolValueOf.call(e)==Xt.symbolValueOf.call(a)}return!1}function yt(e,a,t,n,r,s){var o=t&Xt.COMPARE_PARTIAL_FLAG,i=B(e),p=i.length,l=B(a),c=l.length;if(p!=c&&!o)return!1;for(var u=p;u--;){var d=i[u];if(!(o?d in a:en.call(a,d)))return!1}var f=s.get(e);if(f&&s.get(a))return f==a;var m=!0;s.set(e,a),s.set(a,e);for(var g=o;p>++u;){d=i[u];var h=e[d],v=a[d];if(n)var y=o?n(v,h,d,a,e,s):n(h,v,d,e,a,s);if(!(void 0===y?h===v||r(h,v,t,n,s):y)){m=!1;break}g||(g="constructor"==d)}if(m&&!g){var _=e.constructor,b=a.constructor;_!=b&&"constructor"in e&&"constructor"in a&&!("function"==typeof _&&_ instanceof _&&"function"==typeof b&&b instanceof b)&&(m=!1)}return s["delete"](e),s["delete"](a),m}function _t(e,a){return e.has(a)}function bt(e,a){if(e!==a){var t=void 0!==e,n=null===e,r=e===e,s=sa(e),o=void 0!==a,i=null===a,p=a===a,l=sa(a);if(!i&&!l&&!s&&e>a||s&&o&&p&&!i&&!l||n&&o&&p||!t&&p||!r)return 1;if(!n&&!s&&!l&&a>e||l&&t&&r&&!n&&!s||i&&t&&r||!o&&r||!p)return-1}return 0}function St(e,a,t){for(var n=-1,r=e.criteria,s=a.criteria,o=r.length,i=t.length;o>++n;){var p=bt(r[n],s[n]);if(p){if(n>=i)return p;var l=t[n];return p*("desc"==l?-1:1)}}return e.index-a.index}function Ot(e,a,t){for(var n=t-1,r=e.length;r>++n;)if(e[n]===a)return n;return-1}function Ct(e,a,t,n){for(var r=e.length,s=t+(n?1:-1);n?s--:r>++s;)if(a(e[s],s,e))return s;return-1}function Tt(e,a,t,n,r,s){var o=X(e),i=X(a),p=o?Xt.arrayTag:ot(e),l=i?Xt.arrayTag:ot(a);p=p==Xt.argsTag?Xt.objectTag:p,l=l==Xt.argsTag?Xt.objectTag:l;var c=p==Xt.objectTag,u=l==Xt.objectTag,d=p==l;if(d&&Qt(e)){if(!Qt(a))return!1;o=!0,c=!1}if(d&&!c)return s||(s=new Xt.Stack),o||oa(e)?ht(e,a,t,n,r,s):vt(e,a,p,t,n,r,s);if(!(t&Xt.COMPARE_PARTIAL_FLAG)){var f=c&&en.call(e,"__wrapped__"),m=u&&en.call(a,"__wrapped__");if(f||m){var g=f?e.value():e,h=m?a.value():a;return s||(s=new Xt.Stack),r(g,h,t,n,s)}}return d?(s||(s=new Xt.Stack),yt(e,a,t,n,r,s)):!1}function wt(e,a,t,n,r){return e===a?!0:null==e||null==a||!W(e)&&!W(a)?e!==e&&a!==a:Tt(e,a,t,n,wt,r)}function kt(e,a,t,n){var r=t.length,s=r,o=!n;if(null==e)return!s;for(e=Object(e);r--;){var i=t[r];if(o&&i[2]?i[1]!==e[i[0]]:!(i[0]in e))return!1}for(;s>++r;){i=t[r];var p=i[0],l=e[p],c=i[1];if(o&&i[2]){if(void 0===l&&!(p in e))return!1}else{var u=new Xt.Stack;if(n)var d=n(l,c,p,e,a,u);if(!(void 0===d?wt(c,l,Xt.COMPARE_PARTIAL_FLAG|Xt.COMPARE_UNORDERED_FLAG,n,u):d))return!1}}return!0}function Rt(e){return W(e)&&rt(e)==Xt.argsTag}function Nt(e){for(var a=U(e),t=a.length;t--;){var n=a[t],r=e[n];a[t]=[n,r,la(r)]}return a}function $t(e){var a=Nt(e);return 1==a.length&&a[0][2]?Ha(a[0][0],a[0][1]):function(t){return t===e||kt(t,e,a)}}function At(e){return function(a){return null==a?void 0:a[e]}}function xt(e){return function(a){return tt(a,e)}}function Et(e){return"function"==typeof e?e:null==e?r:"object"==typeof e?X(e)?za(e[0],e[1]):$t(e):ja(e)}function Pt(){var e=Et;return arguments.length?e(arguments[0],arguments[1]):e}function jt(e,a){for(var t=e?a.length:0,n=t-1;t--;){var r=a[t];if(t==n||r!==s){var s=r;ea(r)?Xt.splice.call(e,r,1):g(e,r)}}return e}function Lt(e){return function(a){return e(a)}}function It(e,a,t,n){for(var r=-1,s=Object(e),o=t(e),i=o.length;i--;){var p=o[n?i:++r];if(a(s[p],p,s)===!1)break}return e}function Ut(e,a){return e&&It(e,a,U)}function Dt(e,a){return function(t,n){if(null==t)return t;if(!aa(t))return e(t,n);for(var r=t.length,s=a?r:-1,o=Object(t);(a?s--:r>++s)&&n(o[s],s,o)!==!1;);return t}}function Bt(e,a,t,n){var r=n?Ga:Wa,s=-1,o=a.length,i=e;for(e===a&&(a=b(a)),t&&(i=_a(e,Lt(t)));o>++s;)for(var p=0,l=a[s],c=t?t(l):l;(p=r(i,c,p,n))>-1;)i!==e&&Xt.splice.call(i,p,1),Xt.splice.call(e,p,1);return e}function Mt(e,a){var t=!0;return dn(e,function(e,n,r){return t=!!a(e,n,r)}),t}function Vt(e,a){var t=-1,n=aa(e)?Array(e.length):[];return dn(e,function(e,r,s){n[++t]=a(e,r,s)}),n}function Ft(e,a){var t;return dn(e,function(e,n,r){return t=a(e,n,r),!t}),!!t}function Ht(e,a){var t=e.length;for(e.sort(a);t--;)e[t]=e[t].value;return e}function zt(e,a,t){var n=-1;a=_a(a.length?a:[r],Lt(Pt()));var s=Vt(e,function(e){var t=_a(a,function(a){return a(e)});return{criteria:t,index:++n,value:e}});return Ht(s,function(e,a){return St(e,a,t)})}function qt(e,a){var t=[];return dn(e,function(e,n,r){a(e,n,r)&&t.push(e)}),t}function Jt(e,a,t){(void 0!==t&&!ua(e[a],t)||void 0===t&&!(a in e))&&it(e,a,t)}function Kt(e,a,t,n,r,s,o){var i=e[t],p=a[t],c=o.get(p);if(c)return Jt(e,t,c),void 0;var u=s?s(i,p,t+"",e,a,o):void 0,d=void 0===u;if(d){var f=X(p),m=!f&&Qt(p),g=!f&&!m&&oa(p);u=p,f||m||g?X(i)?u=i:l(i)?u=b(i):m?(d=!1,u=O(p,!0)):g?(d=!1,u=w(p,!0)):u=[]:y(p)||un(p)?(u=i,un(i)?u=ca(i):(!K(i)||n&&G(i))&&(u=C(p))):d=!1}d&&(o.set(p,u),r(u,p,n,s,o),o["delete"](p)),Jt(e,t,u)}function Wt(e,a,t,n,r){e!==a&&It(a,function(s,o){if(K(s))r||(r=new Xt.Stack),Kt(e,a,o,t,Wt,n,r);else{var i=n?n(e[o],s,o+"",e,a,r):void 0;void 0===i&&(i=s),Jt(e,o,i)}},D)}function Gt(e){return o(function(a,t){var n=-1,r=t.length,o=r>1?t[r-1]:void 0,i=r>2?t[2]:void 0;for(o=e.length>3&&"function"==typeof o?(r--,o):void 0,i&&s(t[0],t[1],i)&&(o=3>r?void 0:o,r=1),a=Object(a);r>++n;){var p=t[n];p&&e(a,p,n,o)}return a})}if(!window._){var Xt={MAX_INTEGER:1.7976931348623157e308,MAX_SAFE_INTEGER:9007199254740991,INFINITY:1/0,reIsDeepProp:/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp:/^\w*$/,reLeadingDot:/^\./,rePropName:/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar:/\\(\\)?/g,reIsUint:/^(?:0|[1-9]\d*)$/,reFlags:/\w*$/,spreadableSymbol:window.Symbol?Symbol.isConcatSpreadable:void 0,symToStringTag:window.Symbol?Symbol.toStringTag:void 0,nativeIsBuffer:window.Buffer?Buffer.isBuffer:void 0,Uint8Array:window.Uint8Array,Map:window.Map?window.Map:void 0,Set:window.Set?window.Set:void 0,nativeCreate:window.Object?Object.create?Object.create:void 0:void 0,nativeGetSymbols:Object.getOwnPropertySymbols,arrayProto:Array.prototype,splice:Array.prototype.splice,funcProto:Function.prototype,objectProto:Object.prototype,objectCreate:Object.create,symbolProto:window.Symbol?Symbol.prototype:void 0,symbolValueOf:window.Symbol&&Symbol.prototype?Symbol.prototype.valueOf:void 0,symbolToString:window.Symbol&&Symbol.prototype?Symbol.prototype.toString:void 0,HASH_UNDEFINED:"__lodash_hash_undefined__",COMPARE_PARTIAL_FLAG:1,COMPARE_UNORDERED_FLAG:2,LARGE_ARRAY_SIZE:200,HOT_COUNT:800,HOT_SPAN:16,CLONE_DEEP_FLAG:1,CLONE_FLAT_FLAG:2,CLONE_SYMBOLS_FLAG:4,argsTag:"[object Arguments]",arrayTag:"[object Array]",asyncTag:"[object AsyncFunction]",boolTag:"[object Boolean]",dateTag:"[object Date]",domExcTag:"[object DOMException]",errorTag:"[object Error]",funcTag:"[object Function]",genTag:"[object GeneratorFunction]",mapTag:"[object Map]",numberTag:"[object Number]",nullTag:"[object Null]",objectTag:"[object Object]",promiseTag:"[object Promise]",proxyTag:"[object Proxy]",regexpTag:"[object RegExp]",setTag:"[object Set]",stringTag:"[object String]",symbolTag:"[object Symbol]",undefinedTag:"[object Undefined]",weakMapTag:"[object WeakMap]",weakSetTag:"[object WeakSet]",arrayBufferTag:"[object ArrayBuffer]",dataViewTag:"[object DataView]",float32Tag:"[object Float32Array]",float64Tag:"[object Float64Array]",int8Tag:"[object Int8Array]",int16Tag:"[object Int16Array]",int32Tag:"[object Int32Array]",uint8Tag:"[object Uint8Array]",uint8ClampedTag:"[object Uint8ClampedArray]",uint16Tag:"[object Uint16Array]",uint32Tag:"[object Uint32Array]",setToArray:function(e){var a=-1,t=Array(e.size);return e.forEach(function(e){t[++a]=e}),t},apply:function(e,a,t){switch(t.length){case 0:return e.call(a);case 1:return e.call(a,t[0]);case 2:return e.call(a,t[0],t[1]);case 3:return e.call(a,t[0],t[1],t[2])}return e.apply(a,t)},overArg:function(e,a){return function(t){return e(a(t))}},stubFalse:function(){return!1},stubArray:function(){return[]},constant:function(e){return function(){return e}},defineProperty:function(){try{var e=Object.defineProperty;return e({},"",{}),e}catch(a){}}(),baseCreate:function(){function e(){}return function(a){var t=typeof a;if(null==a||"object"!=t&&"function"!=t)return{};if(Object.create)return Object.create(a);e.prototype=a;var n=new e;return e.prototype=void 0,n}}(),isKeyable:function(e){var a=typeof e;return"string"==a||"number"==a||"symbol"==a||"boolean"==a?"__proto__"!==e:null===e},getMapData:function(e,a){var t=e.__data__;return Xt.isKeyable(a)?t["string"==typeof a?"string":"hash"]:t.map},typedArrayTags:{},cloneableTags:{}},Qt=Xt.nativeIsBuffer||Xt.stubFalse,Yt=Xt.objectProto.toString,Zt=Xt.objectProto.propertyIsEnumerable,en=Xt.objectProto.hasOwnProperty,an=Xt.nativeIsBuffer?Buffer.allocUnsafe:void 0,tn=Xt.funcProto.toString,nn=Xt.funcProto.toString.call(Object);Xt.typedArrayTags[Xt.float32Tag]=Xt.typedArrayTags[Xt.float64Tag]=Xt.typedArrayTags[Xt.int8Tag]=Xt.typedArrayTags[Xt.int16Tag]=Xt.typedArrayTags[Xt.int32Tag]=Xt.typedArrayTags[Xt.uint8Tag]=Xt.typedArrayTags[Xt.uint8ClampedTag]=Xt.typedArrayTags[Xt.uint16Tag]=Xt.typedArrayTags[Xt.uint32Tag]=!0,Xt.typedArrayTags[Xt.argsTag]=Xt.typedArrayTags[Xt.arrayTag]=Xt.typedArrayTags[Xt.arrayBufferTag]=Xt.typedArrayTags[Xt.boolTag]=Xt.typedArrayTags[Xt.dataViewTag]=Xt.typedArrayTags[Xt.dateTag]=Xt.typedArrayTags[Xt.errorTag]=Xt.typedArrayTags[Xt.funcTag]=Xt.typedArrayTags[Xt.mapTag]=Xt.typedArrayTags[Xt.numberTag]=Xt.typedArrayTags[Xt.objectTag]=Xt.typedArrayTags[Xt.regexpTag]=Xt.typedArrayTags[Xt.setTag]=Xt.typedArrayTags[Xt.stringTag]=Xt.typedArrayTags[Xt.weakMapTag]=!1,Xt.cloneableTags[Xt.argsTag]=Xt.cloneableTags[Xt.arrayTag]=Xt.cloneableTags[Xt.arrayBufferTag]=Xt.cloneableTags[Xt.dataViewTag]=Xt.cloneableTags[Xt.boolTag]=Xt.cloneableTags[Xt.dateTag]=Xt.cloneableTags[Xt.float32Tag]=Xt.cloneableTags[Xt.float64Tag]=Xt.cloneableTags[Xt.int8Tag]=Xt.cloneableTags[Xt.int16Tag]=Xt.cloneableTags[Xt.int32Tag]=Xt.cloneableTags[Xt.mapTag]=Xt.cloneableTags[Xt.numberTag]=Xt.cloneableTags[Xt.objectTag]=Xt.cloneableTags[Xt.regexpTag]=Xt.cloneableTags[Xt.setTag]=Xt.cloneableTags[Xt.stringTag]=Xt.cloneableTags[Xt.symbolTag]=Xt.cloneableTags[Xt.uint8Tag]=Xt.cloneableTags[Xt.uint8ClampedTag]=Xt.cloneableTags[Xt.uint16Tag]=Xt.cloneableTags[Xt.uint32Tag]=!0,Xt.cloneableTags[Xt.errorTag]=Xt.cloneableTags[Xt.funcTag]=Xt.cloneableTags[Xt.weakMapTag]=!1,Xt.baseSetToString=Xt.defineProperty?function(e,a){return Xt.defineProperty(e,"toString",{configurable:!0,enumerable:!1,value:Xt.constant(a),writable:!0})}:function(e){return e},Xt.shortOut=function(e){var a=0,t=0;return function(){var n=Date.now(),r=Xt.HOT_SPAN-(n-t);if(t=n,r>0){if(++a>=Xt.HOT_COUNT)return arguments[0]}else a=0;return e.apply(void 0,arguments)}},Xt.overRest=function(e,a,t){return a=Math.max(void 0===a?e.length-1:a,0),function(){for(var n=arguments,r=-1,s=Math.max(n.length-a,0),o=Array(s);s>++r;)o[r]=n[a+r];r=-1;for(var i=Array(a+1);a>++r;)i[r]=n[r];return i[a]=t(o),Xt.apply(e,this,i)}},Xt.Hash=function(e){var a=-1,t=null==e?0:e.length;for(this.clear();t>++a;){var n=e[a];this.set(n[0],n[1])}},Xt.Hash.prototype.clear=function(){this.__data__=Xt.nativeCreate?Xt.nativeCreate(null):{},this.size=0},Xt.Hash.prototype["delete"]=function(e){var a=this.has(e)&&delete this.__data__[e];return this.size-=a?1:0,a},Xt.Hash.prototype.get=function(e){var a=this.__data__;if(Xt.nativeCreate){var t=a[e];return t===Xt.HASH_UNDEFINED?void 0:t}return en.call(a,e)?a[e]:void 0},Xt.Hash.prototype.has=function(e){var a=this.__data__;return Xt.nativeCreate?void 0!==a[e]:en.call(a,e)},Xt.Hash.prototype.set=function(e,a){var t=this.__data__;return this.size+=this.has(e)?0:1,t[e]=Xt.nativeCreate&&void 0===a?Xt.HASH_UNDEFINED:a,this},Xt.ListCache=function(e){var a=-1,t=null==e?0:e.length;for(this.clear();t>++a;){var n=e[a];this.set(n[0],n[1])}},Xt.ListCache.prototype.clear=function(){this.__data__=[],this.size=0},Xt.ListCache.prototype["delete"]=function(e){var a=this.__data__,t=da(a,e);if(0>t)return!1;var n=a.length-1;return t==n?a.pop():Xt.splice.call(a,t,1),--this.size,!0},Xt.ListCache.prototype.get=function(e){var a=this.__data__,t=da(a,e);return 0>t?void 0:a[t][1]},Xt.ListCache.prototype.has=function(e){return da(this.__data__,e)>-1},Xt.ListCache.prototype.set=function(e,a){var t=this.__data__,n=da(t,e);return 0>n?(++this.size,t.push([e,a])):t[n][1]=a,this},Xt.Stack=function(e){var a=this.__data__=new Xt.ListCache(e);this.size=a.size},Xt.Stack.prototype.clear=function(){this.__data__=new Xt.ListCache,this.size=0},Xt.Stack.prototype["delete"]=function(e){var a=this.__data__,t=a["delete"](e);return this.size=a.size,t},Xt.Stack.prototype.get=function(e){return this.__data__.get(e)},Xt.Stack.prototype.has=function(e){return this.__data__.has(e)},Xt.Stack.prototype.set=function(e,a){var t=this.__data__;if(t instanceof Xt.ListCache){var n=t.__data__;if(!Xt.Map||Xt.LARGE_ARRAY_SIZE-1>n.length)return n.push([e,a]),this.size=++t.size,this;t=this.__data__=new Xt.MapCache(n)}return t.set(e,a),this.size=t.size,this},Xt.MapCache=function(e){var a=-1,t=null==e?0:e.length;for(this.clear();t>++a;){var n=e[a];this.set(n[0],n[1])}},Xt.MapCache.prototype.clear=function(){this.size=0,this.__data__={hash:new Xt.Hash,map:new(Xt.Map||Xt.ListCache),string:new Xt.Hash}},Xt.MapCache.prototype["delete"]=function(e){var a=Xt.getMapData(this,e)["delete"](e);return this.size-=a?1:0,a},Xt.MapCache.prototype.get=function(e){return Xt.getMapData(this,e).get(e)},Xt.MapCache.prototype.has=function(e){return Xt.getMapData(this,e).has(e)},Xt.MapCache.prototype.set=function(e,a){var t=Xt.getMapData(this,e),n=t.size;return t.set(e,a),this.size+=t.size==n?0:1,this},Xt.SetCache=function(e){var a=-1,t=null==e?0:e.length;for(this.__data__=new Xt.MapCache;t>++a;)this.add(e[a])},Xt.SetCache.prototype.add=Xt.SetCache.prototype.push=function(e){return this.__data__.set(e,Xt.HASH_UNDEFINED),this},Xt.SetCache.prototype.has=function(e){return this.__data__.has(e)},Xt.createSet=Xt.Set&&1/Xt.setToArray(new Xt.Set([,0]))[1]==Xt.INFINITY?function(e){return new Xt.Set(e)}:function(){},Xt.getSymbols=Xt.nativeGetSymbols?function(e){return null==e?[]:(e=Object(e),gt(Xt.nativeGetSymbols(e),function(a){return Zt.call(e,a)}))}:Xt.stubArray,Xt.setToString=Xt.shortOut(Xt.baseSetToString);var rn=Xt.overArg(Object.keys,Object),sn=Xt.overArg(Object.getPrototypeOf,Object),on=i(function(e,a){S(a,D(a),e)}),pn=o(function(e){return p(c(e,1,l,!0))}),ln=Xt.nativeGetSymbols?function(e){for(var a=[];e;)ct(a,Xt.getSymbols(e)),e=sn(e);return a}:Xt.stubArray,cn=v(function(e,a){var t={};if(null==e)return t;var n=!1;a=_a(a,function(a){return a=h(a,e),n||(n=a.length>1),a}),S(e,m(e),t),n&&(t=q(t,CLONE_DEEP_FLAG|CLONE_FLAT_FLAG|CLONE_SYMBOLS_FLAG,_));for(var r=a.length;r--;)g(t,a[r]);return t}),un=Rt(function(){return arguments}())?Rt:function(e){return W(e)&&en.call(e,"callee")&&!Zt.call(e,"callee")},dn=Dt(Ut),fn={at:void 0,each:Ua,every:Da,extend:on,filter:Fa,find:Pa,findIndex:Ea,get:xa,getAllKeys:B,has:ka,hasIn:Na,indexOf:Aa,isArray:X,isArrayLike:aa,isArrayLikeObject:l,isBoolean:Q,isEmpty:ta,isFunction:G,isIndex:ea,isKey:na,isLength:Z,isNumber:Y,isObject:K,isObjectLike:W,isPlainObject:y,isPrototype:ra,isString:J,isSymbol:sa,isTypedArray:oa,keys:U,keysIn:D,last:ba,map:Ba,max:n,merge:void 0,omit:cn,pick:void 0,property:ja,pull:void 0,pullAt:void 0,pullAll:Ia,range:Oa,remove:La,some:Ma,sortBy:void 0,union:pn,uniq:Va,zipObject:$a};fn.at=v(lt),fn.pull=o(Ia),fn.pullAt=v(function(e,a){var t=null==e?0:e.length,n=lt(e,a);return jt(e,_a(a,function(e){return ea(e,t)?+e:e}).sort(bt)),n}),fn.sortBy=o(function(e,a){if(null==e)return[];var t=a.length;return t>1&&s(e,a[0],a[1])?a=[]:t>2&&s(a[0],a[1],a[2])&&(a=[a[0]]),zt(e,c(a,1),[])}),fn.merge=Gt(function(e,a,t){Wt(e,a,t)}),fn.pick=v(function(e,a){return null==e?{}:qa(e,a)}),fn.forEach=fn.each,window._||(window._=fn)}}(),function(){function _sanitizeHTML(e){var a=document.createElement("div");return a.textContent=e,a.innerHTML}function _sanitizeScript(e){return(""+e).replace(/<\s*\/+\s*(\bscript\b)/gi,"&lt;/script&gt;</pre").replace(/<\s*(\bscript\b)/gi,"<pre>&lt;script")}function _sanitizeXSS(e){return _sanitizeScript(e).replace(/\s+on([a-z])\s*=/gi," on=").replace(/javascript:/gi,"js:")}function getMatchStr(e){switch(e){case"{":return"}";case"[":return"]";case"<":return">";default:return e}}function _isValidEvalStr(e){if(!spa.jsonDataSanityCheck)return!0;var a=e.indexOf("(");return a>=0&&e.indexOf(")",a)>a?(console.warn("Insecured String with braces():",e),!1):!0}function __finalValue(e){var a=e,t=arguments[1],n=Array.prototype.slice.call(arguments,2);return _is(a,"string")&&(a.indexOf("(")>0&&(a=a.getLeftStr("(")),a=spa.findSafe(window,a.trim(),void 0)),_is(a,"function")&&arguments.length>1&&(a=a.apply(t,n)),a}function _initKeyTracking(){var e=arguments.length&&arguments[0]?arguments[0]:"[data-disable-keys],[data-focus-next],[data-focus-back]",a=$(2==arguments.length&&arguments[1]?arguments[1]:"body").find(e);spa.console.info("Finding Key-Tracking for element(s): "+e),a.each(function(e,a){$(a).keydown(spa._trackAndControlKey),spa.console.info("SPA is tracking keys on element:"),spa.console.info(a)})}function _initKeyPauseEvent(e){$(e||"body").find("[onKeyPause]:not([onKeyPauseReg])").each(function(e,a){$(a).attr("onKeyPauseReg","").on("input propertychange paste",function(){var e=this,a=1*((""+e.getAttribute("data-pause-time")).replace(/[^0-9]/g,"")||"1250");keyPauseTimer&&clearTimeout(keyPauseTimer),keyPauseTimer=setTimeout(function(){var a=e.getAttribute("onKeyPause").split("(")[0],t=spa.findSafe(window,a);t&&t.call(e,e)},a)})})}function _extract(){var e=Array.prototype.slice.call(arguments);try{spa.is(e[0],"object")||e.unshift({}),spa.is(e[1],"string")&&(e[1]=e[1].split(","))}catch(a){console.error("Invalid arguments",a)}if(!spa.is(e[0],"object")||!spa.is(e[1],"array"))return console.error("Invalid arguments."),void 0;var t=e[0],n=e[1],r=e.slice(2);r.unshift(window);var s,o,i,p,l,c;return _.each(n,function(e){if(e=(e||"").trim(),l=!(e&&"@0"!=e),!l&&(/^\@([0-9])+/.test(e)&&(p=o=(e.getRightStr(".")||"").trim(),p?e=p+":"+e:(_.merge(t,r[spa.toInt(e)]),l=!0)),!l)){if(s=e.split(":"),o=(s[0]||"").trim(),i=spa.toInt((s[1]||"").split(".")[0]),p=((s[1]||"").getRightStr(".")||"").trim(),o||(o=p),c=p?spa.findSafe(r[i],p):i?r[i]:{},o.endsWithStr("\\+")){o=o.trimRightStr("+");
var a=spa.findSafe(t,o);switch(spa.of(a)){case"object":spa.is(c,"object")&&(c=_.merge({},a,c));break;case"array":c=spa.is(c,"array")?a.concat(c):a.push(c)}}spa.setSimpleObjProperty(t,o,c)}}),t}function _$qrySelector(e){if(spa.is(e,"string")){var a,t,n=e.trim().split(" "),r=n[0];/app\.(.+)\./.test(r)?(a=r.split(".")[1],n[0]=n[0].replace("app."+a+".",'[data-rendered-component="'+r.split(".")[1]+'"] '),e=n.join(" ")):r.beginsWithStr("\\$")&&(a=r.substr(1),a.indexOf(":")>0?(t=spa.toInt(a.getRightStr(":").trim()),a=a.getLeftStr(":"),n[0]='[data-rendered-component="'+a+'"]:eq('+t+")"):n[0]='[data-rendered-component="'+a+'"]',e=n.join(" "))}return e}function _toQueryString(e){return _.isObject(e)?Object.keys(e).reduce(function(a,t,n){var r,s;return r=0===n?"":"&",t=encodeURIComponent(t),s=_.isArray(e[t])?e[t].map(function(e){return encodeURIComponent(e)}).join(","):encodeURIComponent(e[t]),[a,r,t,"=",s].join("")},""):""}function _of(e){return Object.prototype.toString.call(e).replace(/\[object /,"").replace(/\]/,"").toLowerCase()}function _is(e,a){return(""+a).toLowerCase().indexOf(of(e))>=0}function _isObjHasKeys(e,a,t){function n(e,a){for(var n,r=a.split(","),s="",o=0,i=!0,p=0;r.length>p;p++)s=r[p].trim(),s&&(o++,n=t&&(s.indexOf(".")>0||s.indexOf("[")>0)?spa.hasKey(e,s):e.hasOwnProperty(s),i=i&&n);return o&&i}function r(e,a){for(var n,r=a.split(","),s="",o=0,i=!1,p=0;r.length>p&&(s=r[p].trim(),s&&(o++,n=t&&(s.indexOf(".")>0||s.indexOf("[")>0)?spa.hasKey(e,s):e.hasOwnProperty(s),i=i||n),!i);p++);return o&&i}var s=!1;if(is(e,"object")&&a)switch(a=""+a,!0){case a.indexOf("&")>0:s=n(e,a.replace(/\&/g,","));break;case a.indexOf("|")>0:s=r(e,a.replace(/\|/g,","));break;default:s=n(e,a)}return s}function _getFullPath4Component(e,a){var t=e;if(".{$".indexOf(e[0])>=0){var n=e.split("/"),r=n[0].replace(/[\{\}]/g,""),s="$"==r||"."==r?a:r.replace(/[\{\$\}]/,""),o=spa.defaults.components.inFolder?s+"/":"";n[0]=(spa.defaults.components.rootPath+o).trimRightStr("/"),t=n.join("/")}return t}function _getAboluteUrl(e,a){return(e||"").trimRightStr("/")+"/"+(a||"").trimLeftStr("/")}function _setLang(e,a,t){if(e){if(spa.i18n.onLangChange){var n=spa.i18n.onLangChange,r=spa.is(n,"function")?n.call(void 0,e,t):e;e=spa.is(r,"string")?r:e}$("html").attr("lang",e.replace("_","-")),spa.i18n.setLanguage(e,_.merge({},spa.defaults.lang,spa.findSafe(window,"app.conf.lang",{}),spa.findSafe(window,"app.lang",{}),a||{}))}}function _pipeSort(e,a){var t=e;if(spa.is(e,"array"))t=e.sort(),a&&(t=t.reverse());else if(spa.is(e,"string")){var n;switch(!0){case e.indexOf(",")>=0:n=",";break;case e.indexOf(" ")>=0:n=" "}n&&(t=e.split(n).sort().join(n),a&&(t=t.reverse()))}return t}function _defaultAttr(e){var a="html";switch(e.tagName.toUpperCase()){case"INPUT":switch(e.type.toLowerCase()){case"checkbox":case"radio":a="$";break;default:a="value"}break;case"TEXTAREA":a="value";break;case"SELECT":a="$"}return a}function _maskHandlebars(e){return e.replace(/<img /gi,"<IMG-X-TMP ").replace(/<iframe /gi,"<IFRAME-X-TMP ").replace(/<\/iframe/gi,"</IFRAME-X-TMP").replace(/{{/g,"><!--_XHBTINSPA_{{").replace(/}}/g,"}} _XHBTINSPA_-->")}function _unmaskHandlebars(e){return e.replace(/(\/)*&gt;/g,">").replace(/ _XHBTINSPA_--(>|&gt;)/gi,"").replace(/(>|&gt;)(<|&lt;)!--_XHBTINSPA_/gi,"").replace(/<IMG-X-TMP /gi,"<img ").replace(/<IFRAME-X-TMP /gi,"<iframe ").replace(/<\/IFRAME-X-TMP/gi,"</iframe")}function _adjustComponentOptions(e,a){var t="_rtt_"+e,n="";if(a&&_.isObject(a)&&spa.hasPrimaryKeys(a,"template|templateStr|templateString|templateUrl")){if(a.hasOwnProperty("template")){var r=a.template.trim(),s=r.beginsWithStr("#")&&!r.containsStr(" ");s||(a.templateStr=a.template)}if(spa.hasPrimaryKeys(a,"templateStr|templateString"))n=a.templateStr||a.templateString||"",spa.updateTemplateScript(t,n),a.template="#"+t;else if(spa.hasPrimaryKeys(a,"templateUrl")){var o=(a.templateUrl||"").trim();if(o&&/^(\.\/)/.test(o)){var i=spa.defaults.components.rootPath+(spa.defaults.components.inFolder?e+"/":"");o=i+o.substr(2)}a.template=o}}return a&&_.isObject(a)&&!spa.hasPrimaryKeys(a,"data|dataUrl")&&spa.hasPrimaryKeys(spa.api.urls,"$"+e)&&(a.dataUrl="@$"+e),spa.console.log("$ Adj.Options>>>>",e,a?a.__now():a),a}function _$renderCountUpdate(e){app[e]&&(app[e].__renderCount__=spa.toInt(spa.$renderCount(e))+1)}function _spaComponentOp(){var e=this.action;if(arguments.length){var a=arguments;1==arguments.length&&(_.isArray(arguments[0])?a=arguments[0]:_.isString(arguments[0])&&(a=arguments[0].split(","))),spa.console.log(a),a&&a.length&&_.each(a,function(a){spa.console.info(e+" spa-component:["+a.trim()+"]"),spa[e](a.trim())})}}function _spaRenderRefreshComponents(){var e=this.action;if(arguments.length){var a=arguments;1==arguments.length&&(a=_.isArray(arguments[0])?arguments[0]:_.isString(arguments[0])?arguments[0].split(","):arguments[0]),spa.is(a,"object")?_.each(Object.keys(a),function(t){spa.console.info("Rendering spa-component:["+t+"]"),spa[e](t,a[t])}):a&&a.length&&_.each(a,function(a){spa.console.info("Rendering spa-component:["+a+"]"),spa[e](a.trim())})}}function _get$dataInAttr(e,a,t){var n="app."+a+".";spa.is(t,"object")&&(spa.tempBind$data.hasOwnProperty(a)||(spa.tempBind$data[a]={}),spa.tempBind$data[a].$data=_.merge({},spa.findSafe(app,a+".$data",{}),t),n="spa.tempBind$data."+a+".");var r,s,o,i,p;r=$(e),s=r.data(),o=(r.attr("data-spa-component")||"").split("|"),i=(o[1]||"").trim(),i&&(/\:\s*\$data/.test(i)&&(i=i.replace(/\:\s*\$data/g,":"+n+"$data")),i=spa.toJSON(i));var l=r.attr("data-spa-component-options")||r.attr("data-spa-$options")||r.attr("spa-$options")||"{}";if(p=_.merge({},i,s,spa.toJSON(l)),p.hasOwnProperty("data")&&spa.is(p.data,"string")){var c=p.data.trim();/^\$data/.test(c)&&(c=n+c),p.data=_.merge({},spa.findSafe(window,c,{}))}var u=(r.attr("data-spa-component-$data")||r.attr("data-spa-$data")||r.attr("spa-$data")||"").trim();if(u&&(/\:\s*\$data/.test(u)&&(u=u.replace(/\:\s*\$data/g,":"+n+"$data")),spa.isBlank(p.data)?p.data=spa.toJSON(u):_.merge(p.data,spa.toJSON(u))),!spa.isBlank(p.data)&&p.data.hasOwnProperty("$data")){var d=_.merge({},p.data.$data);delete p.data.$data,_.merge(p.data,d)}return p.hasOwnProperty("data")?p.data:{}}function _appApiDefaultPayload(){var e=spa.findSafe(app,"api.ajaxOptions.defaultPayload",{});return spa.is(e,"function")?e():spa.is(e,"object")?_.merge({},e):e}function _disabledElClick(e){var $el=$(this);return $el.hasClass("disabled")||$el.is("[disabled]")||$el.is(":disabled")?(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),void 0):(eval($el.attr("onclicknative")),void 0)}function _initSpaElements(e){var a=$(e||"body"),t=a.find("form:not([onsubmit])"),n=_routeByHref?".no-spa-route":"",r=a.find('a[href]:not([href^="#"]):not([href^="javascript:"]):not([target])'+n),s=a.find("a:not([href])"),o=a.find("[onclick]:not(:input):not(["+_attrSpaRoute+"]):not([onclicknative])");t.filter(function(){return!$(this).closest("pre").length}).attr("onsubmit","return false;").addClass("spa-form"),r.filter(function(){return!$(this).closest("pre").length}).attr("target","_blank").addClass("spa-external-link"),s.filter(function(){return!$(this).closest("pre").length}).attr("href","javascript:;").addClass("spa-link"),o.filter(function(){return!$(this).closest("pre").length}).addClass("as-btn").renameAttr("onclick","onclicknative").on("click",_disabledElClick)}function _initFormValidation(e){var a,t,n,r=$(e),s=spa.findSafe(spa,"_validate.defaults.offline",!0);if(1==r.length){if(a=r.attr("id")||"",a||(a=r.attr("name")||"spaForm"+spa.now(),r.attr("id",a)),t=r.data(),n=r.has(".ctrl-on-change,.ctrl-on-validate").length,s){var o=(r.attr("data-validate-defaults")||"").trim();if(o){if(0>o.indexOf("offline"))if(o.endsWithStr("}")){var i=o.lastIndexOf("}");o=[o.slice(0,i),",offline:true",o.slice(i)].join("")}else o+=",offline:true";r.attr("data-validate-defaults",o)}else r.attr("data-validate-defaults","{offline:true}")}r.is("[data-validate-form]")||r.attr("data-validate-form",""),r.attr("data-validation-initialized",""),r.attr("onsubmit")||r.attr("onsubmit","return false;"),r.on("change",function(){spa.updateTrackFormCtrls(this)}),r.find("textarea,input:not(:checkbox),input:not(:radio)").filter(":not([data-validate])").each(function(){this.setAttribute("data-validate","{onInput:{fn:_check.noop}}")});var p="",l=spa.defaults.validation.xss,c=(r.attr("data-validate-xss")||"").trim(),u=(l.msg||"").trim();/msg\s*:/g.test(c)&&(u=spa.toJSON(c).msg,u?c="on":u="Invalid input."),!u||c.equalsIgnoreCase("off")||c.equalsIgnoreCase("no")||c.equalsIgnoreCase("skip")||c.equalsIgnoreCase("false")||(p=c.length>4?","+c:",on"+l.on.capitalize()+":{fn:'"+l.fn+"',msg:'"+u+"'}");var d="onFocus:{fn:_clearSpaValidateMsg,offline:false}"+p,f=(r.attr("data-validate-common")||"").trim();if(f){if(0>f.indexOf("_clearSpaValidateMsg")){var m;"{"==f[0]?(f[0]=",",m="{"+d+f):m="{"+d+","+f+"}",r.attr("data-validate-common",m)}}else r.attr("data-validate-common","{"+d+"}");spa.initDataValidation("#"+((t.validateForm||t.validateScope||"").replace(/[#onRender]/gi,"")||a)),!r.hasClass("track-changes")&&n&&spa.trackFormElChange(e),"onRender".equalsIgnoreCase(t.validateForm)&&spa.validateForm("#"+a,!0,!0)}}function _initFormValidationInScope(e){spa.hasOwnProperty("initDataValidation")?$(e||"body").find("[data-validate-form],[data-validate-scope],form:has([data-validate])").filter(":not([data-validation-initialized])").each(function(e,a){_initFormValidation(a)}):console.warn("SPA validation module is not loaded.")}function __renderView(e,a){var t,n=spa.setElIdIfNot(e);return t=a&&!$.isEmptyObject(a)?spa.render("#"+n,a):spa.render("#"+n)}function init_i18n_Lang(){$(document).on("click","[data-i18n-lang]",function(){var e=$(this).data(),a=e.i18nLang||"",t=(e.i18nLang||"").replace("-","_"),n=($("body").attr("i18n-lang-key-prefix")||"lang.name.")+t;_setLang(t,{callback:function(){var e="-",r=$("[data-i18n-lang]:first");r.length&&(e=(r.data("i18nLang")||"").replace(/[a-z]/gi,"")),$(".lang-text").attr("data-i18n",n).data("i18n",n),$(".lang-icon").removeClass(Array.prototype.join.call($("[data-i18n-lang]").map(function(e,a){return $(a).data("i18nLang")})," ")).addClass("_"==e?t:a),$("[data-i18n-lang]").removeClass("active"),$('[data-i18n-lang="'+a+'"],[data-i18n-lang="'+t+'"]').addClass("active"),spa.i18n.apply(".lang-text")}})});var e=($("body").attr("i18n-lang")||"").replace(/ /g,""),a=e.split(",")[0];if(e){if("*"==a&&(a=spa.i18n.browserLang(),0>(","+e.toLowerCase()+",").indexOf(","+a.toLowerCase()+","))){a=a.getLeftStr(2).toLowerCase();for(var t=e.split(","),n="",r="",s=0;t.length>s;s++)if(n=(t[s]||"").trim(),0==n.toLowerCase().indexOf(a)){r=n;break}a=r?r:e.split(",")[1]||""}a&&(_setLang(a,{},!0),setTimeout(function(){spa.i18n.displayLang()},500))}}function _isLiveApiUrl(e,a){var t="",n=a||spa.findSafe(window,"app.api.liveApiPrefix","");if(n){var r,s=[],o=0,i=0;if(spa.is(n,"string")?s=n.split(","):spa.is(n,"array")&&(s=n),i=s.length,i>0)for(;!t&&i>o;)r=s[o++].trim(),t=r?e.beginsWithStr(r)?r:!_isRelativePath(e)&&e.indexOf(r)>0?r:"":"";else t=e.beginsWithStr(n)?n:!_isRelativePath(e)&&e.indexOf(n)>0?n:""}return t}function _ajaxSetReqHeaders(e,a){var t=spa.findSafe(window,"app.api.reqHeaders"),n=is(t,"function")?t(e,a):t;is(n,"object")?_.forEach(Object.keys(n),function(a){e.setRequestHeader(a,n[a])}):is(n,"string")&&(_isLiveApiUrl(a.url)?(a.data=a.data||"",a.data+=(spa.isBlank(a.data)?"":"&")+n):e.setRequestHeader("reqHeadersInLiveUrl",n))}function _isRelativePath(e){var a=e.getLeftStr(6).toLowerCase(),t=a.beginsWithStr("http:")||a.beginsWithStr("https:")||a.beginsWithStr("//");return!t}function _isFn(){return"function"==typeof arguments[0]}function _isObj(){return"object"==typeof arguments[0]}function _ajax(e){var a={url:"",responseType:"json",async:!0,cache:!1,method:"GET",headers:{},auth:null,timeout:0,success:null,error:null,"finally":null},t={TEXT:"text/plain",HTML:"text/html",CSS:"text/css",CSV:"text/csv",XML:"text/xml",JSON:"application/json",PDF:"application/pdf",ZIP:"application/zip"},n=a.responseType.toUpperCase(),r=t[n]||a.responseType,s={};Object.keys(e||{}).forEach(function(t){a[t]=e[t]}),a.method=a.method.toUpperCase(),_isFn(a.headers)&&(a.headers=a.headers.call(void 0,a)),_isObj(a.headers)&&Object.keys(a.headers).forEach(function(e){s[e]=a.headers[e]}),r&&(s["Content-Type"]=r),s["Cache-Control"]=a.cache?"max-age=86400000":"no-cache, no-store, must-revalidate, max-age=0",s.Expires=a.cache?new Date((new Date).setDate((new Date).getDate()+1)).toUTCString():"0",a.cache||(s.Pragma="no-cache");var o,i=new XMLHttpRequest;i.requestOptions=a,a.timeout&&(i.timeout=a.timeout);var p;Object.keys(a).forEach(function(e){var t=e.toLowerCase();"onreadystatechange"===t&&_isFn(a[e])?p=a[e]:0===t.indexOf("on")&&_isFn(a[e])&&(i[t]=function(t){a[e].call(a,i,t)})}),i.onreadystatechange=function(e){if(p&&p.call(a,i,e),4===i.readyState){var t=i.responseText;if(i.status>=200&&300>i.status){if("JSON"===n)try{t&&(t=JSON.parse(t))}catch(e){t=i.responseText,console.warn("Invalid JSON response.",t,i,e)}_isFn(a.success)&&a.success.call(a,t,i.status,i)}else _isFn(a.error)&&a.error.call(a,i.status,i.statusText,i);_isFn(a.finally)&&a.finally.call(a,t,i.status,i)}},a.hasOwnProperty("data")&&"GET"===a.method&&(o=_isObj(a.data)?_toQueryString(a.data):""+a.data,o&&(a.url+=(0>a.url.indexOf("?")?"?":/\?$|\&$/.test(a.url)?"":"&")+o));try{a.auth&&_isObj(a.auth)?a.auth.hasOwnProperty("user")&&(a.auth.hasOwnProperty("pwd")?i.open(a.method,a.url,a.async,a.auth.user,a.auth.pwd):i.open(a.method,a.url,a.async,a.auth.user)):i.open(a.method,a.url,a.async),Object.keys(s).forEach(function(e){i.setRequestHeader(e,s[e])}),"GET"!==a.method&&a.hasOwnProperty("data")?(o=_isObj(a.data)?JSON.stringify(a.data):a.data,i.send(o)):i.send()}catch(l){console.warn("Ajax-Exception",i,l)}return i}function _mockSysTest(){app.api&&_ajax({url:_mockFinalUrl(),method:"HEAD",error:function(){var e=(spa.findSafe(app,"api.mockBaseUrl")||spa.findSafe(spa,"api.mockBaseUrl")||location.origin).trimRightStr("/")+"/",a=(spa.findSafe(app,"api.mockRootFolder")||spa.findSafe(spa,"api.mockRootFolder")||"api_").trimRightStr("/"),t=prompt("Enter Mock Root Address: http[s]://server.address[:port]/root-folder",e+a);if(t){var n=t.indexOf("/",8),r=n>0?t.slice(0,n):t,s=n>0?t.substr(n+1):"";app.api.mockBaseUrl=r==location.origin?"":r,app.api.mockRootFolder=s,_mockSysTest()}}})}function _mockFinalUrl(e,a,t){e=e||"/",a=a||"",t=t||_isLiveApiUrl(e);var n="",r=spa.findSafe(app,"api.mockBaseUrl")||spa.findSafe(spa,"api.mockBaseUrl")||"",s=(spa.findSafe(app,"api.mockRootFolder")||spa.findSafe(spa,"api.mockRootFolder")||"api_").trimRightStr("/")+"/",n=(e||"").replace(/[\{\}]/g,"").replace(RegExp("(.*)(/*)"+t.trimLeftStr("/")),s).replace(/(\/)*\?/,a+"/data.json?").replace(/\?$/,"");if(r){r=r.trimRightStr("/")+"/";var o=n.indexOf("//");0>o?n=r+n:7>o&&(n=r+n.substr(n.indexOf("/",n.indexOf("//")+2)+1))}return n}function _ajaxPrefilter(e,a,t){e.url.beginsWithStr(spa.api.urlKeyIndicator)&&(e.url=spa.api.url(e.url.trimLeftStr(spa.api.urlKeyIndicator),e.data));var n,r=e.url,s=spa.findSafe(window,"app.api.reqHeaders");s&&(e.beforeSend=function(a){_ajaxSetReqHeaders(a,e)}),"script"==e.dataType||e.hasOwnProperty("error")||(e.error=app.api.onError||spa.api.onReqError);var o,i="",p=/({+)([^}])*(}+)/;if(spa.api.mock||app.api.mock||r.beginsWithStr("!"))if(r.beginsWithStr("~"))e.url=(_isRelativePath(r.trimLeftStr("~"))?spa.api.baseUrl||"":"")+r.trimLeftStr("~")+(spa.api.liveUrlSuffix||""),spa.api.baseUrl&&(e.crossDomain=!0);else{var l=("/"+e.type.toUpperCase()).replace("/GET","");if(e.type="GET",r=r.trimLeftStr("!"),i=_isLiveApiUrl(r)){if(r.containsStr("\\?")||(r=r.trimRightStr("/")+"?"),p.test(r)){spa.console.log("URL has undefined params >>",r,e.data);try{o=spa.is(e.data,"string")?JSON.parse(e.data):e.data,r=spa.api.url(r.replace(/{{/g,"{").replace(/}}/g,"}"),o)}catch(c){}spa.console.log("Updated URL>>",r)}var u=_mockFinalUrl(r,l,i);e.url=u,(app.debug||spa.debug)&&console.warn(">>>>>>Intercepting Live API URL: ["+r+"] ==> ["+u+"]"),n=!0}}else i=_isLiveApiUrl(r),(app.debug||spa.debug)&&console.log("actualUrl:"+r+",baseUrl:"+spa.api.baseUrl+",liveApiPrefix:"+i),i&&(e.url=(_isRelativePath(r)?spa.api.baseUrl||"":"")+r+(spa.api.liveUrlSuffix||""),spa.api.baseUrl&&(e.crossDomain=!0));if(spa.console.log("Remove mock params if any in URL>",e.url),e.url=e.url.replace(/{{([^}])*}}(\/*)/g,""),p.test(e.url)){spa.console.log("URL has undefined params>",e.url,e.data);try{o=spa.is(e.data,"string")?JSON.parse(e.data):e.data,e.url=spa.api.url(e.url.replace(/{</g,"{").replace(/>}/g,"}"),o)}catch(c){}}spa.console.log("Final Ajax URL>",e.url),(p.test(e.url)||/<([^>])*>/.test(e.url))&&(console.warn("URL has undefined params >>",e.url,e.data),e.url=e.url.replace(/[{<>}]/g,"_"));var d=app.api.defaultPayload||spa.api.defaultPayload;if(d){var f,m,g=spa.of(e.data),h="string"==g?spa.toJSON(e.data):e.data;spa.is(d,"function")?(f=d.call(e,h,e),spa.is(f,"object")&&(m=JSON.parse(JSON.stringify(f)),spa.isBlank(m)||(e.data="string"==g?JSON.stringify(m):m))):(m=spa.is(d,"object|array")?JSON.parse(JSON.stringify(d)):d,m=spa.is(m,"object|array")&&spa.is(h,"object|array")?_.merge({},m,h):m,e.data=spa.isBlank(m)||"string"!=g?m:JSON.stringify(m))}if(spa.ajaxPreProcess&&spa.ajaxPreProcess(e,a,t),(spa.isBlank(e.data)||spa.is(e.data,"string")&&!/[a-z0-9]/i.test(e.data))&&(spa.console.log("REMVOING EMPTY PAYLOAD"),delete e.data),n){var v=spa.is(e.data,"string")?e.data:JSON.stringify(e.data);v&&spa.is(v,"string")&&v.length>6144&&(v="LAREGE-PAYLOAD-WITH-CHAR-LENGTH:"+v.length),e.headers=_.merge({},e.headers,{"Z-Live-URL":r,"Z-Payload":v}),delete e.data}(app.debug||spa.debug)&&console.log("ajax Options",e)}function _initAutoRoute(){_autoRoutesFound=[],_maxAutoRoute=50}function _initRoutesDefaults(){_prevUrlHash=spa.urlHashFull(_urlHashBase),_urlHashBase=(spa.findSafe(spa,"defaults.routes.base","")||"#").trim(),_blockNavClassName=(spa.findSafe(spa,"defaults.routes.className.block","")||"BLOCK-SPA-NAV").trim(),_blockNavClass="."+_blockNavClassName,_allowNavClassName=(spa.findSafe(spa,"defaults.routes.className.allow","")||"ALLOW-SPA-NAV").trim(),_hideNavClassName=(spa.findSafe(spa,"defaults.routes.className.hide","")||"HIDE-SPA-NAV").trim(),_attrSpaRoute=(spa.findSafe(spa,"defaults.routes.attr.route","")||"data-spa-route").trim(),_attrSpaRouteParams=(spa.findSafe(spa,"defaults.routes.attr.params","")||"data-spa-route-params").trim(),_routeByHref=_attrSpaRoute.equalsIgnoreCase("href"),_attrOnNavAway=(spa.findSafe(spa,"defaults.routes.attr.onNavAway","")||"onNavAway").trim(),_hideNav=$("body").hasClass(_hideNavClassName)}function _blockSpaNavigation(e){var a=$(e||"body :first");return a.addClass(_blockNavClassName),_blockNav=_isSpaNavBlocked()||!0,a}function _allowSpaNavigation(e){var a=$(e||_blockNavClass);return a.removeClass(_blockNavClassName),a.find(_blockNavClass).removeClass(_blockNavClassName),_blockNav=_isSpaNavBlocked(),a}function _isToShowSpaNav(){return!_hideNav}function _isSpaNavBlocked(e){if(e){var a=$(e);return a.hasClass(_blockNavClassName)||a.find(_blockNavClass).length>0}return!!$(_blockNavClass).length}function _isSpaNavAllowed(e){return!_isSpaNavBlocked(e)}function _inBlockedSpaNavContainer(e){return!!$(e).closest(_blockNavClass).length}function _blockBrowserNav(){_blockNav&&_replaceUrlHash(_prevUrlHash)}function _onpageshow(){_blockBrowserNav()}function _onPopStateChange(e){_routeSpaUrlOnHashChange(),_curBlockedUrlHash&&_curBlockedUrlHash!=_skipUrlChangeOn?(spa.console.warn("Blocked:",_curBlockedUrlHash),_curBlockedUrlHash=_skipUrlChangeOn):(_curBlockedUrlHash!=_skipUrlChangeOn&&(spa.onUrlHashChange?spa.onUrlHashChange(spa.urlHash([],_urlHashBase),e):spa.onUrlChange&&spa.onUrlChange(spa.urlHash([],_urlHashBase),e)),_curBlockedUrlHash="")}function _onWindowReload(){var e,a,t;switch(spa.onReload&&(e=spa.onReload()),spa.of(e)){case"boolean":if(!e)return a="spa.message.on.window.reload",spa.i18n.text(a).replace(a,"");break;case"string":return e=e.trim(),e?(a=e.beginsWithIgnoreCase("i18n")?e.replace(/i18n(:)*/i,""):"",t=a?spa.i18n.text(a).replace(a):e):t=e,t;default:if(a="spa.message.on.window.reload",_blockNav)return spa.i18n.text(a).replace(a,"")}}function _handleNavAwayEvent(e,a){_lastBlockedUrl=e,spa.console.log("Trying to navigate away from:["+_prevUrlHash+"] To:["+e+"] by",a);var t,n,r,s,o,i;$(_blockNavClass).each(function(){t=$(this),n=(t.attr(_attrOnNavAway)||"").trim(),"#"==n[0]||">"==n[0]?(r=">"==n[0]?n.substr(1).trim():n,s=t.find(r).filter(":not(.disabled):not(:disabled)"),s.length&&(a&&(i="id:'"+a.attr("id")+"', spaRoute:'"+a.attr(_attrSpaRoute)+"'"),s.data("navToUrl",e).attr("data-nav-to-url",e),s.data("navBy",i).attr("data-nav-by",i),s.trigger("click"))):(o=spa.findSafe(window,n.split("(")[0].split(";")[0]),o&&spa.is(o,"function")&&o.call(t,e,t,a))})}function _ctrlBrwowserNav(){window.onpageshow=_onpageshow,window.onpopstate=_onPopStateChange,is(window,"window")&&(window.onbeforeunload=_onWindowReload)}function _routeSpaUrlOnHashChange(){var e=spa.urlHashFull(_urlHashBase);spa.console.log("on Hash Change: Url To [",e,"] from[",_prevUrlHash,"] on click:",_routeOnClick," block-Navigation:",_blockNav,"isDelayed:",_isDelayed),!_isToShowSpaNav||!_routeOnClick&&_blockNav?(spa.console.log("------------->",_prevUrlHash,e,_isDelayed,_isDelayedOnUrl),spa.console.log("lastBlocked:",_lastBlockedUrl),_lastBlockedUrl||(_lastBlockedUrl=_prevUrlHash),"#"==_urlHashBase[0]?(_replaceUrlHash(_isDelayed?_isDelayedOnUrl:_prevUrlHash,e),_lastBlockedUrl==e&&_handleNavAwayEvent(e)):(_replaceUrlHash(_isDelayed?_isDelayedOnUrl:_prevUrlHash,e),_handleNavAwayEvent(e))):(spa.console.log("Triggering next hash... by href:",_routeByHref,"autoRoute:",_onAutoRoute,"byClick",_routeOnClick),_triggerNextHash(_onAutoRoute||!_routeOnClick))}function _processDynHash(e,a){var t=e.indexOf(":")>=0,n=a;if(spa.is(a,"boolean")&&(n=a?"click":""),t){var r,s,o=t?e.split(":")[0]:"",i={},p=e.indexOf("&")>0?e.split("&"):e.indexOf(",")>0?e.split(","):[e];_.each(p,function(e){r=e.split(":")[0],s=e.getRightStr(":"),i[r]=decodeURIComponent(s)});var l=$("["+_attrSpaRoute+'*="/'+o+':"]['+_attrSpaRouteParams+"]"),c=(l.attr(_attrSpaRouteParams)||"").trim();if(t=!spa.isBlank(c)){_dynHashProcessed.push(e);var u=spa.toJSON(c);_.each(u,function(e,a){if(e=e.trim(),/(^app\.(.)+\.)|(^\$)|(^\#)/.test(e))spa.setElValue(e,i[a]);else if(/^fn:/i.test(e)){var t=e.split(" ")[0].getRightStr(":").trim().split("(")[0];t=t?spa.findSafe(window,t):"",t&&spa.is(t,"function")?t(a,i[a]):console.warn("Not a function",e)}}),n&&l.isEnabled()&&!l.hasClass("AUTO-ROUTING")&&l.trigger(n)}}return t}function _processDynHashInUrl(){for(var e,a=spa.urlHash([],_urlHashBase),t="",n=0;a.length>n;n++)t=a[n],e=_dynHashProcessed.indexOf(t),e>=0?_dynHashProcessed.splice(e,1):_processDynHash(t,n==a.length-1)}function _triggerNextHash(e){e&&_initAutoRoute(),_onAutoRoute=spa.is(e,"undefined")?_onAutoRoute:e;var a,t,n,r=spa.urlHash([],_urlHashBase),s=r.length-1;if(0>_maxAutoRoute&&(_onAutoRoute=!1),_onAutoRoute){_maxAutoRoute--;for(var o=s;o>=0&&(n=r[o-1]||"",_onAutoRoute&&n.indexOf(":")>0&&!_autoRoutesFound.__has(n)&&o--,a=r[o],t=o==s,_onAutoRoute&&!_autoRoutesFound.__has(a));o--)if(a){var i=a.indexOf(":")>=0,p=i?a.split(":")[0]:"",l="["+_attrSpaRoute+'$="/'+a+'"]:not(:disabled):not(.disabled):not(.AUTO-ROUTING):first';i&&(l="["+_attrSpaRoute+'*="/'+p+':"]['+_attrSpaRouteParams+"]");var c=$(l);if(c.length){if(i&&(i=_processDynHash(a)),_autoRoutesFound.push(a),_onAutoRoute=!t,c.isEnabled()&&!c.hasClass("AUTO-ROUTING")&&c.addClass("AUTO-ROUTING").trigger(c.data("routeEvent")||"click"),t){_winLocHash_="";break}o+=2}}}_routeOnClick=!1}function _updateBrowserAddress(e,a){spa.console.log("_updateBrowserAddress >>>>>>>>>[",e,"]delay:",a,"prev:",_prevUrlHash);var t="#"==_urlHashBase[0];if(e)if(_prevUrlHash=e,t){spa.console.log(e);var n=$("#_spaRouteLink_");n.length||(n=$('<a id="_spaRouteLink_" href=""></a>'),$("body").append(n)),spa.console.log("################# "+e),n.attr("href",e)[0].click()}else spa.console.log(e),e=e.trimLeftStr("/"),"#"!=e[0]&&(e="//"+window.location.host+_getAboluteUrl("/",e),spa.console.log("updating the address bar with >>>>>",e)),spa.console.log(">>>>>>>>>>>>>>>>> "+e),history.pushState(null,null,e)}function _replaceUrlHash(e,a){e!=a&&(spa.console.log("attempt to set URL:",e,"insteadOf",a),_curBlockedUrlHash=a,_updateBrowserAddress(e))}function _updateUrlHash(e,a,t){spa.console.log("Updating url with:",e,"delay:",a,"autoRoute:",t),_onAutoRoute=t,_isDelayed=a,_isDelayedOnUrl=a?_prevUrlHash:"",a?_prevUrlHash=e:(_routeOnClick=!0,spa.isToShowNav()?_onAutoRoute||_updateBrowserAddress(e,a):_prevUrlHash=e)}function _getNewMatchingRoutes(e){function a(e,a){var t=a,n=a.getLeftStr("*");if(n)for(var r=0;e.length>r;r++)if(e[r].beginsWithStr(n)){t=e[r];break}return t}if(e=(e||"").trim(),!e)return[];var t=spa.urlHash([],_urlHashBase),n=e.trimStr("/").split("/"),r=[],s=n[0],o=t.indexOf(s);if(s.indexOf("*")>0){s=s.getLeftStr("*");for(var i=0;t.length>i;i++)if(t[i].beginsWithStr(s)){o=i;break}}if(o>=0){for(var p,l=t.splice(o),c=0;n.length>c;c++)p=n[c].indexOf("*"),r[c]=0>p?n[c]:p?a(l,n[c]):l[c];r=t.concat(r)}else r="/"==e[0]?n:t.concat(n);return r}function _onRouteElClick(e){function update(e,a){routeData=(e||"").trim(),"#"==routeData[0]&&(routeData=routeData.substr(1)),usePrevHash="<"==routeData[0],delayUpdate=">"==routeData[0],routeDir=a||routeData[delayUpdate?1:0],routeName=routeData.substr(delayUpdate?2:1),continueAutoRoute=!1}var spaRoutePath=spa.urlHash([],_urlHashBase),$routeEl=$(this),routeData,usePrevHash,delayUpdate,routeDir,routeName,newHashUrl,continueAutoRoute,elClick=$routeEl.attr("onrouteclick");if($routeEl.hasClass("disabled")||$routeEl.is(":disabled"))return e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),void 0;"#"!=_urlHashBase[0]&&e.preventDefault(),update($routeEl.attr(_attrSpaRoute),$routeEl.attr("data-route-dir"));var routeStoreSpec=($routeEl.attr(_attrSpaRouteParams)||"").trim();if(routeStoreSpec){var routeStoreSpecObj=spa.toJSON(routeStoreSpec),paramValue;_.each(routeStoreSpecObj,function(e,a){if(paramValue=e,/(^app\.(.)+\.)|(^\$)|(^\#)/.test(e.trim()))paramValue=spa.getElValue(e);else if(/^fn:/i.test(e.trim())){var t=e.split(" ")[0].getRightStr(":").trim().split("(")[0];t=t?spa.findSafe(window,t):"",t&&spa.is(t,"function")?paramValue=t(a):console.warn("Not a function",e)}routeName=routeName.replace(RegExp(a+":","g"),a+":"+encodeURIComponent(paramValue))})}if(elClick&&eval(elClick),$routeEl.hasClass("AUTO-ROUTING"))return $routeEl.removeClass("AUTO-ROUTING"),void 0;switch("^"==routeDir&&(spa.isBlank(spaRoutePath)?update(routeData.substr(1)):(e.preventDefault(),continueAutoRoute=!0,routeDir="/",routeName=spa.urlHash("",_urlHashBase))),0>"#/-<>".indexOf(routeDir)&&(routeName=routeDir+routeName,routeDir="?"),routeDir){case"#":case"/":spaRoutePath=_getNewMatchingRoutes(routeName);break;case"-":var revCount=spa.toInt(routeName.replace(/[^0-9]/g,""))||1;spaRoutePath.length&&(spaRoutePath.length=spaRoutePath.length-revCount);break;case"<":newHashUrl=_prevUrlHash;break;case"?":spaRoutePath=_getNewMatchingRoutes(routeName)}usePrevHash||(newHashUrl=_getAboluteUrl(_urlHashBase,spaRoutePath.join("/"))),_blockNav&&(usePrevHash||$routeEl.hasClass(_allowNavClassName)||$routeEl.inBlockedSpaNavContainer()||(delayUpdate=!0,_handleNavAwayEvent(newHashUrl,$routeEl))),spa.console.log("Routing to...",newHashUrl,"delay:",delayUpdate,"prev:",_prevUrlHash),_updateUrlHash(newHashUrl,delayUpdate,continueAutoRoute)}function _onRouteAutoReg(){spa.route(this.getAttribute(_attrSpaRoute+"-AUTO").substr(1))}function _initRouteHash(e){$(e||"body").find("["+_attrSpaRoute+'^="*"]:not(.ROUTE):not(.ROUTE-AUTO)').renameAttr(_attrSpaRoute,_attrSpaRoute+"-AUTO").addClass("ROUTE-AUTO").on("click",_onRouteAutoReg);var a=$(e||"body").find("["+_attrSpaRoute+"]:not(.ROUTE)").renameAttr("onclick","onRouteClick").addClass("ROUTE").off("click",_onRouteElClick).on("click",_onRouteElClick);if(_routeByHref&&a.length){var t,n,r;a.each(function(){t=$(this),n=t.attr("href").replace(/\s*/g,"").trim(),r="","#"==n[0]?"^><-".indexOf(n[1])>=0&&(r=n[1],n=n.substr(2)):"^".indexOf(n[0])>=0&&(r=n[0],n=n.substr(1)),t.attr("href","#"+n).removeAttr("target").attr("data-route-dir",r)})}_triggerNextHash(),_blockNav=spa.isNavBlocked()}function _routeToUrl(e){if(e=(e||"").trim()){var a,t,n=e[0],r=1;switch(0>"#/-<>".indexOf(n)&&(n="?",r=0),a=e.substr(r),n){case"/":t=_getNewMatchingRoutes(a);break;case"-":t=spa.urlHash([],_urlHashBase);var s=spa.toInt(e.replace(/[^0-9]/g,""))||1;t.length&&(t.length=t.length-s);break;case"?":t=_getNewMatchingRoutes(a);break;default:t=[a]}return _getAboluteUrl(_urlHashBase,t.join("/"))}}function _$routeElement(e){return $("["+_attrSpaRoute+'$="'+e.trim()+'"].ROUTE:first')}function _$routeElements(e){return $("["+_attrSpaRoute+'$="'+e.trim()+'"].ROUTE')}function _routeNewUrl(e,a){var t=_routeToUrl(e);if(spa.console.log("Route:",e,"URL:",t),t)if(!a&&_blockNav)_handleNavAwayEvent(t);else{var n=_$routeElement(e);n.length?n.hasClass("disabled")||n.is("[disabled]")?console.warn("Route:",e,"is disabled."):n.click():(_isToShowSpaNav()?_updateBrowserAddress(t):_winLocHash_=t,"/"==e.trim()?(spa.allowNav(),window.location.reload()):_onPopStateChange())}}function _StoreMgmt(e){function a(a,t){function n(a,t){e.setItem(""+a,JSON.stringify(t))}1==arguments.length?o(a,"object")?Object.keys(a).forEach(function(e){n(e,a[e])}):o(a,"array")&&a.forEach(function(e,a){n(a,e)}):2==arguments.length&&n(a,t)}function t(a){return 0==arguments.length?n():1!=arguments.length?n.apply(null,arguments):o(a,"string")?a.indexOf(",")>0?n.apply(null,a.split(",")):JSON.parse(e.getItem(a)):o(a,"array")?n.apply(null,a):void 0}function n(){var a=arguments.length,n=Array.prototype.slice.call(arguments).map(function(e){return(""+e).trim()}),r={};return Object.keys(e).forEach(function(e){(!a||n.indexOf(e)>-1)&&(r[e]=t(e))}),r}function r(a){function t(a){e.removeItem(a)}function n(){arguments.length&&Array.prototype.slice.call(arguments).forEach(function(a){e.removeItem(a)})}0==arguments.length?s():1==arguments.length?o(a,"string")?a.indexOf(",")>0?n.apply(null,a.split(",")):t(a):o(a,"array")&&n.apply(null,a):n.apply(null,arguments)}function s(){var a=arguments.length;if(a){var t=Array.prototype.slice.call(arguments).map(function(e){return(""+e).trim()});Object.keys(e).forEach(function(a){0>t.indexOf(a)&&e.removeItem(a)})}else e.clear()}function o(e){var a=Object.prototype.toString.call(e).split(" ")[1].toLowerCase().replace(/\]$/gi,"");return 2==arguments.length?(""+arguments[1]).toLowerCase().indexOf(a)>-1:a}var i=function(e,r){return 0==arguments.length?n():1==arguments.length?o(e,"object|array")?(a(e),e):t(e):2==arguments.length?(a(e,r),t(e)):void 0};return i.set=a,i.get=t,i.getAll=n,i.remove=r,i.removeAll=s,i.removeExcept=s,i.clear=s,i.clearExcept=s,i}function _routeReloadUrl(e){var a=(spa.sesStore.get("_spaReloadUrl")||"").trim();if(!e||0==a.indexOf(e))return a?(spa.sesStore.remove("_spaReloadUrl"),a=a.replace(/.*#/gi,""),spa.route(a,!0),!0):void 0}function _getBindKeyOf(e,a){var t,n,r=e.getAttribute("data-bind"),s="";return r&&!r.containsStr(":")&&(r=_defaultAttr(e)+":'"+r+"'"),t=spa.toJSON(r||"{}"),t&&!$.isEmptyObject(t)&&_.some(_.keys(t),function(e){return!s&&RegExp(a,"i").test(e)&&(n=t[e].split("|"),s=n.shift().trim()),!!s}),s}function _onViewDataChange(){var e=this,a=$(e),t=spa.getElValue(e),n={},r=a.spa$()[0],s=a.spa$name(),o="2way".equalsIgnoreCase(spa.components[s].dataBindType);e.classList.add("DATA-MODEL-CHANGE-SRC");var i=_getBindKeyOf(e,"value|$");spa.setSimpleObjProperty(n,i,t),o&&(_.merge(spa.$data(s),n),app[s].is$DataUpdated=spa.components[s].is$DataUpdated=!0),spa.bindData(r,n,'[data-bind*="'+i+'"]:not(.DATA-MODEL-CHANGE-SRC)',!0),e.classList.remove("DATA-MODEL-CHANGE-SRC"),o&&spa.renderUtils.runCallbackFn("app."+s+".$dataChangeCallback",app[s].$data,app[s])}function _initDataBind(e,a){function t(e,a){$(e).on((e.getAttribute("data-bind-event")||a).toLowerCase(),_onViewDataChange)
}var n="[data-bind]:not(.SPA-DATA-BOUND)",r=$(e||"body").find((a||"")+" "+n);if(r.length||a||(r=$(e+n)),r.length){var s=r.filter("textarea,input:not([type=radio]):not([type=checkbox])").addClass("SPA-DATA-BOUND");s.each(function(){t(this,"keyup")});var o=r.filter("select,input[type=radio],input[type=checkbox]").addClass("SPA-DATA-BOUND");o.each(function(){t(this,"change")})}}function _init_SPA_DOM_(e){spa.reflowFoundation(e),_initKeyTracking("",e),_initKeyPauseEvent(e),_initSpaElements(e),spa.initTrackFormElChanges(e),_initFormValidationInScope(e),_initRouteHash(e),spa.initTogglePassword(e),_initDataBind(e),_processDynHashInUrl()}function _init_SPA_(){_ctrlBrwowserNav(),init_i18n_Lang(),_init_SPA_DOM_("body"),spa.i18n.apply("body")}function _initApiUrls(){_appApiInitialized=!!Object.keys(app.api).length,_appApiInitialized&&spa.console.log("Initializing app.api");var e=spa.findSafe(window,"app.api.baseUrl");spa.isBlank(e)||(spa.api.baseUrl=e);var a=spa.findSafe(window,"app.api.urls");if(spa.isBlank(spa.api.urls)&&!spa.isBlank(a)&&(spa.api.urls=app.api.urls),!spa.isBlank(spa.api.urls)){var t=spa.findSafe(window,"app.api.liveApiPrefix|app.api.mockRootAtPaths");if(!spa.isBlank(t)){var n,r,s=is(t,"array")?t:(""+t).split(",");_.each(s,function(e,a){e=e.trim(),n=e[0],("!"==n||"~"==n)&&(e=e.substr(1),_.each(spa.api.urls,function(a,t){r=a[0],"!"!=r&&"~"!=r&&(0==a.indexOf(e)||a.indexOf("/"+e)>0)&&(spa.api.urls[t]=n+a)})),s[a]=e}),app.api.liveApiPrefix=s,delete app.api.mockRootAtPaths}}}function _initSpaApp(){function e(e){return spa[e]?spa[e]():void 0}function a(){if(spa.env&&"dev".equalsIgnoreCase(spa.env)){spa.api.mock=!0;var a={components:{templateCache:!1,callback:function(){console.log("spa$>",this.__prop__.componentName)}}};spa.defaults.set(a)}$.when(_init_SPA_()).done(function(){$.when(e("onInitComplete")).done(function(){$.when(e("onReady")).done(spa.renderComponentsInHtml)})})}$.when(e("onInit")).done(a)}function _initSpaDefaults(){var e,a=$("body").data();_.each(Object.keys(spa.defaults),function(t){t.equalsIgnoreCase("set")||(e=a["spaDefaults"+t.capitalize()],spa.isBlank(e)||_.merge(spa.defaults[t],spa.toJSON(e)))}),_initRoutesDefaults(),_initApiUrls()}var win=this,spa=function(e){return e instanceof spa?e:this instanceof spa?void 0:new spa(e)};win.spa=win.__=win._$=win.w3=spa,spa.VERSION="2.69.1";var isById=document.getElementById,isByName=document.all;spa.isIE=isByName?!0:!1,spa.isNonIE=isById&&!isByName?!0:!1,spa.noop=function(){};var _appApiInitialized;spa.debug=!1,spa["debugger"]={on:function(){spa.debug=!0},off:function(){spa.debug=!1},toggle:function(){spa.debug=!spa.debug}},spa.cOut=function(e,a){spa.debug&&console[e]&&console[e](1===a.length?a[0]:a)},spa.console={clear:function(){console.clear()},assert:function(){spa.cOut("assert",arguments)},count:function(){spa.cOut("count",arguments)},debug:function(){spa.cOut("debug",arguments)},dir:function(){spa.cOut("dir",arguments)},dirxml:function(){spa.cOut("dirxml",arguments)},error:function(){spa.cOut("error",arguments)},exception:function(){spa.cOut("exception",arguments)},group:function(){spa.cOut("group",arguments)},groupCollapsed:function(){spa.cOut("groupCollapsed",arguments)},groupEnd:function(){spa.cOut("groupEnd",arguments)},info:function(){spa.cOut("info",arguments)},log:function(){spa.cOut("log",arguments)},markTimeline:function(){spa.cOut("markTimeline",arguments)},profile:function(){spa.cOut("profile",arguments)},profileEnd:function(){spa.cOut("profileEnd",arguments)},table:function(){spa.cOut("table",arguments)},time:function(){spa.cOut("time",arguments)},timeEnd:function(){spa.cOut("timeEnd",arguments)},timeStamp:function(){spa.cOut("timeStamp",arguments)},trace:function(){spa.cOut("trace",arguments)},warn:function(){spa.cOut("warn",arguments)}},spa.ajaxPreProcess,spa.onInit,spa.onInitComplete,spa.onReady,spa.onUrlChange,spa.onUrlHashChange,spa.onReload,Date.prototype.yyyymmdd=function(e){var a=this.getMonth()+1,t=this.getDate();return[this.getFullYear(),(a>9?"":"0")+a,(t>9?"":"0")+t].join(e||"")},Date.prototype.hhmmss=function(e){var a=this.getHours(),t=this.getMinutes(),n=this.getSeconds();return[(a>9?"":"0")+a,(t>9?"":"0")+t,(n>9?"":"0")+n].join(e||"")},String.prototype.trimLeftStr=function(e){return(""+this).replace(RegExp("^["+(e||"\\s")+"]+","g"),"")},String.prototype.trimRightStr=function(e){return(""+this).replace(RegExp("["+(e||"\\s")+"]+$","g"),"")},String.prototype.trimStr=function(e){return(""+this).trimLeftStr(e).trimRightStr(e)},String.prototype.getLeftStr=function(e){return"string"==typeof e&&(e=(""+this).indexOf(e)),e?(""+this).substr(0,e):""},String.prototype.getRightStr=function(e){var a=1;return"string"==typeof e&&(a=e.length,e=(""+this).indexOf(e)),0>e?"":(""+this).substr(e+a)},String.prototype.isBlankStr=function(){return""==(""+this).trimStr()},String.prototype.ifBlankStr=function(e,a){return e=e===void 0?"":e,a=a===void 0?(""+this).trimStr():a,(""+this).isBlankStr()?e:a},String.prototype.isNumberStr=function(){var e=(""+this).trim(),a=e.replace(/[0-9]/g,"").replace(".","").trimStr(),t=e[0];return e&&(0==a.length||1==a.length&&("+"==t||"-"==t))},String.prototype.normalizeStr=function(){return(""+this).trimStr().replace(/\s+/g," ")},String.prototype.beginsWithStr=function(e,a){a=a?"i":"";var t=RegExp("^"+e,a);return(""+this).normalizeStr().match(t)?!0:!1},String.prototype.beginsWithStrIgnoreCase=function(e){var a=RegExp("^"+e,"i");return(""+this).normalizeStr().match(a)?!0:!1},String.prototype.endsWithStr=function(e,a){a=a?"i":"";var t=RegExp(e+"$",a);return(""+this).normalizeStr().match(t)?!0:!1},String.prototype.endsWithStrIgnoreCase=function(e){var a=RegExp(e+"$","i");return(""+this).normalizeStr().match(a)?!0:!1},String.prototype.containsStr=function(e,a){a=a?"gi":"g";var t=RegExp(""+e,a);return t.test(""+this)},String.prototype.containsStrIgnoreCase=function(e){var a=RegExp(""+e,"gi");return a.test(""+this)},String.prototype.equals=function(e){return""+this==e},String.prototype.equalsIgnoreCase=function(e){return(""+this).toLowerCase()+""==(e+"").toLowerCase()},String.prototype.toProperCase=function(e){return(e===void 0||e?(""+this).normalizeStr():""+this).toLowerCase().replace(/^(.)|\s(.)/g,function(e){return e.toUpperCase()})},String.prototype.toTitleCase=function(e){return(e===void 0||e?(""+this).normalizeStr():""+this).toLowerCase().replace(/^(.)|\s(.)/g,function(e){return e.toUpperCase()})},String.prototype.capitalize=function(){return(""+this).charAt(0).toUpperCase()+(""+this).slice(1)},String.prototype.unCapitalize=function(){return(""+this).charAt(0).toLowerCase()+(""+this).slice(1)},String.prototype.sanitizeHTML=function(){return _sanitizeHTML(""+this)},spa.sanitizeHTML=_sanitizeHTML,String.prototype.sanitizeScript=function(){return _sanitizeScript(""+this)},spa.sanitizeScript=_sanitizeScript,String.prototype.sanitizeXSS=function(){return _sanitizeXSS(""+this)},spa.sanitizeXSS=_sanitizeXSS,String.prototype.splitToArray=String.prototype.toArray=function(e){return spa.isBlank(""+this)?[]:(""+this).split(e)},String.prototype.extractStrBetweenIn=function(e,a,t){e||(e=(""+this).match(/[^a-z0-9\:\.\/\\]/i),e=e?e[0]:""),a=a||getMatchStr(e);var n=(""+this).match(RegExp("\\"+e+"([^\\"+e+"\\"+a+"].*?)\\"+a,"g"))||[];return t&&!spa.isBlank(n)&&(n=n.__unique()),n},String.prototype.extractStrBetweenEx=function(e,a,t){e||(e=(""+this).match(/[^a-z0-9\:\.\/\\]/i),e=e?e[0]:""),a=a||getMatchStr(e);var n="\\"+e+"\\"+a,r=RegExp("["+n+"]","g"),s=((""+this).match(RegExp("\\"+e+"([^"+n+"].*?)\\"+a,"g"))||[]).map(function(e){return e.replace(r,"")});return t&&!spa.isBlank(s)&&(s=s.__unique()),s},spa.strToNative=function(e){function a(){var e=s.replace(/[0-9]/g,"");return s.length?e.length?"-"==e||"+"==e||"."==e:!0:!1}function t(){return"true"==s||"false"==s}function n(){return"["==s[0]&&"]"==s[s.length-1]}function r(){return"{"==s[0]&&"}"==s[s.length-1]}var s=e.trim();switch(!0){case a():return 1*s;case t():return"true"==s;case r():return s.toJSON();case n():return("{xArr:"+s+"}").toJSON().xArr;default:return e}},String.prototype.toNative=function(){return spa.strToNative(""+this)},spa.extractStrBetweenIn=function(e,a,t,n){return(e||"").extractStrBetweenIn(a,t,n)},spa.extractStrBetweenEx=function(e,a,t,n){return(e||"").extractStrBetweenEx(a,t,n)},spa.strToArray=function(e){return"string"==typeof e&&(e=[e]),e},spa.jsonDataSanityCheck,spa.toJSON=function(str,key4PrimaryDataTypes){var thisStr;if(_.isString(str)){if(thisStr=str.trimStr().trimStr(",").trimStr(";"),!_isValidEvalStr(thisStr))return str;if(thisStr.match(/^\</))return str;if(!(thisStr.containsStr("{")||thisStr.containsStr(":")||thisStr.containsStr("\\[")||thisStr.containsStr("'")||thisStr.containsStr('"'))){if(thisStr.containsStr(",")||thisStr.containsStr(";"))return thisStr.replace(/ /g,"").replace(/;/g,",").split(",");if(!key4PrimaryDataTypes)return spa.strToNative(thisStr);thisStr="{"+key4PrimaryDataTypes+":"+thisStr+"}"}thisStr.containsStr(":")&&!thisStr.containsStr(",")&&thisStr.containsStr(";")&&(thisStr=thisStr.replace(/\;/g,",")),thisStr.beginsWithStr("{")||thisStr.beginsWithStr("\\[")?thisStr.beginsWithStr("{")&&!thisStr.containsStr(":")&&thisStr.containsStr("=")&&(thisStr=""+thisStr.replace(/=/g,":")+""):thisStr=thisStr.containsStr(":")?"{"+thisStr+"}":thisStr.containsStr("=")?"{"+thisStr.replace(/=/g,":")+"}":"["+thisStr+"]",!thisStr.beginsWithStr("{")&&key4PrimaryDataTypes&&(thisStr="{"+key4PrimaryDataTypes+":"+thisStr+"}")}var jsonObj={};try{jsonObj=!_.isString(str)&&_.isObject(str)?str:spa.isBlank(str)?null:eval("("+thisStr+")")}catch(e){console.error('Error JSON Parse: Invalid String >> "'+str+'"'+e.stack)}return jsonObj},String.prototype.toJSON=function(){return spa.toJSON(""+this)},String.prototype.toBoolean=function(){var e=!0;switch((""+this).trimStr().toLowerCase()){case"":case"0":case"-0":case"nan":case"null":case"false":case"undefined":e=!1}return e&&(e=!(""+this).trimStr().beginsWithStr("-")),e},Boolean.prototype.toValue=function(e,a){return e===void 0&&(e=!0),a===void 0&&(a=!1),(""+this).valueOf()?e:a},Boolean.prototype.toHtml=function(e,a){return $((""+this).valueOf()?e:a).html()},String.prototype.padStr=function(e,a,t){e=e||"",a=a||1,t=t||2;for(var n="",r=0;a>r;r++)n+=e;return(-1===t||2===t?n:"")+(""+this)+(1===t||2===t?n:"")},spa.lastSplitResult=[],spa.getOnSplit=spa.pickOnSplit=function(e,a,t){return spa.lastSplitResult=e.split(a),spa.getOnLastSplit(t)},spa.getOnLastSplit=spa.pickOnLastSplit=function(e){return 0>e?_.last(spa.lastSplitResult):spa.lastSplitResult[e]},spa.isBlank=spa.isEmpty=function(e){var a=!0;if(void 0!==e&&null!==e)switch(!0){case _.isString(e):a=0==e.trimStr().length;break;case _.isFunction(e):a=!1;break;case _.isArray(e):case _.isObject(e):a=_.isEmpty(e);break;default:a=0==(""+e).trimStr().length}return a},spa.isNumber=function(e){return(""+e).isNumberStr()},spa.toBoolean=function(e){var a=!0;switch((""+e).trimStr().toLowerCase()){case"":case"0":case"-0":case"nan":case"null":case"false":case"undefined":a=!1}return a},spa.toInt=function(e){return e=(""+e).replace(/[^+-0123456789.]/g,""),e=spa.isBlank(e)?"0":e.indexOf(".")>=0?e.substring(0,e.indexOf(".")):e,parseInt(1*e,10)},spa.toFloat=function(e){return e=(""+e).replace(/[^+-0123456789.]/g,""),e=spa.isBlank(e)?"0":e,parseFloat(1*e)},spa.toString=function(e){spa.console.warn("spa.toString is deprecated. use spa.toStr instead.");var a=""+e;return _.isObject(e)&&(a=JSON.stringify(e)),a},spa.toStr=function(e){var a=""+e;return _.isObject(e)&&(a=JSON.stringify(e)),a},spa.dotToX=function(e,a){return e.replace(/\./g,a)},spa.dotToCamelCase=function(e){var a=e.replace(/\./g," ").toProperCase().replace(/ /g,"");return a[0].toLowerCase()+a.substring(1)},spa.dotToTitleCase=function(e){return e.replace(/\./g," ").toProperCase().replace(/ /g,"")},spa.toDottedPath=function(e){return(e||"").trim().replace(/]/g,"").replace(/(\[)|(\\)|(\/)/g,".").replace(/(\.+)/g,".").trimStr("\\.")},spa.ifBlank=spa.ifEmpty=spa.ifNull=function(e,a,t){return a=(""+(a||"")).trimStr(),t=t===void 0?(""+e).trimStr():t,spa.isBlank(e)?a:t},spa.now=function(){return""+(new Date).getTime()},spa.year=function(e){return e=e||0,(new Date).getFullYear()+spa.toInt(e)},spa.sizeOf=function _sizeOf(e,a){function t(e){if(null!==e&&void 0!==e)switch(typeof e){case"number":r+=8;break;case"string":r+=2*e.length;break;case"boolean":r+=4;break;case"object":var a=Object.prototype.toString.call(e).slice(8,-1);if("Object"===a||"Array"===a)for(var n in e)e.hasOwnProperty(n)&&(r+=2*n.length,t(e[n]));else r+=2*(""+e).length}return r}function n(e){return 1024>e?e+" B":1048576>e?(e/1024).toFixed(3)+" KB":1073741824>e?(e/1048576).toFixed(3)+" MB":(e/1073741824).toFixed(3)+" GB"}var r=0;return spa.is(a,"undefined")||a?n(t(e)):t(e)},spa.range=function(e){var a=e.toUpperCase().split(".."),t=""+a[0],n=""+a[1],r="1";n.indexOf(":")>0&&(n=""+a[1].split(":")[0],r=""+a[1].split(":")[1]),t.indexOf("Y")>=0&&(t=spa.year(t.split(/[^0-9+-]/)[1])),n.indexOf("Y")>=0&&(n=spa.year(n.split(/[^0-9+-]/)[1]));var s=spa.toInt(t),o=spa.toInt(n),i=spa.toInt(r);return t>n?_.range(o,s+1,i).reverse():_.range(s,o+1,i)},spa.checkAndPreventKey=function(e,a){a||(a="");var t=a.indexOf("+shift")>=0,n=""+e.keyCode,r=a.padStr(",").indexOf(n.padStr(","))>=0&&(t?e.shiftKey?!0:!1:e.shiftKey?!1:!0);return r&&(e.preventDefault(),spa.console.info("Key ["+n+(t?"+Shift":"")+"] has been disabled in this element.")),r},spa._trackAndControlKey=function(e){var a=e.currentTarget,t=$(a),n=(""+t.data("disableKeys")).toLowerCase();spa.checkAndPreventKey(e,n);var r=!spa.isBlank((""+t.data("focusNext")).replace(/undefined/,"").toLowerCase()),s=!spa.isBlank((""+t.data("focusBack")).replace(/undefined/,"").toLowerCase());r&&spa.checkAndPreventKey(e,"9")&&$(t.data("focusNext")).get(0).focus(),s&&spa.checkAndPreventKey(e,"9,+shift")&&$(t.data("focusBack")).get(0).focus()},spa.initKeyTracking=_initKeyTracking;var keyPauseTimer;spa.getDocObj=function(e){var a="object"==typeof e?e:(e.beginsWithStr("#")?"":"#")+e;return $(a).get(0)},spa.getDocObjs=function(e){var a=(e.beginsWithStr("#")?"":"#")+e;return $(a).get()},spa.hasCssRule=function(e){var a=!1;if(e){e=e.split(",");for(var t=0;document.styleSheets.length>t;t++){var n=document.styleSheets[t].rules||document.styleSheets[t].cssRules;if(a)break;for(var r in n)if(a=a||"string"==typeof n[r].selectorText&&e.indexOf(n[r].selectorText)>=0)break}}return a},spa.getCssRule=function(e){var a,t;if(e)for(var n=0;document.styleSheets.length>n;n++){var r=document.styleSheets[n].rules||document.styleSheets[n].cssRules;if(a)break;for(var s in r)if(a=a||"string"==typeof r[s].selectorText&&e==r[s].selectorText){t=r[s];break}}return t},spa.setFocus=function(e,a){var t=spa.getDocObj(e);t&&(t.focus(),a&&t.select())},spa.isElementExist=function(e){return!$.isEmptyObject($(e).get())},spa.swapClass=spa.swapObjClass=function(e,a,t){$(e).removeClass(a),$(e).addClass(t)},spa.docObjValue=function(e,a){var t=spa.getDocObj(e),n="";return t&&(n=t.value,2===arguments.length&&(t.value=a)),n},spa.optionSelectedIndex=function(e,a){var t=-1,n=spa.getDocObj(e);return n&&(t=n.selectedIndex,2===arguments.length&&(n.selectedIndex=a)),t},spa.optionIndexOfValue=function(e,a){var t=-1,n=spa.getDocObj(e);if(n)for(var r=0;n.length>r;r++)if((""+a).equalsIgnoreCase(n.options[r].value)){t=r;break}return t},spa.optionIndexOfText=function(e,a){var t=-1,n=spa.getDocObj(e);if(n)for(var r=0;n.length>r;r++)if(a.equalsIgnoreCase(n.options[r].text)){t=r;break}return t},spa.optionIndexOfValueBeginsWith=function(e,a){var t=-1,n=spa.getDocObj(e);if(n)for(var r=0;n.length>r;r++)if(n.options[r].value.beginsWithStrIgnoreCase(a)){t=r;break}return t},spa.optionsSelectedValues=function(e,a){return e=(e.beginsWithStr("#")?"":"#")+e,a=a||",",$.map($(e+" option:selected"),function(e){return e.value}).join(a)},spa.optionsSelectedTexts=function(e,a){return e=(e.beginsWithStr("#")?"":"#")+e,a=a||",",$.map($(e+" option:selected"),function(e){return e.text}).join(a)},spa.optionValueOfIndex=function(e,a){var t="",n=spa.getDocObj(e);return n&&a>=0&&n.length>a&&(t=n.options[a].value),t},spa.optionTextOfIndex=function(e,a){var t="",n=spa.getDocObj(e);return n&&a>=0&&n.length>a&&(t=n.options[a].text),t},spa.selectOptionForValue=function(e,a){var t=-1,n=spa.getDocObj(e);return n&&(t=spa.optionIndexOfValue(e,a),n.selectedIndex=t),t},spa.selectOptionForValueBeginsWith=function(e,a){var t=-1,n=spa.getDocObj(e);return n&&(t=spa.optionIndexOfValueBeginsWith(e,a),n.selectedIndex=t),t},spa.selectOptionsForValues=function(e,a,t){t=t||",",a=(t+a+t).toLowerCase();var n,r=spa.getDocObj(e);if(r)for(var s=0;r.length>s;s++)n=(t+r.options[s].value+t).toLowerCase(),r.options[s].selected=a.indexOf(n)>=0},spa.selectOptionForText=function(e,a){var t=-1,n=spa.getDocObj(e);return n&&(t=spa.optionIndexOfText(e,a),n.selectedIndex=t),t},spa.selectOptionsAll=function(e){var a=spa.getDocObj(e);if(a)for(var t=0;a.length>t;t++)a.options[t].selected=!0},spa.selectOptionsNone=function(e){var a=spa.getDocObj(e);if(a)for(var t=0;a.length>t;t++)a.options[t].selected=!1},spa.optionsReduceToLength=function(e,a){a=a||0;var t=spa.getDocObj(e);t&&(spa.selectOptionsNone(e),t.length=a)},spa.optionsRemoveAll=function(e){spa.optionsReduceToLength(e,0)},spa.optionRemoveForIndex=function(e,a){e=(e.beginsWithStr("#")?"":"#")+e;var t=spa.getDocObj(e);t&&((""+a).equalsIgnoreCase("first")&&(a=0),(""+a).equalsIgnoreCase("last")&&(a=t.length-1),t.remove(a))},spa.optionRemoveForValue=function(e,a){spa.optionRemoveForIndex(e,spa.optionIndexOfValue(e,a))},spa.optionRemoveForText=function(e,a){spa.optionRemoveForIndex(e,spa.optionIndexOfText(e,a))},spa.optionRemoveForValueBeginsWith=function(e,a){spa.optionRemoveForIndex(e,spa.optionIndexOfValueBeginsWith(e,a))},spa.optionAppend=function(e,a,t,n){var r=-1,s=spa.getDocObj(e);if(s)if(n===void 0){var o=s.length;s.length=o+1,s.options[o].value=a,s.options[o].text=t,r=o}else $(s).find("option").eq(n).before('<option value="'+a+'">'+t+"</option>"),r=n;return r},spa.optionsLoad=function(e,a,t,n){var r=["","key","value"];if(t=t||0,n=n||0,_.isString(a)&&a.indexOf("..")>0&&(a=spa.range(a)),t>=0&&spa.optionsReduceToLength(e,t),_.isArray(a))_.each(a,function(a){spa.optionAppend(e,a,a)});else if(n>0){var s=[];for(var o in a)s.push({key:o,value:a[o]});var i=_.sortBy(s,r[n]);_.each(i,function(a){spa.optionAppend(e,a.key,a.value)})}else _.each(a,function(a,t){spa.optionAppend(e,t,a)})},spa.checkedState=function(e,a){var t=!1,n=spa.getDocObj(e);return n&&(t=n.checked,2===arguments.length&&(n.checked=a)),t},spa.isChecked=function(e,a){return $(e).find("input[name="+a+"]:checked").length>0},spa.radioSelectedValue=function(e,a){var t=$(e).find("input[name="+a+"]:checked").val();return t?t:""},spa.radioClearSelection=function(e,a){$(e).find("input[name="+a+"]:checked").attr("checked",!1)},spa.radioSelectForValue=function(e,a,t){$(e).find("input[name="+a+"]:radio").each(function(e){e.checked=e.value.equalsIgnoreCase(t)})},spa.checkboxCheckedValues=function(e,a,t){return t=t||",",$(e).find("input[name="+a+"]:checked").map(function(){return this.value}).get().join(t)},spa.sleep=function(e){var a=new Date;for(a.setTime(a.getTime()+1e3*e);a.getTime()>(new Date).getTime(););},spa.filterJSON=function(e,a){return $(e).filter(function(e,t){for(var n in a)if(!(""+t[n]).match(a[n]))return null;return t})},spa.randomPassword=function(e,a){for(var t=a||"9a8b77C8D9E8dkfhseidF7G6H5QJ3c6d5e4f32L3M4N5P6Qg2h3i4j5kV6W5X4Y3Z26m7n8p9q8r7s6t5u4v3w2x3y4z5A6BK7R8S9T8U7",n="",r=0;(e||8)>r;r++){var s=Math.floor(Math.random()*t.length);n+=t.charAt(s)}return n},spa.rand=function(e,a){return Math.floor(Math.random()*(a-e+1))+e},spa.htmlEncode=function(e){return $("<div/>").text(e).html()},spa.htmlDecode=function(e){return $("<div/>").html(e).text()},spa.appendToObj=function(e,a,t){_.has(e,a)?(_.isArray(e[a])||(e[a]=[e[a]]),e[a].push(t)):e[a]=t},spa.parseKeyStr=function(e,a){return(a?e.toLowerCase():e).replace(/[^_0-9A-Za-z\$\[\]\?\*\-]/g,"")};var arrayIndexPointsToMap={};spa.setObjProperty=function(e,a,t,n){a=""+a,n=n||!1;var r,s,o,i,p=e,l=a.indexOf(".")>=0||a==a.toUpperCase()?a.split("."):a.split(/(?=[A-Z])/),c=$.trim(a.replace(/[0-9A-Za-z\[\]\?\*\_]/g,""));c&&""!=c&&(l=a.split(c[0]));for(var u="";l.length>1;)r=spa.parseKeyStr(l.shift(),n),""!=$.trim(r)&&(u+=r.replace(/[\?\[\]\*\_]/g,""),r.indexOf("[")>0&&r.indexOf("]")==r.length-1?(s=r.substring(0,r.length-1).replace(/\[/g,".").split("."),o=s[0],i=s[1],p[o]===void 0&&(p[o]=[]),i.replace(/[0-9]/g,"")&&(i=i.replace(/[^0-9]/g,""),arrayIndexPointsToMap.hasOwnProperty(u)?i=arrayIndexPointsToMap[u]:p[o][i]===void 0&&(arrayIndexPointsToMap[u]=p[o].length,i=p[o].length)),p[o][i]===void 0&&(p[o][i]={}),p=p[o][i]):(p[r]===void 0&&(p[r]={}),p=p[r]));return r=spa.parseKeyStr(l.shift(),n),spa.appendToObj(p,r,t),e},spa.setSimpleObjProperty=function(e,a,t){a=""+a;for(var n,r=e,s=a.split(".");s.length>1;)n=spa.parseKeyStr(s.shift(),!1),""!=$.trim(n)&&(r[n]===void 0&&(r[n]={}),r=r[n]);return n=spa.parseKeyStr(s.shift(),!1),r[n]=t,e},spa.objProp=spa.objProperty=spa.objectProp=spa.objectProperty=function(){var e=arguments[0],a=arguments[1],t=arguments[2];return 3==arguments.length?spa.setSimpleObjProperty(e,a,t):2==arguments.length?spa.findSafe(e,a):e},spa.extract=_extract,spa.setElValue=function(e,a){var t=$(_$qrySelector(e));switch(e=t.get(0),e.tagName.toUpperCase()){case"INPUT":switch(e.type.toLowerCase()){case"text":case"password":case"hidden":case"color":case"date":case"datetime":case"datetime-local":case"email":case"month":case"number":case"search":case"tel":case"time":case"url":case"range":case"button":case"submit":case"reset":t.val(a),t.isEnabled()&&t.trigger("keyup");break;case"checkbox":case"radio":e.checked=e.value.equalsIgnoreCase(a),e.checked&&t.isEnabled()&&t.trigger("click")}break;case"SELECT":spa.selectOptionForValue(e,a),t.isEnabled()&&t.trigger("change");break;case"TEXTAREA":t.val(a),t.isEnabled()&&t.trigger("keyup");break;default:t.html(spa.sanitizeXSS(a)),t.val(a),t.isEnabled()&&t.trigger("keyup")}},spa.getElValue=function(e,a){if(e=$(_$qrySelector(e)).get(0)){var t,n,r;switch(e.tagName.toUpperCase()){case"INPUT":switch(e.type.toLowerCase()){case"checkbox":n=$(e).data("unchecked"),r="true"==e.value?!0:"false"==e.value?!1:e.value,t=e.checked?r:n===void 0?"":n;break;case"radio":t=e.checked?e.value:"";break;default:t=$(e).val()}break;case"SELECT":t=$.map($(e).find("option:selected"),function(e){return e.value}).join(",");break;case"TEXTAREA":t=$(e).val();break;default:t=a?$(e).text():$(e).html()}return t}},spa.serialize=function(e,a,t){_.isBoolean(e)&&(t=e,e=""),_.isBoolean(a)&&(t=a,a=""),e=e||"body";var n,r,s,o,i={},p=a?'[data-serialize-context*="'+a+'"]':"";return $(e).find("[data-serialize]"+p+",input[name]"+p+",select[name]"+p+",textarea[name]"+p+"").each(function(e,a){s=$(a).data(),n=a.name||s.serialize,o=s.serializeType?s.serializeType.equalsIgnoreCase("text"):t,r=spa.getElValue(a,o),i.hasOwnProperty(n)?spa.isBlank(r)||(spa.isBlank(i[n])?i[n]=r:_.isArray(i[n])?i[n].push(r):i[n]=[i[n],r]):i[n]=r}),i},spa.serializeToQueryString=function(e,a){return spa.toQueryString(spa.serialize(e,a))},spa.serializeDisabled=function(e){var a="";return $(e).find("[disabled][name]").each(function(){a+=(a?"&":"")+$(this).attr("name")+"="+spa.getElValue(this)}),a},spa.serializeForms=function(e,a){var t,n,r=$(e).serialize();return $(e).find("input[data-unchecked]:checkbox:enabled:not(:checked)[name]").each(function(){n=$(this).data("unchecked"),r+=(r?"&":"")+$(this).attr("name")+"="+(n===void 0?"":n)}),a&&(t=spa.serializeDisabled(e),r+=(r&&t?"&":"")+t),r},spa.queryStringToJson=spa.queryStringToObject=function(e){var a={},t=e||location.search,n=(""+t).indexOf("?"),r=(""+t).indexOf("&");return t&&t.length>0&&n>=0&&(0==n||r>n)&&(t=t.substring(n+1)),_.each(t.split("&"),function(e){e=e.split("="),e[0]&&spa.appendToObj(a,e[0],decodeURIComponent(e[1]||""))}),a},spa.toQueryString=spa.ObjectToQueryString=spa.objectToQueryString=spa.JsonToQueryString=spa.jsonToQueryString=_toQueryString,$.fn.serializeUncheckedCheckboxes=function(e){var a,t,n,r,s="object"==typeof e,o=s?e:{},i=s&&!e?"":e;return $(this).find("input[data-unchecked]:checkbox:enabled:not(:checked)[name]").each(function(e,p){a=$(p),n=a.attr("name"),t=a.data("unchecked"),r=t===void 0?"":t,s?spa.appendToObj(o,n,r):i+=(i?"&":"")+n+"="+r}),s?o:i},spa.serializeUncheckedCheckboxes=function(e,a){return $(e).serializeUncheckedCheckboxes(a)},$.fn.serializeFormToJSON=$.fn.serializeFormToObject=function(e,a,t){var n,r,s=this.serializeArray(),o=$(this).data(),i="object"==typeof e?e:{},p="boolean"==typeof e?e:a||!1,l=o.serializeIgnorePrefix,c=o.hasOwnProperty("typeNative");return arrayIndexPointsToMap={},t&&(l=t),$.each(s,function(){n=l?this.name.replace(l,""):this.name,i=spa.setObjProperty(i,n,c?this.value.toNative():this.value,p)}),$(this).find("input[data-unchecked]:checkbox:enabled:not(:checked)[name]").each(function(){n=$(this).attr("name"),n&&(r=$(this).data("unchecked"),l&&(n=n.replace(l,"")),r=""+(r===void 0?"":r),i=spa.setObjProperty(i,n,c?r.toNative():r,p))}),i},spa.serializeFormToJSON=spa.serializeFormToObject=function(e,a,t,n){return $(e).serializeFormToJSON(a,t,n)},$.fn.serializeFormToSimpleJSON=$.fn.serializeFormToSimpleObject=function(e,a){var t,n,r,s,o=this.serializeArray(),i="object"==typeof e?e:{},p="boolean"==typeof e?e:a||!1;return $.each(o,function(){spa.appendToObj(i,this.name,this.value)}),p&&$(this).find("[disabled][name]").each(function(){spa.appendToObj(i,this.name,spa.getElValue(this))}),$(this).find("input[data-unchecked]:checkbox:enabled:not(:checked)[name]").each(function(){r=$(this).attr("name"),s=$(this).data("unchecked"),s=""+(s===void 0?"":s),spa.appendToObj(i,r,s)}),$(this).find("[data-to-json-group][name]").each(function(){t=this.name,n=$(this).data("toJsonGroup"),n&&(i[n]||(i[n]={}),spa.appendToObj(i[n],t,spa.getElValue(this)))}),i},spa.serializeFormToSimpleJSON=spa.serializeFormToSimpleObject=function(e,a,t){return $(e).serializeFormToSimpleJSON(a,t)},spa.findSafe=spa.findInObj=spa.findInObject=spa.locateSafe=spa.valueOfPath=spa.find=spa.locate=function(e,a,t){if(is(e,"window|array|object|function|global")&&a){var n=_.map(a.split("|"),function(e){return e.trim()});a=n.shift();var r,s,o=n.join("|"),i=a.indexOf("*")>=0;if(i)s=function(e,a){var t;if("object"==typeof e||"function"==typeof e)if(e.hasOwnProperty(a))t=e[a];else for(var n=Object.keys(e),r=0;is(t,"undefined")&&n.length>r;)t=arguments.callee(e[n[r++]],a);return t}(e,a.replace(/\*/g,""));else{var p=0,l=spa.toDottedPath(a).split("."),c=l.length;for(s=e;c>p;p++)if(is(s,"object|window|function|global"))s=s[l[p].trim()];else{if(!is(s,"array")){s=r;break}s=s[spa.toInt(l[p])]}}return is(s,"undefined")?o?spa.findSafe(e,o,t):is(t,"function")?t.call(e,e,a):t:s}return 3==arguments.length?is(t,"function")?t.call(e,e,a):t:e},spa.has=spa.hasKey=function(e,a){var t=e,n=!1;try{n=_isValidEvalStr(a)?spa.find(t,a)!==void 0:!1}catch(r){console.warn("Key["+a+"] error in object.\n"+r.stack)}return n},spa.of=of=_of,spa.is=is=_is,spa.hasPrimaryKeys=function _spa_hasPrimaryKeys(e,a){return _isObjHasKeys(e,a)},spa.hasKeys=function _spa_hasKeys(e,a){return _isObjHasKeys(e,a,!0)},spa.keysDottedAll=function(e){var a=spa.keysDotted(e);return a&&!_.isEmpty(a)&&(a=spa.toDottedPath(a.join(",")).split(",")),a},spa.keysDotted=function(e){e=e||{};var a,t,n,r=[];return function(e,s){if(s=s||"","object"!=typeof e)return!0;for(var o in e)n=s.substring(1),a=spa.isNumber(o)?"[":".",t=n&&"["==a?"]":"",arguments.callee(e[o],s+a+o+t)&&r.push(n+(n?a:"")+o+t);return!1}(e),r},spa.keysCamelCase=function(e){return _.map(spa.keysDotted(e),function(e){var a=e.replace(/\./g," ").toProperCase().replace(/ /g,"");return a[0].toLowerCase()+a.substring(1)})},spa.keysTitleCase=function(e){return _.map(spa.keysDotted(e),function(e){return e.replace(/\./g," ").toProperCase().replace(/ /g,"")})},spa.keys_=function(e){return _.map(spa.keysDotted(e),function(e){return e.replace(/\./g,"_")})},Object.defineProperties(Array.prototype,{__now:{value:function(){return JSON.parse(JSON.stringify(this))},enumerable:!1,configurable:!1},__clone:{value:function(){return JSON.parse(JSON.stringify(this))},enumerable:!1,configurable:!1},__toObject:{value:function(e){var a={};return this.forEach(function(t,n){e?a[t]=n:a[n]=t}),a},enumerable:!1,configurable:!1},__unique:{value:function(){return this.filter(function(e,a,t){return t.indexOf(e)===a})},enumerable:!1,configurable:!1},__rotate:{value:function(e){if(e=e||1,e>0)for(;e--;)this.push(this.shift());else if(0>e)for(;e++;)this.unshift(this.pop());return this},enumerable:!1,configurable:!1},__isFirst:{value:function(e,a){var t=this[0];return a&&(t=t.toLowerCase(),e=e.toLowerCase()),t==e},enumerable:!1,configurable:!1},__isLast:{value:function(e,a){var t=this[this.length-1];return a&&(t=t.toLowerCase(),e=e.toLowerCase()),t==e},enumerable:!1,configurable:!1},__has:{value:function(e,a){function t(e){return a.indexOf(e)>=0}var n;if(a=(a||"").trim()){a.indexOf("i")&&spa.is(e,"string")&&(e=e.toLowerCase());for(var r=0;this.length>r;r++){var s=this[r];switch(a.indexOf("i")&&spa.is(s,"string")&&(s=s.toLowerCase()),!0){case t("b"):case t("^"):n=t("~")?e.beginsWithStr(s):s.beginsWithStr(e);break;case t("e"):case t("$"):n=t("~")?e.endsWithStr(s):s.endsWithStr(e);break;case t("c"):case t("*"):n=t("~")?e.indexOf(s)>=0:s.indexOf(e)>=0;break;case t("<"):n=e>s;break;case t("<="):n=e>=s;break;case t(">"):n=s>e;break;case t(">="):n=s>=e;break;default:n=s==e}if(n)break}}else n=this.indexOf(e)>=0;return n},enumerable:!1,configurable:!1}}),Object.defineProperties(Object.prototype,{__now:{value:function(){return JSON.parse(JSON.stringify(this))},enumerable:!1,configurable:!1},__clone:{value:function _obj_clone(){return JSON.parse(JSON.stringify(this))},enumerable:!1,configurable:!1},__keys:{value:function _obj_keys(e){return e?spa.keysDotted(this):Object.keys(this)},enumerable:!1,configurable:!1},__keysAll:{value:function _obj_keysAll(){return spa.keysDotted(this)},enumerable:!1,configurable:!1},__hasKey:{value:function _obj_hasKey(e){return spa.hasKey(this,e)},enumerable:!1,configurable:!1},__hasKeys:{value:function _obj_hasKeys(e){return _isObjHasKeys(this,e,!0)},enumerable:!1,configurable:!1},__hasPrimaryKeys:{value:function _obj_hasPrimaryKeys(e){return _isObjHasKeys(this,e)},enumerable:!1,configurable:!1},__valueOf:{value:function _obj_getValueOf(e,a){return spa.findSafe(this,e,a)},enumerable:!1,configurable:!1},__merge:{value:function _obj_merge(){return Array.prototype.unshift.call(arguments,this),_.merge.apply(void 0,arguments)},enumerable:!1,configurable:!1},__stringify:{value:function(){return JSON.stringify(this)},enumerable:!1,configurable:!1},__toQueryString:{value:function(){return spa.toQueryString(this)},enumerable:!1,configurable:!1},__extract:{value:function(){return Array.prototype.unshift.call(arguments,this),spa.extract.apply(this,arguments)},enumerable:!1,configurable:!1}}),$.cachedScript=function(e,a){return spa.console.log("Ajax for script:",e,"options:",a),e=_getFullPath4Component(e,a?a.spaComponent:""),e.endsWithStrIgnoreCase(".js")||(e+=spa.defaults.components.scriptExt),a=$.extend(a||{},{dataType:"script",cache:!0,url:e}),spa.console.info("$.cachedScript('"+e+"')"),$.ajax(a)},$.cachedStyle=function(e,a,t){return t=$.extend(t||{},{dataType:"text",cache:!0,url:a,success:function(a){$("head").append("<style id='"+e+"' type='text/css'>"+a+"</style>")}}),spa.console.info("$.cachedScript('"+a+"')"),$.ajax(t)},spa.addScriptTag=function(e,a){if(e=e.replace(/#/,""),spa.console.group("spaAddScriptTag"),spa.isElementExist("#spaScriptsContainer")||(spa.console.info("#spaScriptsContainer NOT Found! Creating one..."),$("body").append("<div id='spaScriptsContainer' style='display:none' rel='Dynamic Scripts Container'></div>")),spa.isElementExist("#"+e))spa.console.info("script ["+e+"] already found in local.");else{spa.console.info("script ["+e+"] NOT found. Added script tag with src ["+a+"]");var t=a?"src='"+a+"'":"";
$("#spaScriptsContainer").append("<script id='"+e+"' type='text/javascript' "+t+"></script>")}spa.console.groupEnd("spaAddScriptTag")},spa.addStyle=function(e,a){e=e.replace(/#/,""),spa.console.group("spaAddStyle"),spa.isElementExist("#spaStylesContainer")||(spa.console.info("#spaStylesContainer NOT Found! Creating one..."),$("body").append("<div id='spaStylesContainer' style='display:none' rel='Dynamic Styles Container'></div>")),spa.isElementExist("#"+e)?spa.console.info("style ["+e+"] already found in local."):(spa.console.info("style ["+e+"] NOT found. Added link tag with href ["+a+"]"),$("#spaStylesContainer").append("<link id='"+e+"' rel='stylesheet' type='text/css' href='"+a+"'/>")),spa.console.groupEnd("spaAddStyle")},spa.loadScript=function(e,a,t,n,r){return e=e.replace(/#/,""),t=t||!1,n=n||[],spa.console.group("spaScriptsLoad"),spa.isBlank(a)?spa.console.error("script path ["+a+"] for ["+e+"] NOT defined."):t?spa.addScriptTag(e,a):n.push($.cachedScript(a,r).done(function(t,n){spa.console.info("Loaded script ["+e+"] from ["+a+"]. STATUS: "+n)})),spa.console.groupEnd("spaScriptsLoad"),n},spa.getComponentsFullPath=function(e){return e=spa.strToArray(spa.toJSON(e)),_.map(e,function(e){return spa.defaults.components.rootPath+(spa.defaults.components.inFolder?e:"")+"/"+e+spa.defaults.components.scriptExt})},spa.loadComponents=function(e,a,t){var n=_.filter(spa.strToArray(spa.toJSON(e)),function(e){return!spa.components.hasOwnProperty(e)});spa.loadScripts(spa.getComponentsFullPath(n),a,t)},spa.loadScripts=function(e,a,t){if(e=spa.strToArray(spa.toJSON(e)),!spa.isBlank(e)){var n=[];_.each(e,function(e){n.push($.cachedScript(e).done(function(a,t){spa.console.info("Loaded script from ["+e+"]. STATUS: "+t)}).fail(function(){spa.console.info("Failed Loading script from ["+e+"].")}))}),$.when.apply($,n).then(function(){spa.renderUtils.runCallbackFn(a)}).fail(function(){spa.renderUtils.runCallbackFn(t)})}},spa.loadScriptsSync=function(e,a,t){if(e=spa.strToArray(spa.toJSON(e)),spa.isBlank(e))spa.renderUtils.runCallbackFn(a);else{var n=!0,r=e.shift();r?(/^~/.test(r)&&(n=!1,r=r.substr(1)),spa.console.info("Load script from   ["+r+"], cache:",n),$.cachedScript(r,{cache:n}).done(function(){spa.console.info("Loaded script from ["+r+"]"),spa.loadScriptsSync(e,a,t)}).fail(function(){console.error("Failed Loading script from ["+r+"].",arguments),spa.renderUtils.runCallbackFn(t)})):spa.loadScriptsSync(e,a,t)}},spa.loadStyle=function(e,a,t,n){return e=e.replace(/#/,""),t=t||!1,n=n||[],spa.console.group("spaStylesLoad"),spa.isBlank(a)?spa.console.error("style path ["+a+"] for ["+e+"] NOT defined."):t?spa.addStyle(e,a):n.push($.cachedStyle(e,a).done(function(t,n){spa.console.info("Loaded style ["+e+"] from ["+a+"]. STATUS: "+n)})),spa.console.groupEnd("spaStylesLoad"),n},spa.addTemplateScript=function(e,a,t){e=e.replace(/#/,""),t=t||"x-template",spa.isElementExist("#spaViewTemplateContainer")||(spa.console.info("#spaViewTemplateContainer NOT Found! Creating one..."),$("body").append("<div id='spaViewTemplateContainer' style='display:none' rel='Template Container'></div>")),spa.console.info("Adding <script id='"+e+"' type='text/"+t+"'>");var n="_BlockedScript_";a=a.replace(/<(\s)*script/gi,"<"+n+' src-ref="'+e+'"').replace(/<(\s)*(\/)(\s)*script/gi,"</"+n).replace(/<(\s)*link/gi,"<_LINKTAGINTEMPLATE_").replace(/<(\s)*(\/)(\s)*link/gi,"</_LINKTAGINTEMPLATE_"),$("#spaViewTemplateContainer").append("<script id='"+e+"' type='text/"+t+"'>"+a+"</script>")},spa.updateTemplateScript=function(e,a,t){e=e.replace(/#/,"");var n=$("#spaViewTemplateContainer").find("#"+e);n.length&&n.remove(),spa.addTemplateScript(e,a,t)},spa.loadTemplate=function(e,a,t,n,r,s,o){if(e=e.replace(/#/g,""),a=a.ifBlankStr("inline").trimStr(),t=t||"x-template",n=n||"#DummyInlineTemplateContainer",r=r||[],o=o||{},spa.console.group("spaTemplateAjaxQue"),spa.isElementExist("#"+e)){var i=$("#"+e);if(s)spa.console.warn("Reload Template["+e+"] of ["+t+"]"),i.remove(),r=spa.loadTemplate(e,a,t,n,r,s,o);else if(spa.isBlank(i.html())){spa.console.warn("Template["+e+"] of ["+t+"] script found EMPTY!");var p=""+i.attr("path");spa.isBlank(p)||(t=(i.attr("type")||"").ifBlankStr(t).toLowerCase().replace(/text\//gi,""),spa.console.info("prepare/remove to re-load Template["+e+"]  of ["+t+"] from external path: ["+p+"]"),i.remove(),r=spa.loadTemplate(e,p,t,n,r,s,o))}else spa.console.info("Template["+e+"]  of ["+t+"] already found in local.")}else if(spa.console.info("Template["+e+"] of ["+t+"] NOT found. Source ["+a+"]"),a&&"undefined"==a)spa.addTemplateScript(e,"",t),spa.console.info("Loaded Empty Template["+e+"] of ["+t+"]");else if(a.equalsIgnoreCase("inline")||a.beginsWithStr("#")){var l=a.equalsIgnoreCase("inline")?n:a,c=$(l),u=c.html();spa.isBlank(u)?spa.console.error("Template["+e+"] of ["+t+"] NOT defined inline in ["+l+"]."):(spa.addTemplateScript(e,u,t),a.equalsIgnoreCase("inline")&&c.html(""))}else if(a.equalsIgnoreCase("none"))spa.console.warn("Template["+e+"] of ["+t+"] defined as NONE. Ignoring template.");else if(a.equalsIgnoreCase("script"))spa.console.error("Template["+e+"] of ["+t+"] NOT defined in <script>.");else{var d=((o.method||"get")+"").toLowerCase();o.params&&(a=spa.api.url(a,o.params)),s&&spa.console.warn(">>>>>>>>>> Making New Template Request");var f=$.ajax({url:a,method:d,headers:o.headers,data:o.payload,cache:!s,dataType:"html",onTmplError:o.onError,success:function(n){spa.addTemplateScript(e,n,t),spa.console.info("Loaded Template["+e+"] of ["+t+"] from ["+a+"]")},error:function(n,r,s){this.onTmplError&&_is(this.onTmplError,"function")&&this.onTmplError.call(this,n,r,s),spa.console.error("Failed Loading Template["+e+"] of ["+t+"] from ["+a+"]. ["+r+":"+s+"]")}});r.push(f)}return spa.console.groupEnd("spaTemplateAjaxQue"),r},spa.urlParams=function(e){e=e||window.location.search||"",e=e.beginsWithStr("\\?")||7>e.indexOf("//")?e.substr(e.indexOf("?")+1):e;var a={};return e.replace(/([^&=]+)=?([^&]*)(?:&+|$)/g,function(e,t,n){(a[t]=a[t]||[]).push(decodeURIComponent(n))}),_.each(a,function(e,t){a[t]=_.isArray(e)&&1==e.length?e[0]:e}),a},spa.urlParam=function(e,a){return spa.urlParams(a)[e]};var _winLocHash_="";spa.getLocHash=function(e){var a=(_winLocHash_||window.location.hash).replace("#","");return a||spa.is(e,"undefined")||"#"==e||(a=window.location.pathname.replace(/(\/)*(index|default)\.([a-z])*/i,"").replace(e.replace(/\s*/g,"").trimRightStr("/"),"")),a},spa.urlHash=function(e,a){var t="/",n=spa.getLocHash(a);if(e||_.isNumber(e)){n=n.beginsWithStr(t)?n.substring(n.indexOf(t)+t.length):n;var r=n.length?n.split(t):[];_.isNumber(e)?n=0>e?r[r.length-1]:r&&r.length>e?r[e]:"":_.isArray(e)?n=0===e.length?r:_.zipObject(e,r):_.isString(e)&&"?"==e&&(n=n.containsStr("\\?")?spa.getOnSplit(n,"?",1):"")}return n},spa.urlHashFull=function(e){return e=e||"#",_getAboluteUrl(e,spa.urlHash("",e))},spa.hashParam=function(e){var a=""+spa.urlHash("?");return void 0===e||spa.isBlank(a)||(a=spa.urlParam(""+e,a)),a},spa.i18n={},spa.i18n.loaded=!1,spa.i18n.settings={name:"Language",path:"language/",ext:".txt",encoding:"UTF-8",cache:!0,async:!0,mode:"map",callback:null},spa.i18n.browserLang=function(){return navigator?navigator.language||navigator.userLanguage||"en_US":"en_US"},spa.i18n.setLanguage=function(e,a){$.i18n&&($.i18n.map={},e=(e||spa.i18n.browserLang()).replace(/-/g,"_"),a=$.extend(spa.i18n.settings,a),$.i18n.properties({name:a.name,language:e,path:a.path,ext:a.ext,encoding:a.encoding,cache:a.cache,async:a.async,mode:a.mode,callback:function(){spa.isElementExist("#i18nSpaRunTime")||$("body").append('<div id="i18nSpaRunTime" style="display:none"></div>'),$.i18n.loaded=$.i18n.loaded===void 0?!$.isEmptyObject($.i18n.map):$.i18n.loaded,spa.i18n.loaded=spa.i18n.loaded||$.i18n.loaded,e.length>1&&!$.i18n.loaded&&(spa.console.warn("Error Loading Language File ["+e+"]. Loading default."),spa.i18n.setLanguage("_",a)),spa.i18n.apply(),a.callback&&a.callback($.i18n.loaded)}}))},spa.i18n.setLang=function(e,a){_setLang(e,a)},spa.i18n.value=function(e){function a(e){function a(e){return e.substring(1,e.length-1)}var t=e;try{t=(""+(!spa.i18n.loaded&&window.Liferay?Liferay.Language.get(e):$.i18n.prop(e))).trim(),t.beginsWithStr("\\[")&&t.endsWithStr("]")&&(t=a(t))}catch(n){console.warn("i18n lookup error:"+n.stack)}return t}return e=(""+e).replace(/i18n:/i,"").trim(),e.beginsWithStrIgnoreCase("@")&&(e=e.substr(1).trim(),e=spa.findSafe(window,e,e)),a(e)},spa.strBindData=function(e,a,t,n){e=""+e,t=t||"{",n=n||"}";var r=spa.extractStrBetweenEx(e,t,n,!0);return e&&!spa.isBlank(r)&&spa.is(a,"object")&&_.each(r,function(r){e=e.replace(RegExp(t+"\\s*("+r.trim()+")\\s*"+n,"g"),spa.findSafe(a,r,""))}),e},String.prototype.bindData=function(e){return spa.strBindData(""+this,e)},spa.i18n.text=function(e,a){function t(e){var a=spa.extractStrBetweenEx(e,"{","}",!0);return spa.isBlank(a)?e:(_.each(a,function(a){o=o||i.indexOf(a)>=0,o||(i.push(a),e=e.replace(RegExp("{\\s*("+a.trim()+")\\s*}","g"),spa.i18n.value(a)))}),o?(console.error("i18nKey circular issue found:",i.join(" > ")),e):t(e))}var n=spa.i18n.value(e);if(a&&spa.is(a,"object")){var r="",s="";_.each(_.keys(a),function(e){r=""+a[e],s=r.trim(),r&&(s.beginsWithStrIgnoreCase("i18n:")||s.beginsWithStrIgnoreCase("@"))&&(r=spa.i18n.value(s)),n=n.replace(RegExp("{\\s*("+e.trim()+")\\s*}","g"),r)})}var o,i=[e];return t(n)},spa.i18n.update=function(e,a,t){a=a||"";var n,r,s=$(e),o=s.attr("data-i18n")||"",i="";if(spa.isBlank(o)||0==a.indexOf(":")||0==a.indexOf("=")||0>=o.indexOf(":")&&0>=a.indexOf(":"))i=a.trimLeftStr(":").trimLeftStr("=");else{n=o.indexOf(":")>0?spa.toJSON(o||{}):{html:o.trimLeftStr(":").replace(/'/g,"")},r=a.indexOf(":")>0?spa.toJSON(a||{}):{html:a.trimLeftStr(":").replace(/'/g,"")},_.each(Object.keys(n),function(e){_.each(e.split("_"),function(a){a&&(n[a]=n[e])})}),_.each(Object.keys(r),function(e){_.each(e.split("_"),function(a){a&&(r[a]=r[e])})});var p=_.merge({},n,r);_.each(Object.keys(p),function(e){0>=e.indexOf("_")&&(i+=e+":'"+p[e]+"',")}),i=i.trimRightStr(",")}return s.attr("data-i18n",i).data("i18n",i),(t||spa.is(t,"undefined"))&&spa.i18n.apply(e),s},spa.i18n.apply=spa.i18n.render=function(e,a){if(spa.i18n.loaded||window.Liferay){e=e||"html",a=a||"";var t=e.beginsWithStr("<");t&&($("#i18nSpaRunTime").html(e),e="#i18nSpaRunTime");var n=$(e).find(a+"[data-i18n]");n.length||(n=$(e).filter(a+"[data-i18n]")),n.each(function(e,a){var t=$(a),n=t.data("i18n")||"";n&&!n.containsStr(":")&&(n="html:'"+n+"'");var r=spa.toJSON(n||"{}"),s=r.data||r.i18ndata;s?(delete r.data,delete r.i18ndata):s=spa.toJSON(t.data("i18nData")||"{}"),r&&!$.isEmptyObject(r)&&_.each(_.keys(r),function(e){var a=r[e],n=spa.i18n.text(a,s);_.each(e.split("_"),function(e){switch(e.toLowerCase()){case"html":t.html(spa.sanitizeXSS(n));break;case"text":t.text(n);break;default:t.attr(e,n)}})})})}return t?$("#i18nSpaRunTime").html():void 0},$.fn.extend({i18n:function(e){return this.each(function(){e&&$(this).attr("data-i18n",e).data("i18n",e),spa.i18n.apply(this)}),this}}),spa.pipes={trim:function(e){return(""+e).trim()},trimLeft:function(e){return(""+e).trimLeftStr()},trimRight:function(e){return(""+e).trimRightStr()},normalize:function(e){return(""+e).normalizeStr()},toLowerCase:function(e){return(""+e).toLowerCase()},toUpperCase:function(e){return(""+e).toUpperCase()},toTitleCase:function(e){return(""+e).toTitleCase()},capitalize:function(e){return(""+e).capitalize()},unCapitalize:function(e){return(""+e).unCapitalize()},not:function(e){return!e},sort:function(e){return _pipeSort(e)},sortAsc:function(e){return _pipeSort(e)},sortDesc:function(e){return _pipeSort(e,!0)},reverse:function(e){var a=e;if(spa.is(e,"array"))a=e.reverse();else if(spa.is(e,"string")){var t;switch(!0){case e.indexOf(",")>=0:t=",";break;case e.indexOf(" ")>=0:t=" "}t&&(a=e.split(t).reverse().join(t))}return a}},spa.dataBind=spa.bindData=function(e,a,t,n){function r(e){return e=(e||"").trim(),"#"==e[0]?e:spa.findSafe(f,e)}function s(e,a){return["_runTimeTemplate",e,u,a.replace(/[^a-z0-9]/gi,"_"),spa.now()].join("_")}function o(e,a){return spa.compiledTemplates4DataBind.hasOwnProperty(d)||(spa.compiledTemplates4DataBind[d]={}),spa.compiledTemplates4DataBind[d][e]=Handlebars.compile(_unmaskHandlebars(a))}e=e||"body",t=t||"";var i,p,l=spa.is(e,"string")&&/\s*</.test(e);if(l){p="_BlockedScriptInTemplate_";var c=e.replace(/<\s*script/gi,"<"+p).replace(/<\s*(\/)\s*script/gi,"</"+p);i=$('<div style="display:none">'+c+"</div>")}else i=$(e);if(spa.isBlank(a))return i;var u="";"$"==t[0]&&(u=t.substr(1).trim(),t=""),u=u||i.attr("data-rendered-component");var d=u||"_unknown_",f=_.merge({__computed__:{}},a),m=i.find(t+"[data-bind]");m.length||(m=i.filter(t+"[data-bind]")),m.length&&!l&&u&&(m=m.filter(function(){return $(this).closest("[data-rendered-component]").attr("data-rendered-component")==u}));var g,h,v,y,b,S,O,C,T,w;if(_.each(m,function(e){g=$(e),h=g.data("bind")||"",h&&!h.containsStr(":")&&(h=_defaultAttr(e)+":'"+h+"'"),v=spa.toJSON(h||"{}"),T=spa.renderUtils.getFn(g.attr("data-bind-callback")||""),v&&!$.isEmptyObject(v)&&_.each(_.keys(v),function(a){y=(v[a]+"|").split("|"),b=y.shift().trim(),w="!"==b[0],w?(b=b.substr(1).trim(),O=!r(b)):O=r(b),spa.is(O,"undefined|null")&&(O="");for(var t=0;y.length>t;t++)S=y[t].trim(),S&&("."==S[0]&&(S="spa.pipes"+S),"!"==S[0]?"!"==S?O=!O:(S=S.substr(1).trim(),"."==S[0]&&(S="spa.pipes"+S),O=!spa.renderUtils.runCallbackFn(S,["(...)",O,b,f,e],e)):O=spa.renderUtils.runCallbackFn(S,["(...)",O,b,f,e],e));_.each(a.split("_"),function(a){var t="";if(a=a.trim(),!spa.is(O,"undefined"))switch(a.toLowerCase()){case"html":g.html(spa.sanitizeXSS(O));break;case"text":g.text(O);break;case"$":if(/checkbox|radio/i.test(e.type)){switch(spa.of(O)){case"boolean":e.checked=O;break;default:e.checked=e.value.equalsIgnoreCase(""+O)}e.checked?e.setAttribute("checked",""):e.removeAttribute("checked")}else/select/i.test(e.tagName)&&console.warn("TODO: data-bind:select");break;case"if":t=b.replace(/[^a-z0-9]/gi,"_"),f.__computed__[t]=O;var n,r=g.attr("data-bind-template");if(r)n=spa.compiledTemplates4DataBind[d][r];else{var i="{{#if __computed__."+t+" }}"+g.html().trim()+"{{/if}}";r=s("if",b),n=o(r,i),g.attr("data-bind-template",r)}g.html(n(f));break;case"repeat":t=b.replace(/[^a-z0-9]/gi,"_"),f.__computed__[t]=O;var p,l=g.attr("data-bind-template");if(l)p=spa.compiledTemplates4DataBind[d][l];else{var c=(v.repeatAs||"").replace(/[,|:]/g," ").normalizeStr(),u="{{#each __computed__."+t+(c?" as |"+c+"|":"")+" }}"+g.html().trim()+"{{/each}}";l=s("repeat",b),p=o(l,u),g.attr("data-bind-template",l)}g.html(p(f));break;case"repeatAs":break;default:switch(!0){case/^\./.test(a):var m=a.replace(/[\.\,]/g," ").normalizeStr();g[O?"addClass":"removeClass"](m);break;default:g.attr(a,O),a.beginsWithStr("data-")&&(C=spa.dotToCamelCase(a.getRightStr("-").replace(/-/g,".")),C&&g.data(C,O))}}}),T&&T.call(e,e)})}),!n&&!l&&i.is("[data-rendered-component]")){var k=i.attr("data-rendered-component");if(!spa.isBlank(k)){var R="app."+k+".bindCallback";spa.renderUtils.runCallbackFn(R,f,app[k])}}if(!l){var N=i.find("[data-rendered-component]").filter(function(){return this.hasAttribute("data-spa-component-$data")||this.hasAttribute("data-spa-$data")||this.hasAttribute("spa-$data")});if(N.length){var A;N.each(function(){A=_get$dataInAttr(this,u,a),spa.bindData(this,A)})}}return f=null,l?i.html().replace(RegExp(p,"g"),"script"):i},spa.togglePassword=function(e){if(!$(e).next(".icon.eye").length){var a=$('<i class="icon eye"></i>');a.on("click",function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation();var a=$(this),t=a.prevAll(".toggle-password"),n="text"==t.attr("type")?"password":"text";t.attr("type",n).toggleClass("text")}),$(a).insertAfter(e)}},spa.initTogglePassword=function(e){$(e||"body").find(".toggle-password").each(function(e,a){spa.console.info("Initializing toggle password",a),spa.togglePassword(a)})},spa.isElValueChanged=function(e){var a,t,n=$(e);if(n.length)if(t=n[0],"checkbox"==t.type)a=t.checked!=t.defaultChecked;else if("radio"==t.type)$(t).closest("form").find(':radio[name="'+t.name+'"]').each(function(e,t){a=a||t.checked!=t.defaultChecked});else if("INPUT,TEXTAREA".indexOf(t.tagName)>=0)a=t.value!=t.defaultValue;else if("SELECT"==t.tagName){var r,s,o,i=0;for(r=0,s=t.options.length;s>r;r++)o=t.options[r],a=a||o.selected!=o.defaultSelected,o.defaultSelected&&(i=r);a&&!t.multiple&&(a=i!=t.selectedIndex)}return a},spa.resetElDefaultValue=function(e){var a,t=$(e);if(t.length)if(a=t[0],",checkbox,radio".indexOf(a.type)>0)a.defaultChecked=a.checked;else if(",INPUT,TEXTAREA".indexOf(a.tagName)>0)a.defaultValue=a.value;else if("SELECT"==a.tagName){var n,r,s;for(n=0,r=a.options.length;r>n;n++)s=a.options[n],s.defaultSelected=s.selected}},spa.updateTrackFormCtrls=function(e){if(e){var a,t,n,r,s=$(e),o=s.find(".tracking-change.changed").length,i=spa.validateForm("#"+s.attr("id")),p=spa.isBlank(i)||1==i[0].errcode,l=!p||s.find(".validation-error,.validation-pending").length,c=o>0&&!l,u=!l,d=s.find(".ctrl-on-change,.ctrl-on-validate");s.attr("data-changed",o).data("changed",o),d.each(function(e,s){a=$(s),t=a.hasClass("ctrl-on-change")?c:u,n=a.attr("onBeforeChange"),spa.isBlank(n)||(n.indexOf("(")>0&&(n=n.getLeftStr("(")),r=spa.findSafe(window,n.trim(),void 0),t=spa.is(r,"function")?!!r.call(s,t):t),a.is(":disabled")==t&&(a.prop("disabled",!t).addClass(t?"":"disabled").removeClass(t?"disabled":""),a.trigger("change"))})}},spa.trackFormElChange=function _trackFormElChange(e,a){function t(e){if("change"==e.type||e.key&&(1==e.key.length||"BackspaceDelete".indexOf(e.key)>=0)){var a,t,n=!1,r=$(this).closest("form"),s=r.find(".tracking-change.changed").length;if("checkbox"==this.type)n=this.checked!=this.defaultChecked;else if("radio"==this.type)r.find(':radio[name="'+this.name+'"]').each(function(e,a){a.checked==a.defaultChecked&&$(a).removeClass("changed"),n=n||a.checked!=a.defaultChecked});else if("INPUT,TEXTAREA".indexOf(this.tagName)>=0)n=this.value!=this.defaultValue,t="change"!=e.type;else if("SELECT"==this.tagName){var o,i,p,l=0;for(o=0,i=this.options.length;i>o;o++)p=this.options[o],n=n||p.selected!=p.defaultSelected,p.defaultSelected&&(l=o);n&&!this.multiple&&(n=l!=this.selectedIndex)}$(this)[n?"addClass":"removeClass"]("changed"),spa.updateTrackFormCtrls(r),s!=a&&t&&r.trigger("change")}}function n(e){var a="change",n=$(e);if(",checkbox,radio".indexOf(e.type)>0)e.defaultChecked=e.checked;else if(",INPUT,TEXTAREA".indexOf(e.tagName)>0)e.defaultValue=e.value,a="keyup change";else{if("SELECT"!=e.tagName)return!1;var r,s,o;for(r=0,s=e.options.length;s>r;r++)o=e.options[r],o.defaultSelected=o.selected}return n.removeClass("track-change changed"),spa.updateTrackFormCtrls(n.closest("form")),0>e.className.indexOf("tracking-change")&&n.addClass("tracking-change").on(a,t),!0}var r=$(a||"body").find(e);r.each(function(e,a){"FORM"==a.tagName.toUpperCase()?spa.trackFormElChange($(a).find(".track-change").length?".track-change":"input,textarea,select",a):n(a)})},spa.initTrackFormElChanges=function(e){$(e||"body").find("form.track-changes,form:has(.ctrl-on-change,.track-change)").each(function(e,a){spa.console.info("Initializing Form Elements Track: Form ["+(a.id||a.name)+"]"),spa.trackFormElChange(a)})},spa.getModifiedElement=function(e){var a,t=void 0,n=$(e||"form:not([data-ignore-change]) :input:not(:disabled,:button,[data-ignore-change])");return _.every(n,function(e){return a||(e.tagName.match(/^(select|textarea)$/i)&&e.value!=e.defaultValue?a=!0:e.tagName.match(/^input$/i)&&(e.type.match(/^(checkbox|radio)$/i)&&e.checked!=e.defaultChecked?a=!0:e.type.match(/^(text|password|hidden|color|email|month|number|tel|time|url|range|date|datetime|datetime-local)$/i)&&e.value!=e.defaultValue&&(a=!0)),a&&(t=e)),!a}),t},spa.getModifiedElements=function(e){var a,t=[],n=$(e||"form:not([data-ignore-change]) :input:not(:disabled,:button,[data-ignore-change])");return n.each(function(e,n){a=!1,n.tagName.match(/^(select|textarea)$/i)&&n.value!=n.defaultValue?a=!0:n.tagName.match(/^input$/i)&&(n.type.match(/^(checkbox|radio)$/i)&&n.checked!=n.defaultChecked?a=!0:n.type.match(/^(text|password|hidden|color|email|month|number|tel|time|url|range|date|datetime|datetime-local)$/i)&&n.value!=n.defaultValue&&(a=!0)),a&&t.push(n)}),t},spa.initTrackElValueChanges=spa.resetElementsDefaultValue=function(e){$(e||"form :input:not(:disabled)").each(function(e,a){a.defaultValue=a.value,a.tagName.match(/^input$/i)&&a.type.match(/^(checkbox|radio)$/i)&&a.checked!=a.defaultChecked&&(a.defaultChecked=a.checked)})},spa.trash={container:[],push:function(e){this.container.push(e)},empty:function(){this.container=[]},pick:function(e){return e?this.container[e]:this.container}},spa.fillData=function(e,a,t){function n(){var t=s.keyFormat;t=null!=t.match(/^[a-z]/)?"aBc":t,t=null!=t.match(/^[A-Z]/)?"AbC":t;var n=spa.keysDotted(e);spa.console.group("fillData"),spa.console.info(n),_.each(n,function(n){spa.console.group(">>"+n);var r=""+(n.replace(/[\[\]]/g,"_")||""),o=n.replace(/\[[0-9]+\]/g,""),i=/\[[0-9]+\]/.test(n);switch(t){case"_":r=spa.dotToX(r,"_"),o=spa.dotToX(o,"_");break;case"AbC":r=spa.dotToTitleCase(r),o=spa.dotToTitleCase(o);break;default:r=spa.dotToCamelCase(r),o=spa.dotToCamelCase(o)}var p={patternKey:r+(i?" || "+o:""),formatterKey:o,isArrayChild:i};spa.trash.push(p),spa.console.info(p),spa.trash.empty();var l=s.selectPattern.replace(/\?/g,r);(s.keysMap[r]||s.keysMap[o])&&(s.keysMap[r]=s.keysMap[r]||{},s.keysMap[o]=s.keysMap[o]||{},s.keysMap[r].pattern=s.keysMap[r].pattern||s.keysMap[o].pattern,s.keysMap[r].pattern&&(l=s.keysMap[r].pattern.replace(/\?/g,r)),s.keysMap[o].formatter&&(s.formatterOnKeys=s.formatterOnKeys||{},s.formatterOnKeys[o]=s.keysMap[o].formatter));var c=$(a).find(l).length;spa.console.info(">> "+l+" found: "+c);var u=null;c>0&&(u=spa.find(e,n),!s.formatterOnKeys&&s.formatterCommon&&(u=s.formatterCommon(u,n,e)),s.formatterOnKeys&&(s.formatterOnKeys[o]?u=s.formatterOnKeys[o](u,n,e):s.formatterCommon&&(u=s.formatterCommon(u,n,e))),spa.console.info({value:u})),$(a).find(l).each(function(e,a){switch(spa.console.info(a),a.tagName.toUpperCase()){case"INPUT":switch(a.type.toLowerCase()){case"text":case"password":case"hidden":case"color":case"date":case"datetime":case"datetime-local":case"email":case"month":case"number":case"search":case"tel":case"time":case"url":case"range":case"button":case"submit":case"reset":$(a).val(u),!s.resetElDefaultInContext&&s.resetElDefault&&(a.defaultValue=a.value);break;case"checkbox":case"radio":a.checked=a.value.equalsIgnoreCase(u),!s.resetElDefaultInContext&&s.resetElDefault&&(a.defaultChecked=a.checked)}break;case"SELECT":spa.selectOptionForValue(a,u),!s.resetElDefaultInContext&&s.resetElDefault&&(a.defaultValue=a.value);break;case"TEXTAREA":$(a).val(u),!s.resetElDefaultInContext&&s.resetElDefault&&(a.defaultValue=a.value);break;default:$(a).html(spa.sanitizeXSS(u))}}),spa.console.groupEnd(">>"+n)}),spa.console.groupEnd("fillData"),s.resetElDefaultInContext&&spa.resetElementsDefaultValue(a+" :input")}var r="object"==typeof e;a&&"object"==typeof a&&(t=a,a=null),a=a||"body";var s={dataParams:{},method:"GET",async:!0,dataCache:!1,keyFormat:"aBc",selectPattern:"[name='?']",formatterCommon:null,formatterOnKeys:null,resetElDefault:!0,resetElDefaultInContext:!0,keysMap:{}};$.extend(s,t),r||$.ajax({url:e,method:(""+(s.method||"GET")).toUpperCase(),data:s.dataParams,cache:s.dataCache,async:s.async,dataType:"text",success:function(a){e=spa.toJSON(""+a),r="object"==typeof e,n()},error:function(a,t,n){spa.console.error("Failed loading data from ["+e+"]. ["+t+":"+n+"]"),spa.is(app.api.onError,"function")?app.api.onError.call(this,a,t,n):spa.api.onReqError.call(this,a,t,n)}})},spa.toRenderDataStructure=function(e,a,t){var n={},r={},s={},o={},i=function(e,a){return a&&Object.keys(a).length&&_.each(Object.keys(a),function(t){e=e.replace(RegExp("{"+t+"}","gi"),a[t])}),e};switch(a&&(o=_.isString(a)?spa.queryStringToJson(a):_.isObject(a)?a:{}),!0){case _.isString(e):e.containsStr("\\|")&&(n.dataModel=spa.getOnSplit(e,"|",0),e=spa.getOnLastSplit(1)),n.dataUrl=i(e,t),_.isEmpty(o)||(n.dataParams=o);break;case _.isArray(e):r={urls:[]},s={},_.each(e,function(e){s={url:i(e,t),params:o},e.containsStr("\\|")&&(s.target=spa.getOnSplit(e,"|",0),s.url=i(spa.getOnLastSplit(1),t)),r.urls.push(s)});break;case _.isObject(e):r={urls:[]},s={},_.each(_.keys(e),function(a){s={name:a,url:i(e[a],t),params:o},e[a].containsStr("\\|")&&(s.target=spa.getOnSplit(e[a],"|",0),s.url=i(spa.getOnLastSplit(1),t)),r.urls.push(s)})}return _.isEmpty(r.urls)||(n.dataCollection=r),n};var _$dataWatchList={};spa.env="",spa.compiledTemplates4DataBind={},spa.compiledTemplates={},spa.viewModels={},spa.renderHistory={},spa.renderHistoryMax=0,spa.components={},spa.tempBind$data={},spa.defaults={components:{templateEngine:"handlebars",rootPath:"app/components/",inFolder:!0,templateExt:".html",scriptExt:".js",templateScript:!1,templateCache:!0,dataPreRequest:"",render:"",callback:"",extend$data:!0},routes:{base:"#",attr:{route:"data-spa-route",params:"data-spa-route-params",onNavAway:"onNavAway"},className:{hide:"HIDE-SPA-NAV",block:"BLOCK-SPA-NAV",allow:"ALLOW-SPA-NAV"}},lang:{path:"app/language/",ext:".txt",cache:!0,async:!0},validation:{xss:{on:"input_onBlur",fn:"_check.xss",msg:"i18n:invalid.input"}},set:function(e,a){return spa.is(e,"object")?(e.hasOwnProperty("set")&&delete e.set,_.merge(this,e)):"string"==typeof e&&("components.extend$data"==e?spa.defaults.components.extend$data=a:spa.setSimpleObjProperty(this,e,a)),this}};var reservedCompNames="api,debug,lang";spa.component=spa.$=spa.registerComponent=function(e,a){if(reservedCompNames.indexOf(e)>=0)return console.error("Invalid component name "+e+". Reserved component names: api,debug,lang"),void 0;var t=!!a;if(a=a||{},is(e,"object")&&(a=_.merge({},e),e=a.name||a.componentName||"spaComponent"+spa.now()),is(e,"string")&&e&&(e=e.trim())){if(!t){var n,r,s=-1;return e.indexOf(" ")>0&&(n=e.getRightStr(" ").trim(),e=e.getLeftStr(" ")),e.indexOf(":")>0&&(s=spa.toInt(e.getRightStr(":").trim()),e=e.getLeftStr(":")),spa.components[e]||console.warn("Unknown SPA Component ["+e+"]."),r=$('[data-rendered-component="'+e+'"]'),r.length&&s>=0&&(r=$(r[s])),n&&r.length&&("<"==n[0]?(n=n.getRightStr(0).trim(),r=r.find("[data-rendered-component]").length?r.find(n).filter(function(){return $(this).closest("[data-rendered-component]").data("renderedComponent")==e}):r.find(n)):r=r.find(n)),r}if(e.replace(/[a-z0-9]/gi,""))return console.error("Invalid component name "+e+". Component name has invalid character."),void 0;if(spa.components[e])return;a.componentName=e,a.hasOwnProperty("beforeRender")||(a.beforeRender="app."+e+".onRender"),a.hasOwnProperty("renderCallback")||(a.renderCallback="app."+e+".renderCallback"),a.hasOwnProperty("require")&&spa.loadComponents(a.require,function(){spa.console.log("Required components successfully loaded.")},function(){spa.console.log("Failed to load required components.")}),a=_adjustComponentOptions(e,a);var o=["target","template","templateCache","templateScript","templateUrl","templateUrlMethod","templateUrlParams","templateUrlPayload","templateUrlHeaders","onTemplateUrlError","style","styleCache","styles","stylesCache","scripts","scriptsCache","require","dataPreRequest","data","dataCollection","dataUrl","dataUrlMethod","dataUrlParams","dataUrlHeaders","dataParams","dataType","dataModel","dataCache","dataDefaults","data_","dataExtra","dataXtra","onDataUrlError","onError","dataValidate","dataProcess","dataPreProcessAsync","beforeRender","componentName"],i=_.merge({},a);_.each(o,function(e){delete a[e]}),is(a.renderCallback,"string")&&delete a.renderCallback,_.each(Object.keys(a),function(e){delete i[e]}),i.renderCallback="app."+e+".renderCallback",spa.components[e]=i,spa.extendComponent(e,a)}},spa.$$=spa.registerComponents=function(){if(arguments.length){var e=arguments;1==arguments.length&&(e=_.isArray(arguments[0])?arguments[0]:_.isString(arguments[0])?arguments[0].split(","):arguments[0]),spa.is(e,"object")?_.each(Object.keys(e),function(a){spa.console.info("Registering spa-component:["+a+"]"),spa.registerComponent(a,e[a])}):e&&e.length&&_.each(e,function(e){spa.console.info("Registering spa-component:["+e+"]"),spa.registerComponent(e.trim())})}},spa.extendComponent=spa.$extend=spa.module=function(e,a){if(is(e,"object")&&(a=_.merge({},e),e=a.name||a.componentName||""+spa.now()),is(e,"string")&&e&&(e=e.trim())){if(reservedCompNames.indexOf(e)>=0)return console.error("Invalid component name "+e+". Reserved component names: "+reservedCompNames.join()),void 0;window.app=window.app||{},window.app[e]=window.app[e]||{},a&&_.isFunction(a)&&(a=a.call(spa.components[e]||{})),a=spa.is(a,"object")?a:{},spa.components[e]||(spa.components[e]={componentName:e,beforeRender:"app."+e+".onRender",renderCallback:"app."+e+".renderCallback"}),spa.components[e]&&(a.__prop__&&_.merge(spa.components[e],$.extend({},a.__prop__)),a.__prop__=spa.components[e]),$.extend(window.app[e],a),window["$$"+e]=window.app[e]}},spa.extendComponents=spa.$$extend=function(){if(arguments.length){var e=arguments;1==arguments.length&&(e=_.isArray(arguments[0])?arguments[0]:_.isString(arguments[0])?arguments[0].split(","):arguments[0]),spa.is(e,"object")?_.each(Object.keys(e),function(a){spa.console.info("Extend spa-component:["+a+"]"),spa.extendComponent(a,e[a])}):e&&e.length&&_.each(e,function(e){spa.console.info("Extend spa-component:["+e+"]"),spa.extendComponent(e.trim())})}},spa.$bind=function(e,a){spa.isBlank(a)&&(a=spa.findSafe(app,e+".$data",{})),spa.$(e).spaBindData(a)},spa.$data=function(e,a,t){function n(a){return spa.is(a,"object")&&(["update","merge"].__has(t,"i")?_.merge(app[e].$data,a):["*","reset","replace","overwrite"].__has(t,"i")&&(app[e].$data=a)),app[e].is$DataUpdated=spa.components[e].is$DataUpdated=!0,app[e].$data}var r;if(e=(e||"").trim(),t=t||"update",e)if(app.hasOwnProperty(e)){if(r=spa.findSafe(app,e+".$data"),a){r=n(spa.is(a,"function")?a.call(app[e],app[e].$data):a);var s=spa.$(e);if(s.is(":visible")){var o=spa.components[e],i=o.dataCache,p=(o.on$dataChange||"").trim().toLowerCase();i&&p&&["render","refresh","bind"].__has(p)&&(spa.console.log(e+"$"+p+" on $data update ..."),spa["$"+p](e)),spa.renderUtils.runCallbackFn("app."+e+".$dataChangeCallback",app[e].$data,app[e])}else console.log("Component is not visible! Skipped $on$dataChange.");spa.$dataNotify(e)}}else spa.console.warn("SPA Component[",e,"] is not loaded.");return r},spa.$dataWatch=function(e,a,t){return e&&a&&spa.is(t,"function")?(_$dataWatchList.hasOwnProperty(e)||(_$dataWatchList[e]={}),_$dataWatchList[e].hasOwnProperty(a)?(console.warn("$dataWatch [",a,"] already exists in spa$[",e,"]"),void 0):(_$dataWatchList[e][a]=t,!0)):void 0},spa.$dataUnwatch=function(e,a){var t;return e&&a&&_$dataWatchList.hasOwnProperty(e)&&("*"==a&&(delete _$dataWatchList[e],t=!0),_$dataWatchList[e].hasOwnProperty(a)&&(delete _$dataWatchList[e][a],t=!0)),t||console.warn("$dataWatch [",a,"] does not exist in spa$[",e,"]"),t},spa.$dataNotify=function(e,a){if(e&&_$dataWatchList.hasOwnProperty(e)){var t=Object.keys(_$dataWatchList[e]);a&&(t=a.split(",")),_.each(t,function(a){a=(a||"").trim(),_$dataWatchList[e].hasOwnProperty(a)&&_$dataWatchList[e][a].call(void 0,app[e].$data,app[e],a)})}},spa.$renderCount=function(e){return spa.findSafe(window,"app."+e+".__renderCount__",0)},spa.removeComponent=function(e,a){function t(e){e=e.trim();var t,n=spa.isBlank(e);return n||(t=spa.renderUtils.runCallbackFn("app."+e+".onRemove",a||"_script_",app[e]),n=spa.is(t,"undefined")||spa.is(t,"boolean")&&t,n||spa.console.warn("Remove $"+e+" request denied onRemove()")),n}var n;if(e=(e||"").trim(),a&&(a=e==a?"_self_":a),e){var r=$('[data-rendered-component="'+e+'"]');if(r.length){var s=r.find("[data-rendered-component]").map(function(){return $(this).attr("data-rendered-component")}),o=0==s.length||_.every(s,function(e){return t(e)});o&&t(e)&&(r.html("").text("").val("").data("renderedComponent","").removeAttr("data-rendered-component"),n=!0)
}else n=!0}return spa.is(n,"boolean")&&n},spa.destroyComponent=function(e){var a;if(e=(e||"").trim(),e&&spa.removeComponent(e)&&(delete app[e],spa.components[e])){var t=spa.findSafe(spa.components[e],"template","");t&&!t.beginsWithStr("#")&&(t="#__tmpl_"+(""+t).replace(/[^a-z0-9]/gi,"_")),$("script"+t).remove(),delete spa.components[e],delete spa.compiledTemplates4DataBind[e],delete spa.compiledTemplates[e],delete _$dataWatchList[e],a=!0}return a},spa.showComponent=function(e){e=(e||"").trim(),e&&$('[data-rendered-component="'+e+'"]').show()},spa.hideComponent=function(e){e=(e||"").trim(),e&&$('[data-rendered-component="'+e+'"]').hide()},spa.disableComponent=function(e){e=(e||"").trim(),e&&$('[data-rendered-component="'+e+'"]').css("pointer-events","none").addClass("disabled").attr("disabled","disabled")},spa.enableComponent=function(e){e=(e||"").trim(),e&&$('[data-rendered-component="'+e+'"]').css("pointer-events","auto").removeClass("disabled").removeAttr("disabled")},spa.removeComponents=spa.$remove=spa.$$remove=function(){_spaComponentOp.apply({action:"removeComponent"},arguments)},spa.destroyComponents=spa.$destroy=spa.$$destroy=function(){_spaComponentOp.apply({action:"destroyComponent"},arguments)},spa.showComponents=spa.$show=spa.$$show=function(){_spaComponentOp.apply({action:"showComponent"},arguments)},spa.hideComponents=spa.$hide=spa.$$hide=function(){_spaComponentOp.apply({action:"hideComponent"},arguments)},spa.enableComponents=spa.$enable=spa.$$enable=function(){_spaComponentOp.apply({action:"enableComponent"},arguments)},spa.disableComponents=spa.$disable=spa.$$disable=function(){_spaComponentOp.apply({action:"disableComponent"},arguments)},spa.refreshComponent=spa.$refresh=function(e,a){e&&(a=a||{},spa.is(a,"object")&&(a.hasOwnProperty("beforeRender")||(a.beforeRender=a.beforeRefresh||"app."+e+".onRefresh"),a.hasOwnProperty("renderCallback")||(a.renderCallback=a.refreshCallback||"app."+e+".refreshCallback"),a.isRefreshCall=!0,spa.console.info("Calling refreshComponent: "+e+" with below options"),spa.console.info(a),spa.$render(e,a)))},spa.renderComponent=spa.$render=function(e,a){if(e){if(!(a&&is(a,"object")&&a.isRefreshCall)&&spa.$renderCount(e)&&spa.findSafe(window,"app."+e+".refreshCallback",""))return spa.console.info("Component ["+e+"] has been rendered already. Refreshing instead of re-render."),spa.refreshComponent(e,a),void 0;is(e,"object")&&(a=_.merge({},e),e=a.name||a.componentName||""+spa.now(),a.componentName=e),spa.console.info("Called renderComponent: "+e+" with options",a);var t=/[^a-z0-9]/gi.test(e);if(t){var n,r=e;if(e[0]===spa.api.urlKeyIndicator&&(n=e.trimLeftStr(spa.api.urlKeyIndicator),r=spa.api.urls[n]||""),a.componentUrl=r,spa.console.info("Called to render ServerComponent: ["+e+"] with options",a),n&&!r&&console.warn("ComponentURL undefined: app.api.urls."+n),r){var s=a.targetEl,o=__finalValue(spa.toJSON(a.urlHeaders),a),i=__finalValue(spa.toJSON(a.urlParams),a),p=__finalValue(spa.toJSON(a.urlPayload),a),l=(a.urlMethod||"GET").toLowerCase(),c="false"!==((a.urlCache||"false")+"").toLowerCase(),u=spa.api.url(r,i),d=__finalValue(a.urlError);spa.console.log("Loading ServerComponent ..."),spa.api[l](u,p,function(e){$(s).html(e),spa.renderComponentsInHtml(s)},function(e,a,t){this.onError&&_is(this.onError,"function")?this.onError.call(this,e,a,t):(console.warn("Unable to load ServerComponent."),console.error((a+"").toUpperCase()+":"+t,e))},{ajaxOptions:{dataType:"html",headers:o,cache:c,onError:d}})}}else{var f="_rtt_"+e,m="";a=_adjustComponentOptions(e,a);var g=spa.defaults.components.rootPath+(spa.defaults.components.inFolder?e+"/":""),h=g+e,v=h+spa.defaults.components.templateExt,y=spa.defaults.components.scriptExt,b=a&&_.isObject(a)&&a.hasOwnProperty("script")?a.script:y?h+y:"",S=function(){if(spa.console.info("_renderComp > "+e+" with below options"),spa.console.info(a),!spa.components[e].hasOwnProperty("template"))if(spa.components[e].hasOwnProperty("templateStr")||spa.components[e].hasOwnProperty("templateString"))m=spa.components[e].templateStr||spa.components[e].templateString||"",spa.updateTemplateScript(f,m),spa.components[e].template="#"+f;else if(spa.hasPrimaryKeys(spa.components[e],"templateUrl")){var t=(spa.components[e].templateUrl||"").trim();t&&/^(\.\/)/.test(t)&&(t=g+t.substr(2)),spa.components[e].template=t}else spa.components[e].template=v;spa.console.info("render-options: spa.components["+e+"]"),spa.console.info(spa.components[e]);var n=a&&a.saveOptions?spa.components[e]:$.extend({},spa.components[e]);if(a&&(a.hasOwnProperty("mountComponent")||delete n.mountComponent,$.extend(n,a),spa.console.info("Extended> render-options: spa.components["+e+"]"),spa.console.info(n)),n.hasOwnProperty("style")&&spa.is(n.style,"string")&&(n.dataStyles={},n.dataStyles[e+"Style"]="."==n.style||"$"==n.style?h+".css":n.style,delete n.style,spa.console.info("Using component style for ["+e+"]"),spa.console.info(n)),n&&_.isObject(n)&&n.dataCache){var r=spa.findSafe(app,e+".$data",{});spa.isBlank(r)?(n.dataCache=!1,spa.console.log("dataCache:false; Using/Ajaxing new data ...")):(n.data=r,n.dataProcess=!1,spa.console.log("dataCache:true; Using $data and ingored data + dataProcess ..."))}spa.render(n)},O=function(){b?spa.console.info("Loaded component ["+e+"] source from ["+b+"]"):spa.console.info("Skipped Loading component ["+e+"] source from script file."),spa.console.info("In Source> spa.components["+e+"]"),spa.console.info(spa.components[e]),spa.components.hasOwnProperty(e)||(spa.console.warn("spa.components["+e+"] NOT DEFINED in ["+(b||"spa.components")+"]. Creating *NEW*"),spa.isBlank(a)&&(a={}),a.hasOwnProperty("componentName")||(a.componentName=e),spa.components[e]=a,spa.console.info("NEW> spa.components["+e+"]"),spa.console.info(spa.components[e])),S()};spa.components.hasOwnProperty(e)?(spa.console.info("Re-rending spa.components["+e+"]"),spa.console.info(spa.components[e]),S()):b?(spa.console.info("Loading component ["+e+"] source from ["+b+"]"),$.cachedScript(b,{success:O}).done(spa.noop).fail(function(){console.warn("Failed Loading component ["+e+"] source from ["+b+"]. Continue Loading component with default properties."),O()})):O()}}},spa.renderComponents=spa.$$render=function(){_spaRenderRefreshComponents.apply({action:"renderComponent"},arguments)},spa.refreshComponents=spa.$$refresh=function(){_spaRenderRefreshComponents.apply({action:"refreshComponent"},arguments)},spa.renderComponentsInHtml=function(e,a){e=e||"body",a=(a||"").trim(),$(e).find("spa-component[src]:not([data-spa-component]),x-component[src]:not([data-spa-component])").each(function(){this.setAttribute("data-spa-component",this.getAttribute("src"))});var t=$(e).find("[data-spa-component]");if(t.length){var n,r,s,o,i,p,l;t.each(function(e,t){if(n=$(t),l=n.data(),r=(n.attr("data-spa-component")||"").split("|"),s=r[0].trim(),o=(r[1]||"").trim(),o&&(/\:\s*\$data/.test(o)&&(o=o.replace(/\:\s*\$data/g,":app."+a+".$data")),o=spa.toJSON(o)),s){if(!t.id){var c=s.replace(/[^a-z0-9]/gi,"");p="spaCompContainer_"+c+"_"+($("body").find("[rel=spaComponentContainer_"+c+"]").length+1),t.id=p,t.setAttribute("rel","spaComponentContainer_"+c)}var u=n.attr("data-spa-component-options")||n.attr("data-spa-$options")||n.attr("spa-$options")||"{}";if(i=_.merge({target:"#"+t.id,targetEl:t,spaComponent:s.trim()},o,l,spa.toJSON(u)),i.hasOwnProperty("data")&&spa.is(i.data,"string")){var d=i.data.trim();/^\$data/.test(d)&&(d="app."+a+"."+d),i.data=_.merge({},spa.findSafe(window,d,{}))}var f=(n.attr("data-spa-component-$data")||n.attr("data-spa-$data")||n.attr("spa-$data")||"").trim();if(f&&(/\:\s*\$data/.test(f)&&(f=f.replace(/\:\s*\$data/g,":app."+a+".$data")),spa.isBlank(i.data)?i.data=spa.toJSON(f):_.merge(i.data,spa.toJSON(f))),!spa.isBlank(i.data)&&i.data.hasOwnProperty("$data")){var m=_.merge({},i.data.$data);delete i.data.$data,_.merge(i.data,m)}i.hasOwnProperty("data")&&(i.data_=_.merge({},i.data),delete i.data),spa.console.log("inner-component",s,"options:",i),spa.renderComponent(s,i)}})}},spa.renderUtils={array2ObjWithKeyPrefix:function(e,a,t){var n={};return _.each(e,function(e){e=(""+e).trimStr(),e&&(n[a+(e.equals(".")?t:e).replace(/[^a-z0-9]/gi,"_")]=""+e)}),spa.console.log([a,n]),n},getFn:function(e){var a,t=e;return e&&_.isString(e)&&(t=spa.findSafe(window,e)),t&&_.isFunction(t)?t:a},runCallbackFn:function(e,a,t){if(e){var n,r=e,s=t;if(_.isString(r)&&(s||(e.match("]$")?n=e.substring(0,e.lastIndexOf("[")):e.indexOf(".")>0&&(n=e.substring(0,e.lastIndexOf("."))),s=n?spa.findSafe(window,n):window),r=spa.findSafe(window,r)),r){if(_.isFunction(r))return spa.console.info("calling callback: "+e),spa.is(a,"array")&&"(...)"==a[0]?(a.shift(),r.apply(s,a)):r.call(s,a);spa.console.error("CallbackFunction <"+e+" = "+r+"> is NOT a valid FUNCTION.")}else spa.console.warn("CallbackFunction <"+e+"> is NOT defined.")}},registerComponentEvents:function(e){if(e&&app[e]&&app[e].hasOwnProperty("events")){var a,t;_.each(Object.keys(app[e].events),function(n){app[e].events[n].hasOwnProperty("target")&&!spa.isBlank(app[e].events[n].target)&&(a=app[e].events[n].target,t=spa.$(e+" "+a),t.filter(":not([spa-events-"+n+'="'+e+'"])').attr("spa-events-"+n,e).each(function(a,t){_.each(Object.keys(app[e].events[n]),function(a){0==a.indexOf("on")&&_.each(a.split("_"),function(r){spa.console.log("registering component ["+e+"] event: "+n+"-"+r),$(t).on(r.trimLeftStr("on").toLowerCase(),app[e].events[n][a])})})}))})}}},spa.render=function(viewContainerId,uOptions){function _fixRefreshCalls(e,a,t){spa.is(spaRVOptions[e],"string")&&spaRVOptions[e]=="app."+rCompName+a&&app[rCompName].hasOwnProperty(t)&&(spaRVOptions[e]="app."+rCompName+"."+t)}if(spa.console.log("spa.render",viewContainerId,uOptions),arguments.length){if(1===arguments.length&&"object"==typeof viewContainerId){if(uOptions=_.merge({},viewContainerId),uOptions.hasOwnProperty("target"))viewContainerId=uOptions.target,delete uOptions.target;else{var oldTarget=$('[data-rendered-component="'+uOptions.componentName+'"]').attr("id");viewContainerId=(oldTarget?"#":"")+oldTarget,viewContainerId||(spa.console.warn("Render target is missing."),viewContainerId="dynRender_"+spa.now()+"_"+spa.rand(1e3,9999))}return spa.render(viewContainerId,uOptions),void 0}uOptions&&function transOptions(e){var a={template:"dataTemplate",templates:"dataTemplates",templateCache:"dataTemplatesCache",templatesCache:"dataTemplatesCache",html:"dataTemplate",htmls:"dataTemplates",htmlCache:"dataTemplatesCache",htmlsCache:"dataTemplatesCache",script:"dataScripts",scripts:"dataScripts",scriptCache:"dataScriptsCache",scriptsCache:"dataScriptsCache",style:"dataStyles",styles:"dataStyles",styleCache:"dataStylesCache",stylesCache:"dataStylesCache",renderType:"dataRenderType",beforeRender:"dataBeforeRender",dataRenderCallBack:"dataRenderCallback",renderCallback:"dataRenderCallback",renderCallBack:"dataRenderCallback",callback:"dataRenderCallback",callBack:"dataRenderCallback",onRemove:"dataRemoveCallback",dataRenderMode:"dataRenderMode",renderMode:"dataRenderMode",renderId:"dataRenderId"};_.each(a,function(a,t){e.hasOwnProperty(t)&&(e[a]=uOptions[t],delete e[t])})}(uOptions);var retValue={id:"",view:{},model:{},cron:"",elDataAttr:{},target:viewContainerId,iOptions:uOptions},spaAjaxRequestsQue=[],doDeepRender=!1,foundViewContainer=spa.isElementExist(viewContainerId);foundViewContainer&&(retValue.elDataAttr=$(viewContainerId).data());var noOfArgs=arguments.length,useOptions=noOfArgs>1,useParamData=useOptions&&uOptions.hasOwnProperty("data"),dataFound=!0,rCompName=uOptions&&uOptions.componentName?uOptions.componentName:"",spaRVOptions={data:{},dataPreRequest:spa.defaults.components.dataPreRequest,dataUrl:"",dataUrlParams:{},dataUrlMethod:"GET",dataUrlErrorHandle:"",dataUrlHeaders:{},dataParams:{},dataType:"",dataExtra:{},dataXtra:{},data_:{},dataDefaults:{},dataModel:"",dataValidate:!1,dataProcess:"",dataCache:!1,extend$data:spa.defaults.components.extend$data,dataCollection:{},dataTemplates:{},dataTemplate:"",dataTemplatesCache:!0,templateScript:!1,templateEngine:"",dataScripts:{},dataScriptsCache:!0,dataStyles:{},dataStylesCache:!0,dataBeforeRender:"",dataRenderCallback:"",dataRemoveCallback:"",dataRenderMode:"",skipDataBind:!1,render:"",dataRenderId:""};if(foundViewContainer||(spa.isElementExist("#spaRunTimeHtmlContainer")||$("body").append("<div id='spaRunTimeHtmlContainer' style='display:none;'></div>"),$("#spaRunTimeHtmlContainer").append("<div id='"+viewContainerId.replace(/\#/gi,"")+"'></div>")),useOptions){var _globalCompOptions={dataTemplatesCache:spa.defaults.components.templateCache};uOptions=_.merge({},_globalCompOptions,uOptions);var saveOptions=uOptions.hasOwnProperty("saveOptions")&&uOptions.saveOptions;for(var key in uOptions)spaRVOptions[key]=uOptions[key],saveOptions&&"data"!==key&&"saveOptions"!==key&&$(viewContainerId).data(""+(""+(_.at(""+key,4)||"")).toLowerCase()+key.slice(5),spa.toStr(uOptions[key]))}spa.console.log(rCompName+".$"+(spaRVOptions.isRefreshCall?"refresh":"render")+" with options:",spaRVOptions,"$data",spa.findSafe(app,rCompName+".$data"));var $viewContainerId=$(viewContainerId),pCompName=$viewContainerId.attr("data-rendered-component")||"",is$refresh=pCompName==rCompName;if(_isSpaNavBlocked($viewContainerId)){spa.console.log("Component container [",viewContainerId,"] blocks navigation.");var $navBlockContainer=$viewContainerId.hasClass(_blockNavClassName)?$viewContainerId:$viewContainerId.find(_blockNavClass);if($navBlockContainer.length>1&&($navBlockContainer=$($navBlockContainer[0])),$navBlockContainer.length){var onNavAway=($navBlockContainer.attr(_attrOnNavAway)||"").trim(),navAwayFn,navAwayFnRes;if(onNavAway){if("#"==onNavAway[0]||">"==onNavAway[0]){var navAwayTargetSelector=">"==onNavAway[0]?onNavAway.substr(1).trim():onNavAway,$navAwayTarget=$navBlockContainer.find(navAwayTargetSelector).filter(":not(.disabled):not(:disabled)");if($navAwayTarget.length)return $navAwayTarget.trigger("click"),void 0}else if(navAwayFn=spa.findSafe(window,onNavAway.split("(")[0].split(";")[0]),navAwayFn&&spa.is(navAwayFn,"function")&&(navAwayFnRes=navAwayFn.call(app[pCompName],app[pCompName],app[rCompName])),navAwayFn&&(!spa.is(navAwayFnRes,"boolean")||!navAwayFnRes))return}else if(navAwayFn=spa.findSafe(app,pCompName+".onNavBlock"),navAwayFn&&spa.is(navAwayFn,"function")&&(navAwayFnRes=navAwayFn.call(app[pCompName],app[pCompName],app[rCompName])),navAwayFn&&(!spa.is(navAwayFnRes,"boolean")||!navAwayFnRes))return}spa.console.log("Render continues.")}is$refresh&&(spa.console.log("$refresh - Auto-Detected",rCompName,spaRVOptions),"auto".equalsIgnoreCase(""+spaRVOptions.render)&&(spa.console.log("Finding for refresh events."),_fixRefreshCalls("dataBeforeRender",".onRender","onRefresh"),_fixRefreshCalls("dataRenderCallback",".renderCallback","refreshCallback")));var _renderOptionInAttr=function(e){return(""+$viewContainerId.data(e)).replace(/undefined/,"")},_renderOption=function(e,a){return spa.isBlank(spaRVOptions[e])?_renderOptionInAttr(a):spaRVOptions[e]},spaRenderId=_renderOption("dataRenderId","renderId");retValue.id=spaRenderId.ifBlankStr("spaRender"+spa.now()+spa.rand(1e3,9999));var targetRenderMode=_renderOption("dataRenderMode","renderMode")||"replace";spa.console.log("Render Mode: <"+targetRenderMode+">");var spaTemplateType="x-spa-template",spaTemplateEngine=(spaRVOptions.templateEngine||spa.defaults.components.templateEngine||"handlebars").toLowerCase();if(spa.console.group("spaLoadingViewScripts"),useOptions&&uOptions.hasOwnProperty("dataScriptsCache"))spa.console.info("Override [data-scripts-cache] with user option [dataScriptsCache]: "+spaRVOptions.dataScriptsCache);else{var scriptsCacheInTagData=_renderOptionInAttr("scriptsCache");spa.isBlank(scriptsCacheInTagData)||(spaRVOptions.dataScriptsCache=scriptsCacheInTagData.toBoolean(),spa.console.info("Override [data-scripts-cache] with [data-scripts-cache] option in tag-attribute: "+spaRVOptions.dataScriptsCache))}var vScriptsList=_renderOptionInAttr("scripts");vScriptsList&&spa.isBlank((vScriptsList||"").replace(/[^:'\"]/g,""))&&(vScriptsList="'"+vScriptsList.split(",").join("','")+"'");var vScripts=spa.toJSON(vScriptsList||"{}");!_.isObject(spaRVOptions.dataScripts)&&_.isString(spaRVOptions.dataScripts)&&(vScriptsList=(spaRVOptions.dataScripts||"").trimStr(),spa.isBlank((vScriptsList||"").replace(/[^:'\"]/g,""))&&(vScriptsList="'"+vScriptsList.split(",").join("','")+"'"),spaRVOptions.dataScripts=spa.toJSON(vScriptsList)),$.isEmptyObject(spaRVOptions.dataScripts)||(vScripts=spaRVOptions.dataScripts),_.isArray(vScripts)&&_.remove(vScripts,function(e){return!e}),spa.console.info(vScripts);var vScriptsNames;if(vScriptsList=[],vScripts&&!$.isEmptyObject(vScripts)){if(_.isArray(vScripts)){spa.console.info("Convert array of script(s) without scriptID to object with scriptID(s).");var newScriptsObj=spa.renderUtils.array2ObjWithKeyPrefix(vScripts,"__scripts_",viewContainerId);spa.console.info("Scripts(s) with scriptID(s)."),spa.console.log(newScriptsObj),vScripts=_.isEmpty(newScriptsObj)?{}:newScriptsObj}spa.console.info("External scripts to be loaded [cache:"+spaRVOptions.dataScriptsCache+"] along with view container ["+viewContainerId+"] => "+JSON.stringify(vScripts)),vScriptsNames=_.keys(vScripts)}else spa.console.info("No scripts defined [data-scripts] in view container ["+viewContainerId+"] to load.");if(spa.console.groupEnd("spaLoadingViewScripts"),vScriptsNames){var scriptPath;vScriptsList=_.map(vScriptsNames,function(e){return scriptPath=_getFullPath4Component(vScripts[e],rCompName),scriptPath.endsWithStrIgnoreCase(".js")||(scriptPath+=spa.defaults.components.scriptExt),(spaRVOptions.dataScriptsCache?"":"~")+scriptPath})}return spa.console.log("component [",rCompName,"] scripts:",vScriptsList),spa.loadScriptsSync(vScriptsList,function _onScriptsLoadComplete(){spa.console.info("External Scripts Loaded."),!_appApiInitialized&&Object.keys(app.api).length&&_initApiUrls();var dataPreRequest=spaRVOptions?spaRVOptions.dataPreRequest:"";if(spa.is(dataPreRequest,"string")&&(dataPreRequest=spa.renderUtils.getFn(dataPreRequest)),spa.is(dataPreRequest,"function"))try{var dataPreRequestRes=dataPreRequest.call(app[rCompName]);dataPreRequestRes&&spa.is(dataPreRequestRes,"object")&&Object.keys(dataPreRequestRes).forEach(function(e){0==e.indexOf("data")&&(spaRVOptions[e]=dataPreRequestRes[e])})}catch(ex){console.error("dataPreRequest-Error in app."+rCompName,ex)}spa.console.group("spaDataModel");var dataModelName=_renderOption("dataModel","model"),dataModelUrl=_renderOption("dataUrl","url"),viewDataModelName,isLocalDataModel=useParamData||dataModelUrl.beginsWithStrIgnoreCase("local:"),defaultDataModelName=dataModelUrl.beginsWithStrIgnoreCase("local:")?dataModelUrl.replace(/local:/gi,""):"data",defPayLaod=_appApiDefaultPayload(),dataUrlPayLoad,_stringifyPayload=spaRVOptions&&spaRVOptions.hasOwnProperty("stringifyPayload")?spaRVOptions.stringifyPayload:spa.findSafe(app,"api.ajaxOptions.stringifyPayload");dataModelName=dataModelName.ifBlankStr(defaultDataModelName),viewDataModelName=dataModelName.replace(/\./g,"_");var spaTemplateModelData={};if(useParamData)spaTemplateModelData[viewDataModelName]=spa.is(spaRVOptions.data,"function")?spaRVOptions.data():spaRVOptions.data,spa.console.info("Loaded data model ["+dataModelName+"] from argument");else{if(useOptions&&uOptions.hasOwnProperty("dataCache"))spa.console.info("Override [data-cache] with user option [dataCache]: "+spaRVOptions.dataCache);else{var dataCacheInTagData=_renderOptionInAttr("cache");spa.isBlank(dataCacheInTagData)||(spaRVOptions.dataCache=dataCacheInTagData.toBoolean(),spa.console.info("Override [data-cache] with [data-cache] option in tag-attribute: "+spaRVOptions.dataCache))}if(spa.isBlank(dataModelUrl)){spaTemplateModelData[viewDataModelName]={};var dataModelCollection=_renderOptionInAttr("collection");dataModelCollection&&(dataModelCollection=spa.toJSON(dataModelCollection)),spa.isBlank(spaRVOptions.dataCollection)||(dataModelCollection=spaRVOptions.dataCollection),_.isArray(dataModelCollection)&&(dataModelCollection={urls:dataModelCollection});var dataModelUrls=dataModelCollection.urls;if(spa.isBlank(dataModelUrls))spa.console.warn("Model Data ["+dataModelName+"] or [data-url] or [data-collection] NOT found! Check the arguments or html markup. Rendering with options."),spaTemplateModelData[viewDataModelName]=_.merge({},spaRVOptions.dataDefaults,spaRVOptions.data_,spaRVOptions.dataExtra,spaRVOptions.dataXtra);else if(_.isArray(dataModelUrls)){spa.console.info("Processing data-URLs");var dataIndexApi=0,defaultAutoDataNamePrefix=dataModelCollection.nameprefix||"data";_.each(dataModelUrls,function(e){var a=defaultAutoDataNamePrefix+dataIndexApi,t=_.has(e,"name")?(""+e.name).replace(/[^a-zA-Z0-9]/gi,""):_.has(e,"target")?""+e.target:a,n=_.has(e,"url")?e.url:_.has(e,"path")?e.path:"";if(t.containsStr(".")&&(t=_.last(t.split("."),1)),t=t.ifBlankStr(a),spa.console.info("processing data-api for: "+t),spa.console.log(e),n){_.has(e,"urlParams")&&(n=spa.api.url(n,e.urlParams));var r=_.has(e,"headers")?e.headers:spaRVOptions.dataUrlHeaders;spa.isBlank(r)&&(r=spa.findSafe(window,"app.api.ajaxOptions.headers",{})),dataUrlPayLoad=_.has(e,"params")?e.params:_.has(e,"data")?e.data:{},_.has(e,"defaultPayload")||spa.isBlank(defPayLaod)||(dataUrlPayLoad=_.merge({},defPayLaod,!spa.isBlank(dataUrlPayLoad)&&spa.is(dataUrlPayLoad,"object")?dataUrlPayLoad:{})),!spa.isBlank(dataUrlPayLoad)&&_stringifyPayload&&(dataUrlPayLoad=JSON.stringify(dataUrlPayLoad)),spaAjaxRequestsQue.push($.ajax({url:n,method:(""+(e.method||"GET")).toUpperCase(),headers:spa.is(r,"function")?r():r,data:dataUrlPayLoad,cache:_.has(e,"cache")?e.cache:spaRVOptions.dataCache,dataType:_.has(e,"type")?e.type:spaRVOptions.dataType||spa.findSafe(window,"app.api.ajaxOptions.dataType","text"),success:function(a,r,s){var o,i=_.has(e,"target")?""+e.target:"",p=spa.is(a,"string")?spa.toJSON(""+a,"data"):a;if(i.indexOf(".")>0)o=spa.hasKey(p,i)?spa.find(p,i):p;else try{o=p.hasOwnProperty(i)?p[i]:p}catch(l){console.warn("Error in Data Model ["+i+"] in URL ["+n+"].\n"+l.stack)}spaTemplateModelData[viewDataModelName][t]?(spaTemplateModelData[viewDataModelName][t]=[spaTemplateModelData[viewDataModelName][t]],spaTemplateModelData[viewDataModelName][t].push(o)):spaTemplateModelData[viewDataModelName][t]=o,spa.console.info("Loaded data model ["+t+"] from ["+n+"]");var c=e.success||e.onsuccess||e.onSuccess;if(c||(c=dataModelCollection.success||dataModelCollection.onsuccess||dataModelCollection.onSuccess),c)if(_.isFunction(c))c.call(this,p,e,r,s);else if(_.isString(c)){var u=spa.findSafe(window,c);"function"==typeof u?u.call(this,p,e,r,s):spa.console.log("Unknown ajax success handle: "+c)}},error:function(a,t,r){spa.console.warn("Error processing data-api ["+n+"]");var s=e.error||e.onerror||e.onError;if(!s){s=dataModelCollection.error||dataModelCollection.onerror||dataModelCollection.onError;var o=spaRVOptions.dataUrlErrorHandle||spaRVOptions.onDataUrlError||spaRVOptions.onError;!s&&o&&(s=o)}if(s){if(_.isFunction(s))s.call(this,a,t,r);else if(_.isString(s)){var i=spa.findSafe(window,s);"function"==typeof i?i.call(this,oResult,e):spa.console.log("Unknown ajax error handle: "+s)}}else spa.is(app.api.onError,"function")?app.api.onError.call(this,a,t,r):spa.api.onReqError.call(this,a,t,r)}}))}else spa.console.error("data-api-url not found. Please check the arguments or html markup. Skipped this data-api request");dataIndexApi++})}else spa.console.warn("Invalid [data-urls].Check the arguments or html markup. Rendering with empty data {}.")}else if(dataModelUrl.beginsWithStrIgnoreCase("local:")){var localDataModelName=dataModelUrl.replace(/local:/gi,""),localDataModelObj={};if(_isValidEvalStr(localDataModelName)&&(eval("("+localDataModelName+")")!==void 0&&eval("(localDataModelObj="+localDataModelName+")"),spa.console.info("Using LOCAL Data Model: "+localDataModelName)),!isLocalDataModel&&dataModelName.indexOf(".")>0)spaTemplateModelData[viewDataModelName]=spa.hasKey(localDataModelObj,dataModelName)?spa.find(localDataModelObj,dataModelName):localDataModelObj;else try{spaTemplateModelData[viewDataModelName]=localDataModelObj.hasOwnProperty(dataModelName)?localDataModelObj[dataModelName]:localDataModelObj}catch(e){console.warn("Error in Data Model ["+dataModelName+"] in Local Object ["+localDataModelName+"].\n"+e.stack)}}else{spa.isBlank(spaRVOptions.dataUrlParams)||(dataModelUrl=spa.api.url(dataModelUrl,spaRVOptions.dataUrlParams)),spa.console.info("Request Data ["+dataModelName+"] [cache:"+spaRVOptions.dataCache+"] from URL =>"+dataModelUrl);var ajaxReqHeaders=spaRVOptions.dataUrlHeaders;spa.isBlank(ajaxReqHeaders)&&(ajaxReqHeaders=spa.findSafe(window,"app.api.ajaxOptions.headers",{})),dataUrlPayLoad=spaRVOptions.dataParams,spaRVOptions.hasOwnProperty("defaultPayload")||spa.isBlank(defPayLaod)||(dataUrlPayLoad=_.merge({},defPayLaod,!spa.isBlank(dataUrlPayLoad)&&spa.is(dataUrlPayLoad,"object")?dataUrlPayLoad:{})),!spa.isBlank(dataUrlPayLoad)&&_stringifyPayload&&(dataUrlPayLoad=JSON.stringify(dataUrlPayLoad));var axOptions={url:dataModelUrl,method:(""+(_renderOption("dataUrlMethod","urlMethod")||"GET")).toUpperCase(),headers:spa.is(ajaxReqHeaders,"function")?ajaxReqHeaders():ajaxReqHeaders,data:dataUrlPayLoad,cache:spaRVOptions.dataCache,dataType:spaRVOptions.dataType||spa.findSafe(window,"app.api.ajaxOptions.dataType","text"),success:function(e){var a=spa.is(e,"string")?spa.toJSON(""+e,"data"):e,t=_renderOption("dataValidate","validate");if(dataModelName.indexOf(".")>0)spaTemplateModelData[viewDataModelName]=spa.hasKey(a,dataModelName)?spa.find(a,dataModelName):a;else try{"data"!=dataModelName||a.hasOwnProperty(dataModelName)||(dataModelName="Data",viewDataModelName="Data"),spaTemplateModelData[viewDataModelName]=!t&&a.hasOwnProperty(dataModelName)?a[dataModelName]:a}catch(n){console.error("Error in Data Model ["+dataModelName+"] in URL ["+dataModelUrl+"].\n"+n.stack)}spa.console.info("Loaded data model ["+dataModelName+"] from ["+dataModelUrl+"]")},error:function(e,a,t){var n=_renderOption("dataUrlErrorHandle","urlErrorHandle");if(spa.isBlank(n))spa.is(app.api.onError,"function")?app.api.onError.call(this,e,a,t):spa.api.onReqError.call(this,e,a,t);else{var r=spa.findSafe(window,n);"function"==typeof r?r.call(this,e,a,t):spa.console.log("Unknown ajax error handle: "+n)}}};spaAjaxRequestsQue.push($.ajax(axOptions))}}if(spa.console.info("End of Data Processing"),spa.console.log({o:spaTemplateModelData}),spa.console.groupEnd("spaDataModel"),dataFound){var vTemplate2RenderInTag=_renderOptionInAttr("template")||_renderOptionInAttr("html"),vTemplatesList=_renderOptionInAttr("templates")||_renderOptionInAttr("htmls");vTemplatesList&&spa.isBlank((vTemplatesList||"").replace(/[^:'\"]/g,""))&&(vTemplatesList="'"+vTemplatesList.split(",").join("','")+"'");var vTemplates=spa.toJSON(vTemplatesList||"{}");if(!_.isObject(spaRVOptions.dataTemplates)&&_.isString(spaRVOptions.dataTemplates)&&(vTemplatesList=(spaRVOptions.dataTemplates||"").trimStr(),spa.isBlank((vTemplatesList||"").replace(/[^:'\"]/g,""))&&(vTemplatesList="'"+vTemplatesList.split(",").join("','")+"'"),spaRVOptions.dataTemplates=spa.toJSON(vTemplatesList)),$.isEmptyObject(spaRVOptions.dataTemplates)||(vTemplates=spaRVOptions.dataTemplates,vTemplatesList=""+JSON.stringify(vTemplates)),(_.isEmpty(spa.toJSON((vTemplatesList||"").trimStr()))||_.isArray(vTemplates)&&1==vTemplates.length&&spa.isBlank(vTemplates[0]))&&(vTemplates={},vTemplatesList=""),spa.console.info("Templates:"),spa.console.info(vTemplates),_.isArray(vTemplates)&&!_.isEmpty(vTemplates)){spa.console.info("Array of template(s) without templateID(s).");var newTemplatesObj=spa.renderUtils.array2ObjWithKeyPrefix(vTemplates,"__tmpl_",viewContainerId);spa.console.info("Template(s) with template ID(s)."),spa.console.log(newTemplatesObj),_.isEmpty(newTemplatesObj)?(vTemplates={},vTemplatesList=""):(vTemplates=newTemplatesObj,vTemplatesList=""+JSON.stringify(vTemplates))}if(!vTemplates||$.isEmptyObject(vTemplates)){vTemplates={};var _dataTemplate=spaRVOptions.dataTemplate,_tmplKey="",_tmplLoc="";spa.isBlank(_dataTemplate)&&(spa.isBlank(vTemplate2RenderInTag)||(spa.console.info("Template to load from location <"+vTemplate2RenderInTag+">"),_dataTemplate=vTemplate2RenderInTag)),_dataTemplate=(_dataTemplate||"").trimStr(),spa.console.info("Primary Template: <"+_dataTemplate+">"),spa.isBlank(_dataTemplate)||_dataTemplate.equalsIgnoreCase("inline")||_dataTemplate.equals(".")?(spa.console.info("Using target container (inline) content as template."),_tmplKey="_tmplInline_"+viewContainerId.trimStr("#")):_dataTemplate.beginsWithStr("#")?(spa.console.info("Using page container <"+_dataTemplate+"> content as template."),_tmplKey=_dataTemplate.trimStr("#")):(spa.console.info("External path <"+_dataTemplate+"> content as template."),_tmplKey="__tmpl_"+(""+_dataTemplate).replace(/[^a-z0-9]/gi,"_"),_tmplLoc=_dataTemplate),vTemplates[_tmplKey]=_tmplLoc.replace(/['\"]/g,""),spa.console.info(vTemplates)}if(spa.console.group("spaView"),vTemplates&&!$.isEmptyObject(vTemplates)){spa.console.info("Templates of ["+spaTemplateType+"] to be used in view container ["+viewContainerId+"] => "+JSON.stringify(vTemplates));var vTemplateNames=_.keys(vTemplates);if(spa.console.group("spaLoadingTemplates"),spa.console.group("spaLoadingTemplatesCache"),useOptions&&uOptions.hasOwnProperty("dataTemplatesCache"))spa.console.info("Override [data-templates-cache] with user option [dataTemplatesCache]: "+spaRVOptions.dataTemplatesCache);else{var templatesCacheInTagData=_renderOptionInAttr("templatesCache")||_renderOptionInAttr("templateCache")||_renderOptionInAttr("htmlsCache")||_renderOptionInAttr("htmlCache");spa.isBlank(templatesCacheInTagData)||(spaRVOptions.dataTemplatesCache=templatesCacheInTagData.toBoolean(),spa.console.info("Override [data-templates-cache] with [data-templates-cache] option in tag-attribute: "+spaRVOptions.dataTemplatesCache))}spa.console.groupEnd("spaLoadingTemplatesCache"),spa.console.info("Load Templates"),spa.console.info(vTemplates);var tmplPayload=spaRVOptions.templateUrlPayload;tmplPayload&&_is(tmplPayload,"string")&&0>tmplPayload.indexOf("=")&&(tmplPayload=__finalValue(tmplPayload,spaRVOptions));var tmplOptions={method:spaRVOptions.templateUrlMethod,params:__finalValue(spaRVOptions.templateUrlParams,spaRVOptions),payload:tmplPayload,headers:__finalValue(spaRVOptions.templateUrlHeaders,spaRVOptions),onError:__finalValue(spaRVOptions.onTemplateUrlError||spaRVOptions.onError)};_.each(vTemplateNames,function(e,a){spa.console.info([a,e,vTemplates[e],spaTemplateType,viewContainerId,spaRVOptions]),spaAjaxRequestsQue=spa.loadTemplate(e,vTemplates[e],spaTemplateType,viewContainerId,spaAjaxRequestsQue,!spaRVOptions.dataTemplatesCache,tmplOptions)});var vTemplate2RenderID="#"+vTemplateNames[0].trimStr("#");if(spa.console.info("External Data/Templates Loading Status: "+JSON.stringify(spaAjaxRequestsQue)),spa.console.groupEnd("spaLoadingTemplates"),spa.console.info("Render TemplateID: "+vTemplate2RenderID),spa.console.group("spaLoadingViewStyles"),useOptions&&uOptions.hasOwnProperty("dataStylesCache"))spa.console.info("Override [data-styles-cache] with user option [dataStylesCache]: "+spaRVOptions.dataStylesCache);else{var stylesCacheInTagData=_renderOptionInAttr("stylesCache");spa.isBlank(stylesCacheInTagData)||(spaRVOptions.dataStylesCache=stylesCacheInTagData.toBoolean(),spa.console.info("Override [data-styles-cache] with [data-styles-cache] option in tag-attribute: "+spaRVOptions.dataStylesCache))}var vStylesList=_renderOptionInAttr("styles");vStylesList&&spa.isBlank((vStylesList||"").replace(/[^:'\"]/g,""))&&(vStylesList="'"+vStylesList.split(",").join("','")+"'");var vStyles=spa.toJSON(vStylesList||"{}");if($.isEmptyObject(spaRVOptions.dataStyles)||(vStyles=spaRVOptions.dataStyles),_.isArray(vStyles)&&_.remove(vStyles,function(e){return!e}),vStyles&&!$.isEmptyObject(vStyles)){if(_.isArray(vStyles)){spa.console.info("Convert array of style(s) without styleID to object with styleID(s).");
var newStylesObj=spa.renderUtils.array2ObjWithKeyPrefix(vStyles,"__styles_",viewContainerId);spa.console.info("Style(s) with styleID(s)."),spa.console.log(newStylesObj),vStyles=_.isEmpty(newStylesObj)?{}:newStylesObj}spa.console.info("External styles to be loaded [cache:"+spaRVOptions.dataStylesCache+"] along with view container ["+viewContainerId+"] => "+JSON.stringify(vStyles));var vStylesNames=_.keys(vStyles);spa.console.group("spaLoadingStyles"),_.each(vStylesNames,function(e){spaAjaxRequestsQue=spa.loadStyle(e,vStyles[e],spaRVOptions.dataStylesCache,spaAjaxRequestsQue)}),spa.console.info("External Styles Loading Status: "+JSON.stringify(spaAjaxRequestsQue)),spa.console.groupEnd("spaLoadingStyles")}else spa.console.info("No styles defined [data-styles] in view container ["+viewContainerId+"] to load.");spa.console.groupEnd("spaLoadingViewStyles"),$.when.apply($,spaAjaxRequestsQue).then(function(){function e(){var e,n=_renderOption("dataPreProcessAsync","preProcessAsync");if(n&&_.isString(n)&&(n=spa.findSafe(window,n)),retValue.modelOriginal=$.extend({},s),retValue.model=s,n&&_.isFunction(n)){t=!0;var r=$.extend({},app[rCompName]||{},uOptions||{});e=n.call(r,s),t=!spa.is(e,"undefined"),t||(e=[]),t&&(a=!spa.is(e,"array")||spa.is(e,"array")&&1==e.length,spa.is(e,"array")||(e=[e]))}return e}spa.console.group("spaRender["+spaTemplateEngine+"] - spa.renderHistory["+retValue.id+"]"),spa.console.info("Rendering "+viewContainerId+" using master template: "+vTemplate2RenderID);try{var a,t=!1,n=!_renderOption("dataValidate","validate");if(!n){spa.console.info("Validating Data");var r=_renderOption("dataValidate","validate");r&&_.isString(r)&&(r=spa.findSafe(window,r)),n=r&&_.isFunction(r)?r.call(spaTemplateModelData[viewDataModelName],spaTemplateModelData[viewDataModelName]):spa.api.isCallSuccess(spaTemplateModelData[viewDataModelName])}var s=spaTemplateModelData[viewDataModelName];n?$.when.apply($,e()).done(function(){var e=Array.prototype.slice.call(arguments);t&&(spa.console.log(rCompName,".dataPreProcessAsync() =>",e.__now()),a&&e.length>1&&"success"==e[1]?(e[0]=spa.toJSON(e[0]),e.splice(1)):_.each(e,function(a,t){a&&spa.is(a,"array")&&a.length>1&&"success"==a[1]&&(e[t]=spa.toJSON(a[0]))}),spa.console.log(e.__now()));var n,r=_renderOption("dataProcess","process");if(r&&_.isString(r)&&(r=spa.findSafe(window,r)),retValue.modelOriginal=$.extend({},s),retValue.model=s,r&&_.isFunction(r)){var o=$.extend({},app[rCompName]||{},uOptions||{});e.unshift(s),n=r.apply(o,e)}else t&&(spa.console.warn(rCompName,".dataPreProcessAsync without dataProcess. Merging responses."),e.unshift(s),_.merge.apply(_,e));if(retValue.model=spa.is(n,"undefined")?s:n,_.isObject(retValue.model)||(retValue.model=retValue.modelOriginal),spa.console.log(rCompName,"Final Template Data:",retValue.model),rCompName){if(is(app,"object")&&app.hasOwnProperty(rCompName)){var i=_.merge({},is(retValue.model,"object")?retValue.model:{_noname:retValue.model});app[rCompName].$data=i.hasOwnProperty("spaComponent")?{}:spaRVOptions.extend$data?_.merge({},spaRVOptions.dataDefaults,spaRVOptions.data_,spaRVOptions.dataExtra,spaRVOptions.dataXtra,spaRVOptions.dataParams,i):{},app[rCompName].__global__=window||{}}retValue.model._this=_.merge({},spa.findSafe(window,"app."+rCompName,{})),retValue.model._this_=_.merge({},spa.components[rCompName]||{},uOptions)}retValue.model._global_=window||{};var p,l=retValue.model,c=($(vTemplate2RenderID).html()||"").replace(/_LINKTAGINTEMPLATE_/g,"link"),u=spaRVOptions.templateScript||spa.defaults.components.templateScript;c=u?c.replace(/_BlockedScript_ src-ref="([^"])*"/g,"script").replace(/_BlockedScript_/g,"script"):c.replace(/<\/_BlockedScript_>/g,"&lt;/_BlockedScript_&gt;");var d=c.match(/({\s*\@\$(.*?)\s*})/g);!spaRVOptions.skipDataBind&&d&&_.forEach(d,function(e){c=c.replace(RegExp(e.replace(/\$/,"\\$"),"g"),e.replace(/{\s*\$this|{\s*\@\$/g,"_global_.app.").replace(/}/,".").replace(/\s/g,"").replace(/\.\./,"."+(rCompName||"")+"."))});var f=c.match(/({\s*\$(.*?)\s*})/g);!spaRVOptions.skipDataBind&&f&&_.forEach(f,function(e){c=c.replace(RegExp(e.replace(/\$/,"\\$"),"g"),e.replace(/{\s*\$this|{\s*\$/g,"app.").replace(/}/,".").replace(/\s/g,"").replace(/\.\./,"."+(rCompName||"")+"."))}),p=c,spa.console.log("Template Source:",c),spa.console.log("DATA for Template:",l);var m,g;if(!spa.isBlank(l))if(spaRVOptions.skipDataBind)spa.console.log("Skipped Data Binding.");else{if(spaRVOptions.dataTemplatesCache||(delete spa.compiledTemplates4DataBind[rCompName],delete spa.compiledTemplates[rCompName]),!spa.compiledTemplates4DataBind.hasOwnProperty(rCompName)&&/ data-bind\s*=/i.test(c)){c=_maskHandlebars(c),spa.console.log("TemplateBeforeBind",c);var h=is(l,"object")?_.merge({},spaRVOptions.dataDefaults,spaRVOptions.data_,spaRVOptions.dataExtra,spaRVOptions.dataXtra,spaRVOptions.dataParams,l):l;spa.console.log("SPA built-in binding ... ...",h),c=spa.bindData(c,h,"$"+rCompName),c=_unmaskHandlebars(c),spa.console.log("TemplateAfterBind",c),spa.compiledTemplates4DataBind.hasOwnProperty(rCompName)||(spa.compiledTemplates4DataBind[rCompName]={}),m=!0}if(spaTemplateEngine.indexOf("handlebar")>=0||spaTemplateEngine.indexOf("{")>=0)if("undefined"!=typeof Handlebars&&Handlebars){spa.console.log("Data bind using handlebars.js.",c);try{var v=spa.compiledTemplates[rCompName]||Handlebars.compile(c),y=is(l,"object")?_.merge({},retValue,spaRVOptions.dataDefaults,spaRVOptions.data_,spaRVOptions.dataExtra,spaRVOptions.dataXtra,spaRVOptions.dataParams,l):l;g=y,spa.compiledTemplates.hasOwnProperty(rCompName)||(spa.compiledTemplates[rCompName]=v),p=v(y),spa.console.log(p)}catch(b){console.error("Error in Template",b)}}else spa.console.error("handlebars.js is not loaded.")}spa.console.log("Template Compiled:",p),doDeepRender=!1,retValue.view=p.replace(/\_\{/g,"{{").replace(/\}\_/g,"}}");var S=rCompName?_.merge({},app[rCompName]||{},{__prop__:_.merge({},uOptions||{})}):{};S.__prop__&&S.__prop__.data&&(delete S.__prop__.data._global_,delete S.__prop__.data._this_,delete S.__prop__.data._this),retValue.model&&(delete retValue.model._global_,delete retValue.model._this_,delete retValue.model._this),spa.renderUtils.runCallbackFn(spa.defaults.components.render,k,S);var O,C,T,w=_renderOption("dataBeforeRender","beforeRender");if(w){var k={template:c,data:retValue.model,view:retValue.view};if(O=spa.renderUtils.runCallbackFn(w,k,S),!spa.is(O,"undefined"))switch(spa.of(O)){case"string":retValue.view=O;break;case"boolean":C=!O}}if(T=retValue.view.beginsWithStr("<!---->"),C)retValue={},spa.console.warn("Render aborted by "+w);else if(!T){var R=$viewContainerId.attr("data-rendered-component");R&&!spa.removeComponent(R,rCompName)&&(C=!0,retValue={},spa.console.warn("Render $"+rCompName+" aborted by $"+R+".onRemove()"))}if(!C){if(T)spa.console.log("Rendering component [",rCompName,"] view aborted.");else{var N=_renderOption("dataRenderType","renderType");switch(spa.console.log("Injecting component in DOM (",viewContainerId,")."+(N||"html")),N){case"value":$(viewContainerId).val(retValue.view);break;case"text":$(viewContainerId).text(retValue.view);break;default:switch(doDeepRender=!0,!0){case targetRenderMode.equalsIgnoreCase("append"):$(viewContainerId).append(retValue.view);break;case targetRenderMode.equalsIgnoreCase("prepend"):$(viewContainerId).prepend(retValue.view);break;default:$(viewContainerId).html(retValue.view)}}}$(viewContainerId).attr("data-rendered-component",rCompName).data("renderedComponent",rCompName),_$renderCountUpdate(rCompName),spa.console.info("Render: SUCCESS");var A=_.keys(spa.renderHistory),x=A.length;if(x>spa.renderHistoryMax&&$.each(A.splice(0,x-spa.renderHistoryMax),function(e,a){delete spa.renderHistory[a]}),retValue.cron=""+spa.now(),spa.renderHistoryMax>0&&(spa.renderHistory[retValue.id]=retValue),doDeepRender&&!T&&(spa.renderUtils.registerComponentEvents(rCompName),$(viewContainerId).find(".lang-icon,.lang-text,[data-i18n-lang]").length&&spa.i18n.displayLang(),_init_SPA_DOM_(viewContainerId),m||spa.dataBind(viewContainerId,g,"",!0),spa.i18n.apply(viewContainerId),_routeReloadUrl(rCompName)))return retValue;spa.console.log(retValue);var E=_renderOptionInAttr("renderCallback");spaRVOptions.dataRenderCallback&&(E=spaRVOptions.dataRenderCallback);var P=_.isString(E)&&E.equalsIgnoreCase("off");spa.console.info("Processing callback: "+E),P||spa.renderUtils.runCallbackFn(E,retValue),spa.renderUtils.runCallbackFn(spa.defaults.components.callback,retValue,S),doDeepRender&&!T&&($(viewContainerId).find("[rel='spaRender'],[data-render],[data-sparender],[data-spa-render]").spaRender(),spa.renderComponentsInHtml(viewContainerId,rCompName))}}):spa.is(app.api.onResError,"function")?app.api.onResError(spaTemplateModelData[viewDataModelName],"Invalid-Data",void 0):spa.api.onResError(spaTemplateModelData[viewDataModelName],"Invalid-Data",void 0)}catch(o){console.error(o)}spa.console.groupEnd("spaRender["+spaTemplateEngine+"] - spa.renderHistory["+retValue.id+"]")}).fail(function(){console.error("External Data/Templates/Styles/Scripts Loading failed! Unexpected!! Check the template Path / Network. Rendering aborted.")})}else spa.console.error("No templates defined [data-templates] in view container ["+viewContainerId+"] to render. Check HTML markup.");spa.console.groupEnd("spaView")}},function _onScriptsLoadFailed(){console.error("External Scripts Loading Failed! Unexpected!? Check the Script Path/Network.")}),retValue}},spa.initElementsIn=_initSpaElements,spa.setElIdIfNot=function(e){var a=$(e);return spa.isBlank(a.attr("id"))&&a.attr("id","_el_"+spa.now()+"_"+spa.rand(1e3,9999)),a.attr("id")},spa.Foundation={autoReflow:!1},spa.reflowFoundation=function(e){"Foundation"in window&&spa.Foundation.autoReflow&&$(e||document).foundation("reflow")},$.expr[":"].regex=function(e,a,t){var n=t[3].split(","),r=/^(data|css):/,s={method:n[0].match(r)?n[0].split(":")[0]:"attr",property:n.shift().replace(r,"")},o="ig",i=RegExp(n.join("").replace(/^\s+|\s+$/g,""),o);return i.test($(e)[s.method](s.property))},$.fn.extend({spaRender:function(e){this.each(function(){__renderView(this,e)})}}),$.extend({spaRender:function(e,a){$(e).spaRender(a)}}),$.fn.extend({renameAttr:function(e,a){return this.each(function(){this.setAttribute(a,this.getAttribute(e)),this.removeAttribute(e)}),this},spa$:function(){return this.map(function(){return $(this).closest("[data-rendered-component]")})},spa$name:function(){var e=this.map(function(){return $(this).closest("[data-rendered-component]").attr("data-rendered-component")});return 1==e.length?e[0]:e},spaBindData:function(e,a){return spa.bindData(this,e,a)},inBlockedSpaNavContainer:function(){return!!this.closest(_blockNavClass).length},blockNav:function(){return _blockSpaNavigation(this),this},allowNav:function(){return _allowSpaNavigation(this),this},isNavBlocked:function(){return _isSpaNavBlocked(this)},isNavAllowed:function(){return _isSpaNavAllowed(this)},disable:function(e){return e||spa.is(e,"undefined")?this.css("pointer-events","none").addClass("disabled").attr("disabled","disabled"):this.enable(!0)},enable:function(e){return e||spa.is(e,"undefined")?this.css("pointer-events","auto").removeClass("disabled").removeAttr("disabled"):this.disable(!0)},value:function(e,a){return spa.is(e,"undefined")?this.val():(this.each(function(){$(this).val(e).trigger(a||"change")}),this)},htm:function(e){return spa.is(e,"undefined")?this.html():(this.each(function(){$(this).html(spa.sanitizeScript(e))}),this)},dataJSON:function(e,a,t){var n;if(arguments.length){if(n=spa.toJSON(this.data(e)),n=spa.is(n,"object")?n:{},!spa.is(a,"undefined")){n=t?a:_.merge(n,a);var r=JSON.stringify(n),s=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();this.attr("data-"+s,r).data(e,r)}}else n=this.data();return n},isDisabled:function(e){var a=this.hasClass("disabled")||this.is("[disabled]");return a&&e&&e.call(this,this),a},isEnabled:function(e){var a=!this.isDisabled();return a&&e&&e.call(this,this),a},trackChanges:function(){spa.trackFormElChange(this)},isChanged:function(e){e=(e||"ANY").toUpperCase();var a="ALL"==e,t=!a,n=!1,r=this;if(r.length)for(var s=0;r.length>s;s++){var o=r[s].tagName.toUpperCase();if("FORM"==o)n=$(r[s]).find("input,textarea,select").isChanged(e);else if("/INPUT/TEXTAREA/SELECT/".indexOf(o)>0){if(n=spa.isElValueChanged(r[s]),t&&n)break;if(a&&!n)break}}return n},initSpaRoutes:function(){_initRouteHash(this)},initFormValidation:function(){var e=this.filter("form");return e.length?(e.each(function(e,a){_initFormValidation(a)}),void 0):"Form Not Found"},validateForm:function(e,a,t){var n,r=this;if(r.length>1)n=[{errcode:1,errmsg:"Too many forms to validate."}];else if(1==r.length){var s="#"+r.attr("id"),o=(r.prop("tagName")||"").toUpperCase();if("FORM"==o)if(spa.is(e,"string")){var i=r.find(e).map(function(){return this.id}).get().join();n=spa.validateForm(s,i,a,t)}else n=spa.validateForm(s,arguments[0],arguments[1]);else n=[{errcode:1,errmsg:"NOT a FORM"}]}else n=[{errcode:1,errmsg:"Form Not Found."}];return n},updateValidation:function(e,a){this.each(function(t,n){spa._validate._showValidateMsg(n,a,e)})},updateValidationPromise:function(e,a,t){spa.updateValidationPromise(e,this,t,a)}}),spa.initDataValidation=function(){spa.console.log("include validate framework lib (spa-validate.js) to use this feature!")},spa.doDataValidation=function(){spa.console.log("include validate framework lib (spa-validate.js) to use this feature!")},spa.properties={version:spa.VERSION},spa.api={baseUrl:"",liveUrlSuffix:"",urls:{},mock:!1,mockBaseUrl:"",mockRootFolder:"api_",defaultPayload:!1,forceParamValuesInMockUrls:!1,urlKeyIndicator:"@",url:function(e,a){e=(e||"").trimLeftStr(spa.api.urlKeyIndicator),a=a||{};var t,n,r=spa.api.urls[e]||e,s=r.beginsWithStr("!")||spa.api.mock||app.api.mock,o=r.beginsWithStr("!!")||r.beginsWithStr("~")||spa.api.forceParamValuesInMockUrls,i=_.uniq(r.extractStrBetweenIn("{","}"));return spa.isBlank(i)||_.each(i,function(e){t=e.replace(/[{}<>]/g,""),t&&(n=spa.findSafe(a,t,a._undefined),n=s&&!o?e.containsStr(">")?n:"_"+t:n,r=r.replace(RegExp(e.replace(/([^a-zA-Z0-9])/g,"\\$1"),"g"),n))}),r},success:function(e){return[e,"success"]},isCallSuccess:function(){return!0},onReqError:function(e,a,t){spa.console.error([e,a,t]),spa.console.error($(e.responseText).text())},onResError:function(){},_call:function(e){var a=spa.findSafe(window,"app.api.ajaxOptions",{}),t=spa.is(e,"object")&&e.hasOwnProperty("error")?e.error:app.api.onError||spa.api.onReqError;if(e=$.extend({},a,e,{error:t,success:function(a,t,n){a=_.isString(a)&&"html"!=(this.dataType+"").toLowerCase()?spa.toJSON(a):a,spa.api.isCallSuccess(a)?e._success.call(this,a,t,n):spa.is(app.api.onResError,"function")?app.api.onResError.call(this,a,t,n):spa.api.onResError.call(this,a,t,n)}}),e.dataType||(e.dataType="text"),"json".equalsIgnoreCase(e.dataType)&&!e.contentType&&(e.contentType="application/json"),e.data&&spa.is(e.data,"object")&&e.stringifyPayload&&(delete e.stringifyPayload,e.data=JSON.stringify(e.data)),e.defaultPayload){var n=spa.of(e.data),r=e.defaultPayload,s=spa.is(r,"function")?r(o):spa.is(r,"object")?_.merge({},r):r,o="string"==n?spa.toJSON(e.data):e.data;if(spa.is(s,"object")){var i=spa.is(o,"object")?_.merge({},s,o):s;spa.isBlank(i)||"string"!=n||(i=JSON.stringify(i)),e.data=i}}return e.url.beginsWithStr(spa.api.urlKeyIndicator)&&(e.url=spa.api.url(e.url.trimLeftStr(spa.api.urlKeyIndicator),e.data)),(app.debug||spa.debug)&&console.info(["API(ajax) call with options",e]),$.ajax(e)},_params2AxOptions:function(){var e,a,t,n,r={method:"GET",url:"",data:{},_success:function(){},async:!0};return _.each(arguments,function(s){switch(!0){case _.isString(s):e="url",r.url&&(a=!0,e="data");break;case spa.is(s,"function"):n?e="error":(n=!0,e="_success");break;case _.isBoolean(s):e="async";break;case _.isObject(s):a||s.__hasPrimaryKeys("ajaxOptions|dataUrlParams")?(e="axOptions",t=s.hasOwnProperty("ajaxOptions")?s.ajaxOptions:s):(e="data",a=!0);break;default:e="unknown"}"axOptions"!=e&&(r[e]=s)}),t&&(t.dataUrlParams&&((""+r.url).beginsWithStr(spa.api.urlKeyIndicator)&&(r.url=spa.api.url(r.url.trimLeftStr(spa.api.urlKeyIndicator),t.dataUrlParams)),delete t.dataUrlParams),_.merge(r,t)),spa.console.log("API ajax options >>"),spa.console.log(r),r},get:function(){return spa.api._call(spa.api._params2AxOptions.apply(void 0,arguments))},post:function(){return spa.api._call($.extend(spa.api._params2AxOptions.apply(void 0,arguments),{method:"POST"}))},put:function(){return spa.api._call($.extend(spa.api._params2AxOptions.apply(void 0,arguments),{method:"PUT"}))},del:function(){return spa.api._call($.extend(spa.api._params2AxOptions.apply(void 0,arguments),{method:"DELETE"}))},mix:function(){for(var e=[],a=arguments[arguments.length-1],t=0;arguments.length>t;t++)spa.is(arguments[t],"array")?e=e.concat(arguments[t]):spa.is(arguments[t],"function")||e.push(arguments[t]);return $.when.apply($,e).done(function(){var t=Array.prototype.slice.call(arguments);1==e.length&&t.length>1&&"success"==t[1]?(t[0]=spa.toJSON(t[0]),t.splice(1)):_.each(t,function(e,a){e&&spa.is(e,"array")&&e.length>1&&"success"==e[1]&&(t[a]=spa.toJSON(e[0]))}),a&&spa.is(a,"function")&&a.apply(void 0,t)})}},spa.i18n.onLangChange,spa.i18n.displayLang=function(){var e=$("html").attr("lang");if(e){var a=e,t=e.replace("-","_"),n=$('[data-i18n-lang="'+a+'"],[data-i18n-lang="'+t+'"]'),r=($("body").attr("i18n-lang-key-prefix")||"lang.name.")+t,s="-";$(".lang-text").attr("data-i18n",r).data("i18n",r),$("[data-i18n-lang]").removeClass("active"),n.length&&(n.addClass("active"),s=($(n[0]).data("i18nLang")||"").replace(/[a-z]/gi,""),$(".lang-icon").removeClass(Array.prototype.join.call($("[data-i18n-lang]").map(function(e,a){return $(a).data("i18nLang")})," "))),$(".lang-icon").addClass("-"==s?a:t),spa.i18n.apply(".lang-text")}return e},spa.ajax=_ajax,spa.mockSysTest=_mockSysTest;var _PubSubQue={},_PubSub={pub:function(e,a,t,n){var r,s;spa.is(a,"function")?(n=arguments[2],t=arguments[1]):r=arguments[1];var o,i,p=0,l=[];return _.each(_PubSubQue[e],function(a){try{p++,o=a.fn,i=null,o&&(i=o.call(r||{},e,r,t,n)),l.push({id:""+(a.name||p),response:i}),!s&&spa.is(i,"boolean")&&(s=!i)}catch(c){console.warn("Execution error in subscribed function:"+a.name+" on-"+e),console.error(c.stack)}}),s?n&&spa.is(n,"function")&&n(l):t&&spa.is(t,"function")&&t(l),l},sub:function(e,a,t){return _PubSubQue.hasOwnProperty(e)||(_PubSubQue[e]=[]),_PubSubQue[e].push({fn:a,name:t}),_PubSubQue[e].length},unSub:function(e,a){var t=!1;return _PubSubQue.hasOwnProperty(e)&&(t=!0,a?_PubSubQue[e][a-1]=null:_PubSubQue[e]=[]),t}};spa.event={on:_PubSub.sub,off:_PubSub.unSub,trigger:_PubSub.pub,announce:_PubSub.pub};var _urlHashBase="#",_blockNav,_hideNavClassName="",_hideNav,_onAutoRoute=!0,_autoRoutesFound=[],_maxAutoRoute=100,_routeOnClick=!1,_prevUrlHash="",_curBlockedUrlHash="",_isDelayed=!1,_isDelayedOnUrl="",_lastBlockedUrl="",_blockNavClassName="",_blockNavClass="",_allowNavClassName="",_attrSpaRoute="",_attrSpaRouteParams="",_routeByHref=!1,_attrOnNavAway="",_skipUrlChangeOn="x"+spa.now();spa.blockNav=_blockSpaNavigation,spa.allowNav=_allowSpaNavigation,spa.isNavBlocked=_isSpaNavBlocked,spa.isNavAllowed=_isSpaNavAllowed,spa.isToShowNav=_isToShowSpaNav,spa.isInBlockedSpaNavContainer=_inBlockedSpaNavContainer,window.onerror=function(e,a,t){console.warn("Invalid Content: Check the network/path/content.",e,a,t)};var _dynHashProcessed=[];spa.parseRoutes=_getNewMatchingRoutes;try{spa.sesStore=_StoreMgmt(sessionStorage)}catch(e){console.warn("No Access to sessionStorage.",e)}try{spa.locStore=_StoreMgmt(localStorage)}catch(e){console.warn("No Access to localStorage.",e)}spa.reload=function(e){e&&spa.sesStore.set("_spaReloadUrl",e||""),spa.allowNav(),window.location.reload()},spa.hasReloadUrl=function(){return!!(spa.sesStore.get("_spaReloadUrl")||"").trim()},spa.initRoutes=_initRouteHash,spa.route=_routeNewUrl,spa.routeUrl=_routeToUrl,spa.routeEl=_$routeElements,spa.initDataBind=_initDataBind,spa.async=function(e){function a(){var a=e.apply(void 0,t),n=t.length,r=n?t[n-1]:"";r&&spa.is(r,"function")&&r(a)}var t=Array.prototype.slice.call(arguments,1);setTimeout(a,0)},$(document).ready(function(){_initSpaDefaults(),spa.debug=spa.urlParam("spa.debug")||spa.hashParam("spa.debug")||spa.debug,$.ajaxPrefilter(_ajaxPrefilter),_initSpaApp()})}(),spa.console.info("spa loaded.");